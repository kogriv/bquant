# Change Trace Log 2025-11-06

==================== COMMIT DIVIDER ====================

[14:30:00] [docs] [Changed] docs/api/visualization/zones.md - Comprehensively updated visualization documentation to reflect current API and best practices.
[14:30:00] [docs] [Added] docs/api/visualization/zones.md - Added detailed descriptions for new parameters: `time_axis_mode`, `xaxis_num_ticks`, `indicator_chart_types`, `comparison_context`.
[14:30:00] [docs] [Added] docs/api/visualization/zones.md - Added a new section for the recommended `bquant.visualization.export.save_figure` utility with examples.
[14:30:00] [docs] [Changed] docs/api/visualization/zones.md - Rewrote the main usage example to be a complete, best-practice demonstration mirroring `research/notebooks/04_zones_sample.py`.
[14:30:00] [docs] [Changed] docs/api/visualization/zones.md - Restructured the document to prioritize the `result.visualize()` workflow.
[14:30:00] [docs] [Added] docs/api/visualization/zones.md - Updated the changelog section within the document to include the latest features from November 2025.

[14:47:31] [fix] [Critical] bquant/visualization/zones.py:1379-1380 - Fixed Y-axis autoscaling issue: removed `row=1, col=1` parameters from `add_annotation()` call for zone labels. These parameters conflicted with explicit `xref='x'` and `yref='paper'`, causing Plotly to reset the `domain` setting of Y-axis, which resulted in axis starting from 0 instead of auto-scaling to price range.
[14:47:31] [fix] [Critical] bquant/visualization/zones.py:1416-1417 - Removed redundant `yaxis=dict(rangemode='normal')` from `update_layout()` call. This line was completely replacing the Y-axis configuration (including critical `domain` parameter for multi-panel layout) instead of updating it. The `rangemode='normal'` is already properly set via `fig.update_yaxes()` calls earlier (lines 1082, 1187).
[14:47:31] [enhancement] [Minor] bquant/visualization/export.py:65-68 - Enhanced `save_figure()` to use figure's own width/height from `fig.layout` if available, falling back to provided defaults. This ensures exported PNG respects the figure's configured dimensions.
[14:47:31] [docs] [Added] devref/graph/plotly_yaxis_autoscale.md - Created comprehensive troubleshooting document describing the Y-axis autoscaling issue, root causes (annotation row/col conflict and update_layout overwrite), solutions with code examples, verification method, and key learnings for future Plotly multi-panel work.

[14:50:41] [docs] [Updated] docs/developer_guide/zone_analyzer_deep_dive.md - Integrated detailed information about analysis strategies (`.with_strategies`), generated features (`zone.features`), and advanced `.analyze()` behavior (clustering, hypothesis tests). Added a complete code example to bridge theory and practice.

[16:54:44] [docs] [Updated] devref/gaps/swing/strat_issue.md - Comprehensively updated the swing strategies issue document based on analysis of existing pandas-ta integration infrastructure. Key changes: (1) Clarified that pandas-ta wrapper already exists in `bquant/indicators/library/pandas_ta.py` with 158 registered indicators including 'zigzag'; (2) Updated API examples to use correct lowercase 'zigzag' name and actual pandas-ta parameters ('length', 'percent'); (3) Replaced task 3.3 "Create pandas-ta wrapper" with "Integrate pandas-ta via LibraryManager"; (4) Added detailed implementation specs for all 6 tasks with code examples; (5) Added sections on pandas-ta parameters discovery, default behavior, OHLC data handling requirements, and extensibility to other libraries; (6) Added "Expected Result" section with before/after examples; (7) Added effort estimation (8-12 hours total).

[17:11:24] [docs] [Restructured] devref/gaps/swing/strat_issue.md - Restructured the implementation plan into a logical sequence with checkboxes for progress tracking. Major changes: (1) Renamed section 3 from "Задачи для Реализации" to "План Реализации" to emphasize logical sequence; (2) Reorganized into 7 sequential stages (Этапы 1-7) with granular task checkboxes `[ ]` for progress tracking; (3) Integrated "Дополнительные Рекомендации" section content into relevant stages - pandas-ta parameters discovery into Stage 4, default behavior into Stage 1, OHLC data handling into Stage 2, extensibility notes into Stage 4; (4) Removed standalone "Дополнительные Рекомендации" section as all content now embedded in stages; (5) Enhanced Stage 6 (testing) with nested checkboxes for subtasks; (6) Updated section 5 "Статус" with per-stage effort estimates and progress tracking instructions. Document now serves as actionable step-by-step implementation plan with all critical context embedded at relevant stages.
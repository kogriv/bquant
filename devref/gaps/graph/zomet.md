# Zone Metrics Visualization Enhancement

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-11-07
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-11-08 (—Ä–µ–≤–∏–∑–∏—è 5.0: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å gloswing.md)
**–°—Ç–∞—Ç—É—Å**: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í–´–°–û–ö–ò–ô

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è ([05_case_study_zone_consistency.py](../../../research/notebooks/05_case_study_zone_consistency.py)) –±—ã–ª–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å MACD bull-–∑–æ–Ω: —Å—Ä–µ–¥–Ω–∏–µ –∞–ø-—Å–≤–∏–Ω–≥–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç –¥–∞—É–Ω-—Å–≤–∏–Ω–≥–∏ (p-value 0.0015 < 0.05 –¥–ª—è zigzag —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏). –°–º. –æ—Ç—á–µ—Ç: [macd_zone_consistency_case_study.md](../../../docs/analytics/zones/macd_zone_consistency_case_study.md).

–û–¥–Ω–∞–∫–æ —Ç–µ–∫—É—â–∏–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
1. –í–∏–¥–µ—Ç—å —Å–∞–º–∏ **—Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏** (—Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–µ —Ç–æ—á–∫–∏, —ç–∫—Å—Ç—Ä–µ–º—É–º—ã) –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
2. –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å **—Å–≤–∏–Ω–≥-–º–µ—Ç—Ä–∏–∫–∏ –∏ —à–µ–π–ø-–º–µ—Ç—Ä–∏–∫–∏** –ø—Ä–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∑–æ–Ω—ã
3. –í–∏–¥–µ—Ç—å **–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º** –≤ —Ä–µ–∂–∏–º–µ overview

–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–æ–Ω.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–í–ò–°–ò–ú–û–°–¢–¨**: –î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ —Å–≤–∏–Ω–≥–æ–≤, –æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤ [gloswing.md](../swing/gloswing.md).

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ**: `SwingContext` –∏–∑ gloswing.md —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–≤–∏–Ω–≥-—Ç–æ—á–µ–∫ (`SwingPoint.timestamp`, `SwingPoint.index`, `SwingPoint.price`, `SwingPoint.swing_type`), —á—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å:
- ‚ùå –°–æ–∑–¥–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ `SwingPointsIndicator`
- ‚ùå –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ `SwingMetrics`
- ‚ùå –ü–µ—Ä–µ—Å—á—ë—Ç–∞ —Å–≤–∏–Ω–≥-—Ç–æ—á–µ–∫ on-demand —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚ùå –°–ª–æ–∂–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è overlay

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –≠–∫–æ–Ω–æ–º–∏—è **6-11 —á–∞—Å–æ–≤** –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üéØ –≠—Ç–∞–ø 1: –ú–µ—Ç—Ä–∏–∫–∏ –≤ Detail —Ä–µ–∂–∏–º–µ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í–´–°–û–ö–ò–ô
**–ó–∞—Ç—Ä–∞—Ç—ã**: 4-6 —á–∞—Å–æ–≤
**–¶–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ swing/shape –º–µ—Ç—Ä–∏–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ detail

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:

```python
def plot_zone_detail(
    self,
    price_data: pd.DataFrame,
    zone: Union[Dict, ZoneInfo],
    context_bars: int = 20,

    # === –ù–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ ===
    show_zone_metrics: bool = True,       # –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
    metrics_position: str = 'top-left',   # 'top-left', 'top-right', 'bottom-left'

    # === –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï ===
    show_indicators: bool = True,
    show_volume: bool = True,
    **kwargs
) -> go.Figure:
    """
    –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–æ–Ω—ã —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏.

    NEW PARAMS:
        show_zone_metrics: –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å swing/shape –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—É—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é
        metrics_position: –ü–æ–∑–∏—Ü–∏—è –±–ª–æ–∫–∞ –º–µ—Ç—Ä–∏–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
    """
    # ... existing code ...

    # –ù–û–í–û–ï: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
    if show_zone_metrics and 'features' in zone:
        self._add_zone_metrics_annotation(
            fig,
            zone,
            position=metrics_position,
            row=1, col=1  # Price panel
        )

    return fig
```

**–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Zone #42 (bull) ‚Ä¢ 18 bars           ‚îÇ
‚îÇ Strategy: zigzag (legs=3, dev=0.8%) ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                   ‚îÇ
‚îÇ üìä Swing Metrics:                   ‚îÇ
‚îÇ   Swings: 4 (3‚Üë / 2‚Üì)               ‚îÇ
‚îÇ   Avg Rally: +1.2% (3.5 bars)       ‚îÇ
‚îÇ   Avg Drop: -0.8% (2.1 bars)        ‚îÇ
‚îÇ   Rally/Drop Ratio: 1.5x            ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                   ‚îÇ
‚îÇ üìà Shape Metrics (MACD hist):       ‚îÇ
‚îÇ   Skewness: +0.43 (right-tailed)    ‚îÇ
‚îÇ   Kurtosis: 2.1 (platykurtic)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ–¥–∑–∞–¥–∞—á–∏**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_add_zone_metrics_annotation()` ‚Äî 2-3 —á–∞—Å–∞
2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ —á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç ‚Äî 1-2 —á–∞—Å–∞
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç—Ä–∏–∫ (graceful degradation) ‚Äî 1 —á–∞—Å
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ—Ä—ã ‚Äî 1 —á–∞—Å

---

### üéØ –≠—Ç–∞–ø 2: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ Overview

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°–†–ï–î–ù–ò–ô
**–ó–∞—Ç—Ä–∞—Ç—ã**: 3-4 —á–∞—Å–∞
**–¶–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –∑–æ–Ω–∞–º –≤ overview —Ä–µ–∂–∏–º–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:

```python
def plot_zones_on_price_chart(
    self,
    ...
    show_aggregate_metrics: bool = False,  # –ü–æ–∫–∞–∑–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    metrics_position: str = 'top-right',   # –ü–æ–∑–∏—Ü–∏—è –±–ª–æ–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    ...
):
    """
    Overview –≤—Å–µ—Ö –∑–æ–Ω —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.

    NEW PARAMS:
        show_aggregate_metrics: –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –∑–æ–Ω–∞–º
        metrics_position: –ü–æ–∑–∏—Ü–∏—è –±–ª–æ–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    """
    # ... existing code ...

    # –ù–û–í–û–ï: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
    if show_aggregate_metrics:
        aggregated = self._aggregate_zone_metrics(zones)
        self._add_aggregate_metrics_annotation(
            fig,
            aggregated,
            position=metrics_position,
            row=1, col=1
        )

    return fig
```

**–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Overview: 37 bull zones, 35 bear zones          ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ üìä Swing Statistics (across all zones):        ‚îÇ
‚îÇ   Avg Rally: +1.18% ¬± 0.45%                    ‚îÇ
‚îÇ   Avg Drop: -0.92% ¬± 0.38%                     ‚îÇ
‚îÇ   Rally/Drop Ratio: 1.28x (median)             ‚îÇ
‚îÇ   Zones with swings: 23/37 (62%)               ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ üìà Shape Statistics (MACD histogram):          ‚îÇ
‚îÇ   Skewness: +0.35 ¬± 0.22 (right-tailed)        ‚îÇ
‚îÇ   Kurtosis: 2.45 ¬± 0.65 (platykurtic)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ–¥–∑–∞–¥–∞—á–∏**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_aggregate_zone_metrics()` ‚Äî 1-2 —á–∞—Å–∞
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_add_aggregate_metrics_annotation()` ‚Äî 1-2 —á–∞—Å–∞
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ—Ä—ã ‚Äî 1 —á–∞—Å

---

### üéØ –≠—Ç–∞–ø 3: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–∏–Ω–≥-—Ç–æ—á–µ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç gloswing.md)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í–´–°–û–ö–ò–ô
**–ó–∞—Ç—Ä–∞—Ç—ã**: 3-4 —á–∞—Å–∞ (–≤–º–µ—Å—Ç–æ 9-15 —á–∞—Å–æ–≤!)
**–¶–µ–ª—å**: –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏ –∏–∑ `SwingContext` –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**: –¢—Ä–µ–±—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è [gloswing.md](../swing/gloswing.md) –§–∞–∑ 1-4

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:

```python
def plot_zone_detail(
    self,
    data: pd.DataFrame,
    zone: Union[Dict, ZoneInfo],

    # === –ù–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ ===
    show_swings: bool = False,           # –ü–æ–∫–∞–∑–∞—Ç—å —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏
    swing_marker_size: int = 10,         # –†–∞–∑–º–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤
    swing_colors: Dict[str, str] = None, # {'peak': 'red', 'trough': 'green'}

    **kwargs
) -> go.Figure:
    """
    –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–æ–Ω—ã —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∞–º–∏.

    NEW PARAMS:
        show_swings: –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏ –∏–∑ zone.swing_context
        swing_marker_size: –†–∞–∑–º–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤ —Å–≤–∏–Ω–≥–æ–≤
        swing_colors: –¶–≤–µ—Ç–∞ –¥–ª—è peaks –∏ troughs
    """
    # ... existing code ...

    # –ù–û–í–û–ï: –î–æ–±–∞–≤–∏—Ç—å —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
    if show_swings and hasattr(zone, 'swing_context') and zone.swing_context:
        self._add_swing_overlay(
            fig,
            zone.get_zone_swings(),  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SwingContext.get_swings_for_zone()
            row=1, col=1,  # Price panel
            marker_size=swing_marker_size,
            colors=swing_colors
        )

    return fig

def _add_swing_overlay(
    self,
    fig: go.Figure,
    swing_points: List[SwingPoint],  # –ò–∑ gloswing.md
    row: int,
    col: int,
    marker_size: int = 10,
    colors: Dict[str, str] = None
) -> None:
    """
    –î–æ–±–∞–≤–∏—Ç—å —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∏ –∫–∞–∫ scatter overlay.

    NEW METHOD

    Args:
        fig: Plotly figure
        swing_points: –°–ø–∏—Å–æ–∫ SwingPoint –∏–∑ SwingContext (gloswing.md)
        row, col: –ü–æ–∑–∏—Ü–∏—è subplot
        marker_size: –†–∞–∑–º–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤
        colors: –¶–≤–µ—Ç–∞ {'peak': 'red', 'trough': 'green'}
    """
    if colors is None:
        colors = {'peak': 'red', 'trough': 'green'}

    # –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ peaks –∏ troughs
    peaks = [sp for sp in swing_points if sp.swing_type == 'peak']
    troughs = [sp for sp in swing_points if sp.swing_type == 'trough']

    # –î–æ–±–∞–≤–∏—Ç—å peaks
    if peaks:
        fig.add_trace(
            go.Scatter(
                x=[sp.timestamp for sp in peaks],
                y=[sp.price for sp in peaks],
                mode='markers',
                marker=dict(
                    symbol='triangle-down',
                    size=marker_size,
                    color=colors['peak'],
                    line=dict(width=1, color='darkred')
                ),
                name='Swing Peaks',
                hovertemplate='<b>Peak</b><br>Price: %{y:.2f}<extra></extra>'
            ),
            row=row, col=col
        )

    # –î–æ–±–∞–≤–∏—Ç—å troughs
    if troughs:
        fig.add_trace(
            go.Scatter(
                x=[sp.timestamp for sp in troughs],
                y=[sp.price for sp in troughs],
                mode='markers',
                marker=dict(
                    symbol='triangle-up',
                    size=marker_size,
                    color=colors['trough'],
                    line=dict(width=1, color='darkgreen')
                ),
                name='Swing Troughs',
                hovertemplate='<b>Trough</b><br>Price: %{y:.2f}<extra></extra>'
            ),
            row=row, col=col
        )
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ overview —Ä–µ–∂–∏–º–∞**:

```python
def plot_zones_on_price_chart(
    self,
    ...
    show_swings: bool = False,  # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥–∏
    ...
):
    """
    Overview –≤—Å–µ—Ö –∑–æ–Ω —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Å–≤–∏–Ω–≥-—Ç–æ—á–∫–∞–º–∏.

    NEW PARAMS:
        show_swings: –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥–∏ –∏–∑ SwingContext
    """
    # ... existing code ...

    # –ù–û–í–û–ï: –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
    if show_swings and zones and hasattr(zones[0], 'swing_context'):
        swing_context = zones[0].swing_context
        # –í—Å–µ –∑–æ–Ω—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π swing_context (–≥–ª–æ–±–∞–ª—å–Ω—ã–π)
        # –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –í–°–ï —Ç–æ—á–∫–∏ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –≤ –≤–∏–¥–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
        visible_swings = [
            sp for sp in swing_context.swing_points
            if data.index[0] <= sp.timestamp <= data.index[-1]
        ]
        self._add_swing_overlay(fig, visible_swings, row=1, col=1)

    return fig
```

**–ü–æ–¥–∑–∞–¥–∞—á–∏**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_add_swing_overlay()` ‚Äî 2 —á–∞—Å–∞
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `plot_zone_detail()` –∏ `plot_zones_on_price_chart()` ‚Äî 1 —á–∞—Å
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ—Ä—ã ‚Äî 1 —á–∞—Å

**–ü–æ—á–µ–º—É —Ç–∞–∫ –º–∞–ª–æ –≤—Ä–µ–º–µ–Ω–∏?**
- ‚úÖ SwingPoint —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (timestamp, price, swing_type)
- ‚úÖ zone.get_zone_swings() ‚Äî –≥–æ—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥ –∏–∑ gloswing.md
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω—É—é –æ–±—ë—Ä—Ç–∫—É
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏–ª–∏ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π scatter trace –≤ Plotly

---

## –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç

| –≠—Ç–∞–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–∞—Ç—Ä–∞—Ç—ã | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
|------|----------|---------|-----------|-------------|
| **1** | –ú–µ—Ç—Ä–∏–∫–∏ –≤ Detail | 4-6 —á–∞—Å–æ–≤ | –í–´–°–û–ö–ò–ô | –ù–µ—Ç |
| **2** | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ Overview | 3-4 —á–∞—Å–∞ | –°–†–ï–î–ù–ò–ô | –≠—Ç–∞–ø 1 |
| **3** | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–∏–Ω–≥-—Ç–æ—á–µ–∫ | 3-4 —á–∞—Å–∞ | –í–´–°–û–ö–ò–ô | **gloswing.md –§–∞–∑—ã 1-4** |
| **–ò–¢–û–ì–û** | | **10-14 —á–∞—Å–æ–≤** | | |

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –æ—Ü–µ–Ω–∫–æ–π**:
- –ë—ã–ª–æ: 25-36 —á–∞—Å–æ–≤ (—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π)
- –°—Ç–∞–ª–æ: 10-14 —á–∞—Å–æ–≤
- **–≠–∫–æ–Ω–æ–º–∏—è: 15-22 —á–∞—Å–∞** –±–ª–∞–≥–æ–¥–∞—Ä—è `SwingContext` –∏–∑ gloswing.md

---

## –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å gloswing.md (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–≠—Ç–∞–ø 1** (zomet) ‚Äî 4-6 —á–∞—Å–æ–≤
   - –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å **–¥–æ** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è gloswing.md
   - –ú–µ—Ç—Ä–∏–∫–∏ —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

2. **–≠—Ç–∞–ø 2** (zomet) ‚Äî 3-4 —á–∞—Å–∞
   - –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å **–¥–æ** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è gloswing.md
   - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç SwingContext

3. **gloswing.md –§–∞–∑—ã 1-4** ‚Äî 15-20 —á–∞—Å–æ–≤
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ —Å–≤–∏–Ω–≥–æ–≤

4. **–≠—Ç–∞–ø 3** (zomet) ‚Äî 3-4 —á–∞—Å–∞
   - –¢—Ä–µ–±—É–µ—Ç –≥–æ—Ç–æ–≤–æ–≥–æ `SwingContext`
   - –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ scatter overlay

**–ò—Ç–æ–≥–æ**: 25-34 —á–∞—Å–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (–º–µ—Ç—Ä–∏–∫–∏ + —Å–≤–∏–Ω–≥–∏)

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π)

1. **gloswing.md –§–∞–∑—ã 1-4** ‚Äî 15-20 —á–∞—Å–æ–≤
2. **zomet –≠—Ç–∞–ø—ã 1-3** ‚Äî 10-14 —á–∞—Å–æ–≤

**–ò—Ç–æ–≥–æ**: 25-34 —á–∞—Å–∞

---

## –ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã

**–≠—Ç–∞–ø 1**:
- `bquant/visualization/zones.py` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `_add_zone_metrics_annotation()`

**–≠—Ç–∞–ø 2**:
- `bquant/visualization/zones.py` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `_aggregate_zone_metrics()`, `_add_aggregate_metrics_annotation()`

**–≠—Ç–∞–ø 3** (–ø–æ—Å–ª–µ gloswing.md):
- `bquant/visualization/zones.py` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `_add_swing_overlay()`

**–ü—Ä–∏–º–µ—Ä—ã –∏ —Ç–µ—Å—Ç—ã**:
- `research/notebooks/04_zones_sample.py` ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- `tests/visualization/test_zone_metrics_display.py` ‚Äî —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **[gloswing.md](../swing/gloswing.md)** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å–≤–∏–Ω–≥–æ–≤ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–í–ò–°–ò–ú–û–°–¢–¨)
- [Case Study: MACD Zone Consistency](../../../docs/analytics/zones/macd_zone_consistency_case_study.md)
- [Zone Analysis User Guide](../../../docs/user_guide/zone_analysis.md)

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### –≠—Ç–∞–ø 1 (–ú–µ—Ç—Ä–∏–∫–∏ –≤ detail)
- ‚úÖ `plot_zone_detail()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `show_zone_metrics=True`
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è swing_metrics –∏ shape_metrics
- ‚úÖ Backward compatibility: —Å—Ç–∞—Ä—ã–µ –≤—ã–∑–æ–≤—ã –±–µ–∑ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –î–µ–º–æ-—Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 2 (–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)
- ‚úÖ `plot_zones_on_price_chart()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `show_aggregate_metrics=True`
- ‚úÖ –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ –≤—Å–µ–º –∑–æ–Ω–∞–º
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
- ‚úÖ –ù–µ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫

### –≠—Ç–∞–ø 3 (–°–≤–∏–Ω–≥-—Ç–æ—á–∫–∏)
- ‚úÖ `_add_swing_overlay()` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç SwingPoint –æ–±—ä–µ–∫—Ç—ã
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è `detail` –∏ `overview` —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ Peaks –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏ –≤–Ω–∏–∑
- ‚úÖ Troughs –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–µ–ª—ë–Ω—ã–º–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏ –≤–≤–µ—Ä—Ö
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω—ã —Å 100 —Å–≤–∏–Ω–≥–∞–º–∏ < 100ms
- ‚úÖ –î–µ–º–æ-—Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ú–µ—Ç—Ä–∏–∫–∏ –≤ detail

```python
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast_period=12, slow_period=26, signal_period=9)
    .detect_zones('zero_crossing', indicator_col='macd_hist')
    .with_strategies(swing='zigzag')
    .analyze()
    .build()
)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
fig = result.visualize(
    'detail',
    zone_id=5,
    show_zone_metrics=True,
    metrics_position='top-left'
)
fig.show()
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ overview

```python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∑–æ–Ω —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
fig = result.visualize(
    'overview',
    show_aggregate_metrics=True,
    metrics_position='top-right'
)
fig.show()
```

### –ü—Ä–∏–º–µ—Ä 3: –°–≤–∏–Ω–≥-—Ç–æ—á–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç gloswing.md)

```python
# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å–≤–∏–Ω–≥–æ–≤ (gloswing.md)
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', ...)
    .detect_zones('zero_crossing', indicator_col='macd_hist')
    .with_strategies(swing='zigzag')
    .with_swing_scope('global')  # ‚Üê –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç (gloswing.md)
    .analyze()
    .build()
)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ —Å–≤–∏–Ω–≥–∞–º–∏
fig = result.visualize(
    'detail',
    zone_id=5,
    show_zone_metrics=True,
    show_swings=True,           # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç zone.swing_context
    swing_marker_size=12
)
fig.show()

# Overview —Å–æ –≤—Å–µ–º–∏ —Å–≤–∏–Ω–≥–∞–º–∏
fig = result.visualize(
    'overview',
    show_aggregate_metrics=True,
    show_swings=True  # ‚Üê –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥–∏
)
fig.show()
```

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ –ø–ª–∞–Ω–∞** (2025-11-08)
2. **‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≠—Ç–∞–ø–∞ 1**: –ú–µ—Ç—Ä–∏–∫–∏ –≤ detail (4-6 —á–∞—Å–æ–≤)
3. **‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≠—Ç–∞–ø–∞ 2**: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (3-4 —á–∞—Å–∞)
4. **‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ gloswing.md**: –§–∞–∑—ã 1-4 (15-20 —á–∞—Å–æ–≤)
5. **‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≠—Ç–∞–ø–∞ 3**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–∏–Ω–≥–æ–≤ (3-4 —á–∞—Å–∞)
6. **‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Code review + –ø—Ä–∏–º–µ—Ä—ã
7. **‚è≥ –†–µ–ª–∏–∑ v1.0**: –ü–æ–ª–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ —Å–≤–∏–Ω–≥–æ–≤

---

**–ê–≤—Ç–æ—Ä**: Claude Code
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 5.0 (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å gloswing.md)
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-11-08

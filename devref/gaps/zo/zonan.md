# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –∑–æ–Ω (Zone Analysis)

**–î–∞—Ç–∞:** 2025-10-17  
**–í–µ—Ä—Å–∏—è:** v7.1 (Complete Spec + Cross-References)  
**–°—Ç–∞—Ç—É—Å:** Ready for Implementation - –ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω –ª—é–±—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
- [zomodul.md](zomodul.md) - –ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (12 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- [zouni.md](zouni.md) - ‚ö†Ô∏è **[–£–°–¢–ê–†–ï–õ]** –ê–Ω–∞–ª–∏–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ v1.0 (–ø—Å–µ–≤–¥–æ-—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å —Å hardcoded —Å–ø–∏—Å–∫–∞–º–∏)
- [zouni_v2.md](zouni_v2.md) - ‚úÖ **–ê–ö–¢–£–ê–õ–¨–ù–û** –ò—Å—Ç–∏–Ω–Ω–∞—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å v2.0 (ZERO hardcoded –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤)
- [README.md](README.md) - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Stages 0-2.4 –≤—ã—è–≤–ª–µ–Ω—ã **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏:
- ‚ùå –ë–∞–≥ #1-3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –Ω–æ –ø–æ–¥—Ö–æ–¥ **–ø—Å–µ–≤–¥–æ-—É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω** (hardcoded —Å–ø–∏—Å–∫–∏)
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –°–º. **[zouni_v2.md](zouni_v2.md)** - –∏—Å—Ç–∏–Ω–Ω–∞—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `indicator_context` –∏ explicit –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (~7 hours, –ø—Ä–æ—â–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ)

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü—Ä–æ–±–ª–µ–º–∞: MACDZoneAnalyzer –∫–∞–∫ –º–æ–Ω–æ–ª–∏—Ç](#–ø—Ä–æ–±–ª–µ–º–∞)
2. [–†–µ—à–µ–Ω–∏–µ: –î–≤—É—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ + Pipeline](#—Ä–µ—à–µ–Ω–∏–µ)
3. [–ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–æ–≤—ã–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
4. [–°–ª–æ–π 1: Zone Detection Strategies](#—Å–ª–æ–π-1)
5. [–°–ª–æ–π 2: Universal Zone Analyzer](#—Å–ª–æ–π-2)
6. [Pipeline: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞](#pipeline)
7. [Builder: Fluent API](#builder)
8. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndicatorFactory](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
9. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
10. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (Code Templates)](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
11. [–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
12. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã)
13. [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
14. [–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
15. [–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞)
16. [–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏](#–ø–ª–∞–Ω-–º–∏–≥—Ä–∞—Ü–∏–∏)
17. [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ](#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ)

---

<a name="–ø—Ä–æ–±–ª–µ–º–∞"></a>
## –ü—Ä–æ–±–ª–µ–º–∞: MACDZoneAnalyzer –∫–∞–∫ –º–æ–Ω–æ–ª–∏—Ç

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥)

**–§–∞–π–ª:** `bquant/indicators/macd.py` (564 —Å—Ç—Ä–æ–∫–∏)

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç—Ä–æ–∫ | % | –û—Ü–µ–Ω–∫–∞ |
|-----------|-------|---|--------|
| **–°–≤–æ—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** | ~192 | 34% | ‚ö†Ô∏è –ú–û–ù–û–õ–ò–¢ |
| ‚îî MACD —Ä–∞—Å—á–µ—Ç | 67 | 12% | Hardcoded |
| ‚îî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–æ–Ω | 80 | 14% | Hardcoded |
| ‚îî –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ | 45 | 8% | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ |
| **–î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | ~135 | 24% | ‚úÖ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä |
| **–ê–¥–∞–ø—Ç–µ—Ä—ã** | ~78 | 14% | üîß –£—Ç–∏–ª–∏—Ç—ã |
| **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** | ~159 | 28% | üîß |

**–í–µ—Ä–¥–∏–∫—Ç:** –ì–∏–±—Ä–∏–¥ (40% –º–æ–Ω–æ–ª–∏—Ç, 40% –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, 20% –∞–¥–∞–ø—Ç–µ—Ä—ã)

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ñ–µ—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ MACD** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
2. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IndicatorFactory`
3. **Hardcoded –¥–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω** - —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω—É–ª—è
4. **–ê–¥–∞–ø—Ç–µ—Ä—ã —Ñ–æ—Ä–º–∞—Ç–æ–≤** - –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (45 —Å—Ç—Ä–æ–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞)
5. **–¶–∏–∫–ª—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ

---

<a name="—Ä–µ—à–µ–Ω–∏–µ"></a>
## –†–µ—à–µ–Ω–∏–µ: –î–≤—É—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ + Pipeline

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

> **"–ó–æ–Ω—ã - –ø–µ—Ä–≤–∏—á–Ω—ã. –ê–Ω–∞–ª–∏–∑ - —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω. Pipeline - –≥–∏–±–æ–∫."**

### –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (2 —Å–ª–æ—è + pipeline)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ZoneAnalysisPipeline / ZoneAnalysisBuilder                 ‚îÇ
‚îÇ (–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è)         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îú‚îÄ‚Üí IndicatorFactory (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
             ‚îÇ   ‚îî‚îÄ create(source, indicator, **params)
             ‚îÇ   ‚îî‚îÄ –ò—Å—Ç–æ—á–Ω–∏–∫–∏: preloaded/custom/pandas_ta/talib
             ‚îÇ
             ‚îú‚îÄ‚Üí –°–ª–æ–π 1: Zone Detection Strategies
             ‚îÇ   ‚îú‚îÄ ZeroCrossingDetection
             ‚îÇ   ‚îú‚îÄ LineCrossingDetection
             ‚îÇ   ‚îú‚îÄ ThresholdDetection
             ‚îÇ   ‚îú‚îÄ PreloadedZonesDetection
             ‚îÇ   ‚îî‚îÄ CombinedRulesDetection
             ‚îÇ
             ‚îî‚îÄ‚Üí –°–ª–æ–π 2: Universal Zone Analyzer
                 ‚îî‚îÄ analyze_zones(zones, df)
                 ‚îî‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: ZoneFeaturesAnalyzer, HypothesisTestSuite,
                                 ZoneSequenceAnalyzer, Regression, Validation
```

**–£–±—Ä–∞–Ω–æ:**
- ‚ùå –°–ª–æ–π 3 (Indicator-specific Facades) - hardcode, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∞—Å–∞–¥—ã (MACDZoneAnalyzer, AOZoneAnalyzer, ...)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ ZoneAnalysisPipeline - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ ZoneAnalysisBuilder - fluent interface –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
- ‚úÖ –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IndicatorFactory

---

<a name="–±–∞–∑–æ–≤—ã–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã"></a>
## –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### ZoneInfo - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∑–æ–Ω—ã

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bquant/analysis/zones/models.py` (–ù–û–í–û–ï)

```python
# bquant/analysis/zones/models.py

from dataclasses import dataclass, field
from typing import Optional, Dict, Any, List
from datetime import datetime
import pandas as pd


@dataclass
class ZoneInfo:
    """
    –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–æ–Ω–µ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞).
    
    Attributes:
        zone_id: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–æ–Ω—ã
        type: –¢–∏–ø –∑–æ–Ω—ã ('bull', 'bear', 'overbought', 'neutral', 'oversold', ...)
        start_idx: –ù–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å (integer location)
        end_idx: –ö–æ–Ω–µ—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å (integer location)
        start_time: –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∑–æ–Ω—ã (index value)
        end_time: –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–æ–Ω—ã (index value)
        duration: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –±–∞—Ä–∞—Ö
        data: DataFrame —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–æ–Ω—ã (OHLCV + –≤—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)
        features: –†–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞)
    """
    zone_id: int
    type: str
    start_idx: int
    end_idx: int
    start_time: datetime
    end_time: datetime
    duration: int
    data: pd.DataFrame
    features: Optional[Dict[str, Any]] = None
    
    def to_analyzer_format(self) -> Dict[str, Any]:
        """–§–æ—Ä–º–∞—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã."""
        return {
            'zone_id': self.zone_id,
            'type': self.type,
            'duration': self.duration,
            'data': self.data,
            **(self.features or {})
        }


@dataclass
class ZoneAnalysisResult:
    """–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω."""
    zones: List[ZoneInfo]
    statistics: Dict[str, Any]
    hypothesis_tests: Dict[str, Any]
    clustering: Optional[Dict[str, Any]] = None
    sequence_analysis: Optional[Dict[str, Any]] = None
    regression_results: Optional[Dict[str, Any]] = None
    validation_results: Optional[Dict[str, Any]] = None
    data: Optional[pd.DataFrame] = None
    metadata: Dict[str, Any] = field(default_factory=dict)
```

---

<a name="—Å–ª–æ–π-1"></a>
## –°–ª–æ–π 1: Zone Detection Strategies

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

```python
# bquant/analysis/zones/detection/base.py

from typing import Protocol, List, Dict, Any, runtime_checkable
from dataclasses import dataclass, field
import pandas as pd
from ..models import ZoneInfo


@runtime_checkable
class ZoneDetectionStrategy(Protocol):
    """–ü—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω."""
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: 'ZoneDetectionConfig') -> List[ZoneInfo]:
        """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤–∏–ª."""
        ...


@dataclass
class ZoneDetectionConfig:
    """–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω."""
    min_duration: int = 2
    zone_types: List[str] = None
    rules: Dict[str, Any] = field(default_factory=dict)
    strategy_name: str = None
    
    def __post_init__(self):
        if self.zone_types is None:
            self.zone_types = ['bull', 'bear']
```

### –†–µ–µ—Å—Ç—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

```python
# bquant/analysis/zones/detection/registry.py

class ZoneDetectionRegistry:
    """–†–µ–µ—Å—Ç—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω."""
    
    _strategies: Dict[str, Type[ZoneDetectionStrategy]] = {}
    
    @classmethod
    def register(cls, name: str):
        """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏."""
        def decorator(strategy_class):
            cls._strategies[name] = strategy_class
            return strategy_class
        return decorator
    
    @classmethod
    def get(cls, name: str, **params):
        """–ü–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ –∏–º–µ–Ω–∏."""
        if name not in cls._strategies:
            raise ValueError(f"Unknown zone detection strategy: {name}")
        return cls._strategies[name](**params)
    
    @classmethod
    def list_strategies(cls) -> List[str]:
        """–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π."""
        return list(cls._strategies.keys())
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**

| –°—Ç—Ä–∞—Ç–µ–≥–∏—è | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –¢–∏–ø—ã –∑–æ–Ω |
|-----------|------------|----------|
| `zero_crossing` | MACD, AO, CCI (–æ—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã) | bull/bear |
| `line_crossing` | Bollinger, MA crosses | bull/bear |
| `threshold` | RSI, Stochastic | overbought/neutral/oversold |
| `preloaded` | –ò–º–ø–æ—Ä—Ç –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º | –õ—é–±—ã–µ |
| `combined` | –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ | –õ—é–±—ã–µ |

### –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

> **–°–º. –ø–æ–ª–Ω—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –∫–æ–¥–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)**

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
- `ZeroCrossingDetection` - –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–∏ (MACD, AO, CCI)
- `LineCrossingDetection` - –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥–≤—É—Ö –ª–∏–Ω–∏–π (MA crosses, Bollinger)
- `ThresholdDetection` - –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–æ–Ω—ã (RSI, Stochastic)
- `PreloadedZonesDetection` - –∏–º–ø–æ—Ä—Ç –≥–æ—Ç–æ–≤—ã—Ö –∑–æ–Ω (CSV, DataFrame)
- `CombinedRulesDetection` - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —É—Å–ª–æ–≤–∏–π (–∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞)

---

<a name="—Å–ª–æ–π-2"></a>
## –°–ª–æ–π 2: Universal Zone Analyzer

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
# bquant/analysis/zones/analyzer.py

class UniversalZoneAnalyzer:
    """
    –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω.
    
    –ù–ï –ó–ù–ê–ï–¢:
    - –û—Ç–∫—É–¥–∞ –∑–æ–Ω—ã (MACD, AO, preloaded, –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
    - –ö–∞–∫ –∑–æ–Ω—ã –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã
    
    –ó–ù–ê–ï–¢ –¢–û–õ–¨–ö–û:
    - –ö–∞–∫ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å List[ZoneInfo]
    """
    
    def __init__(self,
                 features_analyzer=None,
                 hypothesis_suite=None,
                 sequence_analyzer=None,
                 regression_analyzer=None,
                 validation_suite=None,
                 swing_strategy=None,
                 shape_strategy=None,
                 divergence_strategy=None,
                 volatility_strategy=None,
                 volume_strategy=None):
        """Dependency Injection –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤."""
        if features_analyzer is None:
            from .zone_features import ZoneFeaturesAnalyzer
            features_analyzer = ZoneFeaturesAnalyzer(
                swing_strategy=swing_strategy,
                shape_strategy=shape_strategy,
                divergence_strategy=divergence_strategy,
                volatility_strategy=volatility_strategy,
                volume_strategy=volume_strategy
            )
        
        self.features = features_analyzer
        self.hypotheses = hypothesis_suite or HypothesisTestSuite()
        self.sequences = sequence_analyzer or ZoneSequenceAnalyzer()
        self.regression = regression_analyzer or ZoneRegressionAnalyzer()
        self.validation = validation_suite or ValidationSuite()
    
    # –û —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ DI —Å–º. —Ä–∞–∑–¥–µ–ª "–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã"
    
    def analyze_zones(self, 
                      zones: List[ZoneInfo],
                      data: pd.DataFrame,
                      perform_clustering: bool = True,
                      n_clusters: int = 3,
                      run_regression: bool = False) -> ZoneAnalysisResult:
        """
        –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –∑–æ–Ω.
        
        –ß–ò–°–¢–ê–Ø –ö–û–û–†–î–ò–ù–ê–¶–ò–Ø - —Ç–æ–ª—å–∫–æ –≤—ã–∑–æ–≤—ã –¥–µ–ª–µ–≥–∞—Ç–æ–≤!
        """
        if not zones:
            return self._empty_result(data)
        
        # 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–ë–ï–ó –∞–¥–∞–ø—Ç–µ—Ä–æ–≤!)
        zones_features = self.features.extract_all_zones_features(zones)
        
        # 2. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
        statistics = self.features.analyze_zones_distribution([f.to_dict() for f in zones_features])
        
        # 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑
        hypothesis_tests = self.hypotheses.run_all_tests([f.to_dict() for f in zones_features])
        
        # 4. –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
        sequence_analysis = self.sequences.analyze_zone_transitions(zones_features)
        
        # 5. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
        clustering = None
        if perform_clustering and len(zones) >= n_clusters:
            clustering = self.sequences.cluster_zones(zones_features, n_clusters=n_clusters)
        
        # 6. –†–µ–≥—Ä–µ—Å—Å–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        regression_results = None
        if run_regression and len(zones) > 10:
            regression_results = {
                'duration': self.regression.predict_zone_duration([f.to_dict() for f in zones_features]),
                'return': self.regression.predict_price_return([f.to_dict() for f in zones_features])
            }
        
        # –°–±–æ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        return ZoneAnalysisResult(
            zones=zones,
            statistics=statistics.results if hasattr(statistics, 'results') else statistics,
            hypothesis_tests=hypothesis_tests,
            sequence_analysis=sequence_analysis.results if hasattr(sequence_analysis, 'results') else sequence_analysis,
            clustering=clustering.results if clustering and hasattr(clustering, 'results') else clustering,
            regression_results=regression_results,
            data=data,
            metadata={
                'analysis_timestamp': datetime.now().isoformat(),
                'total_zones': len(zones),
                'zone_types': list(set(z.type for z in zones))
            }
        )
```

---

<a name="pipeline"></a>
## Pipeline: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
# bquant/analysis/zones/pipeline.py

from dataclasses import dataclass, field
from typing import Optional, Dict, Any, Literal
import pandas as pd

from ...indicators import IndicatorFactory, IndicatorResult
from .detection import ZoneDetectionRegistry, ZoneDetectionConfig
from .analyzer import UniversalZoneAnalyzer
from .models import ZoneAnalysisResult


@dataclass
class IndicatorConfig:
    """
    –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å).
    
    None –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É–∂–µ –≤ –¥–∞–Ω–Ω—ã—Ö.
    """
    source: Literal['preloaded', 'custom', 'pandas_ta', 'talib']
    name: str
    params: Dict[str, Any] = field(default_factory=dict)


@dataclass
class ZoneAnalysisConfig:
    """–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pipeline –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω."""
    
    # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä (None –µ—Å–ª–∏ —É–∂–µ –≤ –¥–∞–Ω–Ω—ã—Ö)
    indicator: Optional[IndicatorConfig] = None
    
    # –î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    zone_detection: ZoneDetectionConfig = None
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∞–ª–∏–∑–∞
    perform_clustering: bool = True
    n_clusters: int = 3
    run_regression: bool = False
    run_validation: bool = False
```

### Pipeline –∫–ª–∞—Å—Å

```python
class ZoneAnalysisPipeline:
    """
    –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω.
    
    –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –∫–ª–∞—Å—Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ - –ù–ï–¢ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞—Å–∞–¥–æ–≤!
    –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å.
    """
    
    def __init__(self, 
                 config: ZoneAnalysisConfig,
                 zone_analyzer: Optional[UniversalZoneAnalyzer] = None):
        """
        Args:
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pipeline
            zone_analyzer: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä (DI)
        """
        self.config = config
        self.analyzer = zone_analyzer or UniversalZoneAnalyzer()
        self.logger = get_logger(__name__)
    
    def run(self, df: pd.DataFrame) -> ZoneAnalysisResult:
        """
        –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π pipeline –∞–Ω–∞–ª–∏–∑–∞.
        
        –®–∞–≥–∏:
        1. –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) - —á–µ—Ä–µ–∑ IndicatorFactory
        2. –î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω - —á–µ—Ä–µ–∑ ZoneDetectionStrategy
        3. –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω - —á–µ—Ä–µ–∑ UniversalZoneAnalyzer
        """
        # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)
        df_prepared = self._prepare_data(df)
        
        # 2. –î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω
        zones = self._detect_zones(df_prepared)
        
        # 3. –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω
        return self._analyze_zones(zones, df_prepared)
    
    def _prepare_data(self, df: pd.DataFrame) -> pd.DataFrame:
        """–†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ IndicatorFactory."""
        if self.config.indicator is None:
            return df  # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —É–∂–µ –≤ –¥–∞–Ω–Ω—ã—Ö
        
        ind = self.config.indicator
        self.logger.info(f"Calculating indicator: {ind.source}.{ind.name}")
        
        # –°–æ–∑–¥–∞–µ–º —á–µ—Ä–µ–∑ IndicatorFactory!
        indicator = IndicatorFactory.create(
            source=ind.source,
            indicator=ind.name,
            **ind.params
        )
        
        result: IndicatorResult = indicator.calculate(df)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        df_with_indicator = df.copy()
        for col in result.data.columns:
            df_with_indicator[col] = result.data[col]
        
        # –î–æ–±–∞–≤–ª—è–µ–º ATR –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
        if 'atr' not in df_with_indicator.columns:
            from bquant.data.processor import calculate_derived_indicators
            derived = calculate_derived_indicators(df_with_indicator)
            if 'atr' in derived.columns:
                df_with_indicator['atr'] = derived['atr']
        
        return df_with_indicator
    
    def _detect_zones(self, df: pd.DataFrame) -> List[ZoneInfo]:
        """–î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é."""
        detector = ZoneDetectionRegistry.get(
            self.config.zone_detection.strategy_name
        )
        return detector.detect_zones(df, self.config.zone_detection)
    
    def _analyze_zones(self, zones: List[ZoneInfo], df: pd.DataFrame) -> ZoneAnalysisResult:
        """–ê–Ω–∞–ª–∏–∑ –∑–æ–Ω —á–µ—Ä–µ–∑ UniversalZoneAnalyzer."""
        return self.analyzer.analyze_zones(
            zones, df,
            perform_clustering=self.config.perform_clustering,
            n_clusters=self.config.n_clusters,
            run_regression=self.config.run_regression
        )
```

---

<a name="builder"></a>
## Builder: Fluent API

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
# bquant/analysis/zones/pipeline.py

class ZoneAnalysisBuilder:
    """
    Fluent builder –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω.
    
    –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å "—á–µ—Ä–µ–∑ —Ç–æ—á–∫—É" –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è pipeline.
    –í–Ω—É—Ç—Ä–∏ —Å–æ–∑–¥–∞–µ—Ç ZoneAnalysisPipeline.
    """
    
    def __init__(self, data: pd.DataFrame):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è builder —Å –¥–∞–Ω–Ω—ã–º–∏.
        
        Args:
            data: DataFrame —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏ (+ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)
        """
        self.data = data
        self._indicator_config: Optional[IndicatorConfig] = None
        self._zone_detection_config: Optional[ZoneDetectionConfig] = None
        self._perform_clustering = True
        self._n_clusters = 3
        self._run_regression = False
        self._run_validation = False
        self.logger = get_logger(__name__)
    
    def with_indicator(self, 
                      source: str, 
                      name: str, 
                      **params) -> 'ZoneAnalysisBuilder':
        """
        –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ pipeline.
        
        Args:
            source: –ò—Å—Ç–æ—á–Ω–∏–∫ ('preloaded', 'custom', 'pandas_ta', 'talib')
            name: –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
            **params: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        
        Returns:
            self –¥–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤
        
        Example:
            builder.with_indicator('custom', 'macd', fast=12, slow=26, signal=9)
        """
        self._indicator_config = IndicatorConfig(
            source=source,
            name=name,
            params=params
        )
        return self
    
    def detect_zones(self, 
                    strategy: str, 
                    min_duration: int = 2,
                    **rules) -> 'ZoneAnalysisBuilder':
        """
        –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–µ—Ç–µ–∫—Ü–∏—é –∑–æ–Ω.
        
        Args:
            strategy: –°—Ç—Ä–∞—Ç–µ–≥–∏—è ('zero_crossing', 'line_crossing', 'threshold', 'preloaded', 'combined')
            min_duration: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–æ–Ω—ã
            **rules: –ü—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)
        
        Returns:
            self –¥–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤
        
        Examples:
            .detect_zones('zero_crossing', indicator_col='macd')
            .detect_zones('threshold', indicator_col='rsi', upper_threshold=70, lower_threshold=30)
            .detect_zones('preloaded', zones_data='zones.csv')
        """
        self._zone_detection_config = ZoneDetectionConfig(
            min_duration=min_duration,
            rules=rules,
            strategy_name=strategy
        )
        return self
    
    def analyze(self,
               clustering: bool = True,
               n_clusters: int = 3,
               regression: bool = False,
               validation: bool = False) -> 'ZoneAnalysisBuilder':
        """
        –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∞–ª–∏–∑–∞.
        
        Args:
            clustering: –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é
            n_clusters: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
            regression: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
            validation: –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
        
        Returns:
            self –¥–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤
        """
        self._perform_clustering = clustering
        self._n_clusters = n_clusters
        self._run_regression = regression
        self._run_validation = validation
        return self
    
    def build(self) -> ZoneAnalysisResult:
        """
        –í—ã–ø–æ–ª–Ω–∏—Ç—å pipeline –∏ –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
        
        Returns:
            ZoneAnalysisResult —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º
        """
        if self._zone_detection_config is None:
            raise ValueError("Zone detection strategy not configured. Call detect_zones() first.")
        
        # –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        config = ZoneAnalysisConfig(
            indicator=self._indicator_config,
            zone_detection=self._zone_detection_config,
            perform_clustering=self._perform_clustering,
            n_clusters=self._n_clusters,
            run_regression=self._run_regression,
            run_validation=self._run_validation
        )
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º —á–µ—Ä–µ–∑ pipeline
        pipeline = ZoneAnalysisPipeline(config)
        return pipeline.run(self.data)


# Convenience —Ñ—É–Ω–∫—Ü–∏—è
def analyze_zones(df: pd.DataFrame) -> ZoneAnalysisBuilder:
    """
    –°–æ–∑–¥–∞—Ç—å builder –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω.
    
    Fluent API entry point.
    
    Example:
        from bquant.analysis.zones import analyze_zones
        
        result = (
            analyze_zones(df)
            .with_indicator('custom', 'macd', fast=12, slow=26)
            .detect_zones('zero_crossing', indicator_col='macd')
            .analyze(clustering=True)
            .build()
        )
    """
    return ZoneAnalysisBuilder(df)
```

---

<a name="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"></a>
## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndicatorFactory

### –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
# –í ZoneAnalysisPipeline._prepare_data()

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ IndicatorFactory
indicator = IndicatorFactory.create(
    source=config.indicator.source,    # 'custom', 'pandas_ta', 'talib', 'preloaded'
    indicator=config.indicator.name,   # 'macd', 'ao', 'rsi', ...
    **config.indicator.params
)
result: IndicatorResult = indicator.calculate(df)

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã
from bquant.indicators.calculators import calculate_macd  # –æ–±–µ—Ä—Ç–∫–∞, –Ω–µ—Ç –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
macd_data = calculate_macd(df, fast=12, slow=26)
```

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü—Ä–∏–º–µ—Ä |
|----------|------------|--------|
| `preloaded` | –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ | df —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç 'macd', 'macd_signal', 'macd_hist' |
| `custom` | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º | –í—ã—á–∏—Å–ª—è–µ—Ç MACD —á–µ—Ä–µ–∑ bquant.indicators.custom.MACD |
| `pandas_ta` | –í–Ω–µ—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –í—ã–∑—ã–≤–∞–µ—Ç pandas_ta.macd() |
| `talib` | –í–Ω–µ—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –í—ã–∑—ã–≤–∞–µ—Ç talib.MACD() |

---

<a name="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞"></a>
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
bquant/
‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îî‚îÄ‚îÄ zones/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ models.py               # ‚úÖ Stage 0 - ZoneInfo, ZoneAnalysisResult
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ detection/              # ‚úÖ Stage 1 - –°–ª–æ–π 1 (–¥–µ—Ç–µ–∫—Ü–∏—è)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ base.py            # ZoneDetectionStrategy, ZoneDetectionConfig
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ registry.py         # ZoneDetectionRegistry
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ zero_crossing.py    # ZeroCrossingDetection
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ line_crossing.py    # LineCrossingDetection
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ threshold.py        # ThresholdDetection
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ preloaded.py        # PreloadedZonesDetection + helper
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ combined.py         # CombinedRulesDetection
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ analyzer.py             # ‚úÖ Stage 1 - UniversalZoneAnalyzer (–°–ª–æ–π 2)
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ pipeline.py             # ‚úÖ Stage 1 - ZoneAnalysisPipeline + Builder
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ presets.py              # Stage 2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - convenience shortcuts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ zone_features.py        # ‚úÖ Stage 1 - –æ–±–Ω–æ–≤–ª–µ–Ω (extract_all_zones_features)
‚îÇ       ‚îú‚îÄ‚îÄ sequence_analysis.py    # –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (—É–∂–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ strategies/             # –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (—É–∂–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã!)
‚îÇ           ‚îú‚îÄ‚îÄ swing/
‚îÇ           ‚îú‚îÄ‚îÄ shape/
‚îÇ           ‚îú‚îÄ‚îÄ divergence/
‚îÇ           ‚îú‚îÄ‚îÄ volatility/
‚îÇ           ‚îî‚îÄ‚îÄ volume/
‚îÇ
‚îî‚îÄ‚îÄ indicators/
    ‚îú‚îÄ‚îÄ base.py                     # –°–£–©–ï–°–¢–í–£–ï–¢ - IndicatorFactory
    ‚îú‚îÄ‚îÄ custom/                      # –°–£–©–ï–°–¢–í–£–ï–¢ - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
    ‚îú‚îÄ‚îÄ library/                     # –°–£–©–ï–°–¢–í–£–ï–¢ - pandas_ta, talib
    ‚îú‚îÄ‚îÄ preloaded/                   # –°–£–©–ï–°–¢–í–£–ï–¢ - –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    ‚îÇ
    ‚îî‚îÄ‚îÄ macd.py                      # Stage 2 - –†–ï–§–ê–ö–¢–û–†–ò–ù–ì (518‚Üí~100 —Å—Ç—Ä–æ–∫):
                                     # - ‚úÖ ZoneInfo ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ models.py
                                     # - ‚úÖ ZoneAnalysisResult ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ models.py
                                     # - –£–î–ê–õ–ò–¢–¨ –≤–µ—Å—å –∫–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ (~450 —Å—Ç—Ä–æ–∫)
                                     # - –û–°–¢–ê–í–ò–¢–¨ —Ç–æ–Ω–∫–∏–π wrapper —Å @deprecated (~50 —Å—Ç—Ä–æ–∫)

examples/                            # Stage 2 - –ø—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
‚îú‚îÄ‚îÄ 02_macd_zone_analysis.py        # –û–±–Ω–æ–≤–∏—Ç—å: —Å—Ç–∞—Ä—ã–π vs –Ω–æ–≤—ã–π API
‚îú‚îÄ‚îÄ 02a_universal_zones.py          # –°–æ–∑–¥–∞—Ç—å: –≤—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ –æ–¥–∏–Ω API
‚îú‚îÄ‚îÄ 04_comprehensive_analysis.py    # –û–±–Ω–æ–≤–∏—Ç—å: –ø–æ–ª–Ω—ã–π pipeline
‚îî‚îÄ‚îÄ README.md                        # –°–æ–∑–¥–∞—Ç—å: –≥–∏–¥ –ø–æ –ø—Ä–∏–º–µ—Ä–∞–º

research/notebooks/                  # Stage 2 - –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–æ—É—Ç–±—É–∫–∏
‚îú‚îÄ‚îÄ 03_zones.py                     # –û–±–Ω–æ–≤–∏—Ç—å: –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π API
‚îú‚îÄ‚îÄ 03_zones_universal.py           # –°–æ–∑–¥–∞—Ç—å: –¥–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ README.md                        # –û–±–Ω–æ–≤–∏—Ç—å: –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –Ω–æ—É—Ç–±—É–∫–æ–≤
```

**–£–ë–†–ê–ù–û:** `indicators/analyzers/` - –ù–ï–¢ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞—Å–∞–¥–æ–≤!

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–æ–¥–∞

### ‚ùå –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –ø–æ–¥ –∫–∞–∂–¥—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

**–ù–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫:**
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –Ω–∞—Ä—É—à–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å
bquant/indicators/analyzers/
‚îú‚îÄ‚îÄ macd.py ‚Üí MACDZoneAnalyzer (500+ —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ rsi.py ‚Üí RSIZoneAnalyzer (500+ —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
‚îú‚îÄ‚îÄ ao.py ‚Üí AOZoneAnalyzer (500+ —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
‚îî‚îÄ‚îÄ stoch.py ‚Üí StochZoneAnalyzer (500+ —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞ (–∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ª–æ–≥–∏–∫—É)
- –ù–∞—Ä—É—à–µ–Ω–∏–µ DRY (Don't Repeat Yourself)
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å)
- –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Stage 1
- `indicators/` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å **—Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤**, –∞ –Ω–µ –∏—Ö **–∞–Ω–∞–ª–∏–∑**

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API

**–†–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ–¥–∞:**

| –ß—Ç–æ | –ì–¥–µ | –†–∞–∑–º–µ—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|-----|--------|------------|
| **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** | `bquant/analysis/zones/` | ~1700 —Å—Ç—Ä–æ–∫ | ‚úÖ Stage 1 - –†–ï–ê–õ–ò–ó–û–í–ê–ù–û |
| **Backward compatibility** | `bquant/indicators/macd.py` | ~100 —Å—Ç—Ä–æ–∫ | –¢–æ–Ω–∫–∏–π wrapper —Å @deprecated |
| **Convenience shortcuts** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `bquant/analysis/zones/presets.py` | ~100 —Å—Ç—Ä–æ–∫ | 4-5 —Ñ—É–Ω–∫—Ü–∏–π –ø–æ 10 —Å—Ç—Ä–æ–∫ |
| **–ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã** | `examples/` | 3-4 —Ñ–∞–π–ª–∞ –ø–æ 200-300 —Å—Ç—Ä–æ–∫ | –î–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |
| **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è** | `research/notebooks/` | 1-2 —Ñ–∞–π–ª–∞ –ø–æ 500+ —Å—Ç—Ä–æ–∫ | NotebookSimulator –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ |

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
# –û–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API –¥–ª—è –í–°–ï–• –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:
from bquant.analysis.zones import analyze_zones

# MACD
result_macd = analyze_zones(df).with_indicator('custom', 'macd').detect_zones('zero_crossing', indicator_col='macd_hist').build()

# RSI  
result_rsi = analyze_zones(df).with_indicator('pandas_ta', 'rsi').detect_zones('threshold', indicator_col='rsi', upper_threshold=70, lower_threshold=30).build()

# AO
result_ao = analyze_zones(df).with_indicator('pandas_ta', 'ao').detect_zones('zero_crossing', indicator_col='AO_5_34').build()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –ï–¥–∏–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (0 —Å—Ç—Ä–æ–∫ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞!)
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: examples/ vs research/notebooks/

**examples/** - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ, –∫–æ—Ä–æ—Ç–∫–∏–µ (100-300 —Å—Ç—Ä–æ–∫)
- ‚úÖ –°–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ (–º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å)
- ‚úÖ –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (–ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ use cases)

**research/notebooks/** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π:
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ (500+ —Å—Ç—Ä–æ–∫)
- ‚úÖ –° —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏ –∏ –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç NotebookSimulator (–∑–∞–º–µ–Ω–∞ Jupyter)
- ‚úÖ –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ú–æ–∂–µ—Ç –±—ã—Ç—å "–≥—Ä—è–∑–Ω—ã–º" –∫–æ–¥–æ–º (–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ)

---

<a name="—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π"></a>
## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (Code Templates)

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –∫–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–æ–Ω, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è - —ç—Ç–æ –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —à–∞–±–ª–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω—É–∂–¥—ã.

### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (base.py, registry.py)

#### base.py - –ü—Ä–æ—Ç–æ–∫–æ–ª –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
# bquant/analysis/zones/detection/base.py

from typing import Protocol, List, Dict, Any, runtime_checkable
from dataclasses import dataclass, field
import pandas as pd
from ..models import ZoneInfo


@runtime_checkable
class ZoneDetectionStrategy(Protocol):
    """
    –ü—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω.
    
    –õ—é–±–æ–π –∫–ª–∞—Å—Å —Å –º–µ—Ç–æ–¥–æ–º detect_zones() - –≤–∞–ª–∏–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è!
    """
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: 'ZoneDetectionConfig') -> List[ZoneInfo]:
        """
        –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤–∏–ª.
        
        Args:
            data: DataFrame —Å OHLCV + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª –¥–µ—Ç–µ–∫—Ü–∏–∏
            
        Returns:
            List[ZoneInfo] - —Å–ø–∏—Å–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–æ–Ω
            
        Raises:
            ValueError: –ï—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
        """
        ...


@dataclass
class ZoneDetectionConfig:
    """
    –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω.
    
    Attributes:
        min_duration: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–æ–Ω—ã –≤ –±–∞—Ä–∞—Ö
        zone_types: –¢–∏–ø—ã –∑–æ–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ (None = –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)
        rules: –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (Dict[str, Any])
        strategy_name: –ò–º—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è registry
        metadata: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—Ç–ª–∞–¥–∫–∏)
    """
    min_duration: int = 2
    zone_types: List[str] = None
    rules: Dict[str, Any] = field(default_factory=dict)
    strategy_name: str = None
    metadata: Dict[str, Any] = field(default_factory=dict)
    
    def __post_init__(self):
        if self.zone_types is None:
            self.zone_types = ['bull', 'bear']
    
    def validate(self, required_rules: List[str]) -> None:
        """–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–ª–∏—á–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª."""
        missing = [r for r in required_rules if r not in self.rules]
        if missing:
            raise ValueError(
                f"Missing required rules for {self.strategy_name}: {missing}"
            )
```

#### registry.py - –†–µ–µ—Å—Ç—Ä —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

```python
# bquant/analysis/zones/detection/registry.py

from typing import Dict, Type, List, Any
import logging

logger = logging.getLogger(__name__)


class ZoneDetectionRegistry:
    """
    –†–µ–µ—Å—Ç—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω.
    
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä @register().
    –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
    """
    
    _strategies: Dict[str, Type[ZoneDetectionStrategy]] = {}
    _metadata: Dict[str, Dict[str, Any]] = {}
    
    @classmethod
    def register(cls, name: str, 
                 description: str = "",
                 supported_zones: List[str] = None,
                 required_rules: List[str] = None):
        """
        –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
        
        Args:
            name: –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
            description: –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
            supported_zones: –¢–∏–ø—ã –∑–æ–Ω, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å
            required_rules: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ config.rules
            
        Example:
            @ZoneDetectionRegistry.register(
                'zero_crossing',
                description='Detect zones by indicator crossing zero line',
                supported_zones=['bull', 'bear'],
                required_rules=['indicator_col']
            )
            class ZeroCrossingDetection:
                def detect_zones(self, data, config):
                    ...
        """
        def decorator(strategy_class):
            if name in cls._strategies:
                logger.warning(f"Overwriting existing strategy: {name}")
            
            cls._strategies[name] = strategy_class
            cls._metadata[name] = {
                'description': description,
                'supported_zones': supported_zones or ['bull', 'bear'],
                'required_rules': required_rules or [],
                'class': strategy_class.__name__
            }
            
            logger.info(f"Registered zone detection strategy: {name}")
            return strategy_class
        
        return decorator
    
    @classmethod
    def get(cls, name: str, **init_params) -> ZoneDetectionStrategy:
        """
        –ü–æ–ª—É—á–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ –∏–º–µ–Ω–∏.
        
        Args:
            name: –ò–º—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
            **init_params: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è __init__ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
            
        Returns:
            –≠–∫–∑–µ–º–ø–ª—è—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        """
        if name not in cls._strategies:
            available = ', '.join(cls.list_strategies())
            raise ValueError(
                f"Unknown zone detection strategy: '{name}'. "
                f"Available: {available}"
            )
        
        strategy_class = cls._strategies[name]
        return strategy_class(**init_params)
    
    @classmethod
    def list_strategies(cls) -> List[str]:
        """–°–ø–∏—Å–æ–∫ –∏–º–µ–Ω –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π."""
        return list(cls._strategies.keys())
    
    @classmethod
    def get_info(cls, name: str) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏."""
        if name not in cls._metadata:
            raise ValueError(f"Unknown strategy: {name}")
        return cls._metadata[name].copy()
    
    @classmethod
    def list_all_info(cls) -> Dict[str, Dict[str, Any]]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö."""
        return cls._metadata.copy()
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: ZeroCrossingDetection

```python
# bquant/analysis/zones/detection/zero_crossing.py

import pandas as pd
import numpy as np
from typing import List

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'zero_crossing',
    description='Detect bull/bear zones by indicator crossing zero line',
    supported_zones=['bull', 'bear'],
    required_rules=['indicator_col']
)
class ZeroCrossingDetection:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –¥–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–∏.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - MACD histogram
        - Awesome Oscillator (AO)
        - CCI (Commodity Channel Index)
        - –ª—é–±–æ–π –æ—Å—Ü–∏–ª–ª—è—Ç–æ—Ä —Å –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–µ–π
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - indicator_col: str (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        - smooth_window: int (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ—Ç–µ–∫—Ü–∏–µ–π
        
    –¢–∏–ø—ã –∑–æ–Ω:
        - 'bull': –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä > 0
        - 'bear': –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä < 0
    """
    
    def __init__(self):
        self.logger = get_logger(__name__)
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """
        –û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∑–æ–Ω—ã –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é –Ω—É–ª—è.
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ò–∑–≤–ª–µ—á—å –∫–æ–ª–æ–Ω–∫—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        2. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Å–≥–ª–∞–¥–∏—Ç—å
        3. –ù–∞–π—Ç–∏ –∑–Ω–∞–∫–æ–≤—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã (+ -> -, - -> +)
        4. –°–æ–∑–¥–∞—Ç—å ZoneInfo –¥–ª—è –∫–∞–∂–¥–æ–π –∑–æ–Ω—ã
        5. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ min_duration
        """
        # –í–∞–ª–∏–¥–∞—Ü–∏—è
        config.validate(required_rules=['indicator_col'])
        
        indicator_col = config.rules['indicator_col']
        if indicator_col not in data.columns:
            raise ValueError(
                f"Indicator column '{indicator_col}' not found in data. "
                f"Available: {list(data.columns)}"
            )
        
        df = data.copy()
        indicator_values = df[indicator_col].values
        
        # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ
        smooth_window = config.rules.get('smooth_window')
        if smooth_window and smooth_window > 1:
            indicator_values = pd.Series(indicator_values).rolling(
                window=smooth_window, 
                center=False
            ).mean().values
            self.logger.debug(f"Applied smoothing: window={smooth_window}")
        
        # –ù–∞–π—Ç–∏ —Å–º–µ–Ω—ã –∑–Ω–∞–∫–∞
        signs = np.sign(indicator_values)
        signs[signs == 0] = 1  # 0 —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ
        
        sign_changes = np.where(np.diff(signs) != 0)[0] + 1
        
        if len(sign_changes) == 0:
            self.logger.warning("No zero crossings found")
            return []
        
        # –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü
        boundaries = np.concatenate([[0], sign_changes, [len(df)]])
        
        zones = []
        for i in range(len(boundaries) - 1):
            start_idx = boundaries[i]
            end_idx = boundaries[i + 1] - 1
            duration = end_idx - start_idx + 1
            
            # –§–∏–ª—å—Ç—Ä –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            if duration < config.min_duration:
                continue
            
            # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –∑–æ–Ω—ã
            zone_mean_value = indicator_values[start_idx:end_idx + 1].mean()
            zone_type = 'bull' if zone_mean_value > 0 else 'bear'
            
            # –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø–∞–º –∑–æ–Ω
            if zone_type not in config.zone_types:
                continue
            
            # –°–æ–∑–¥–∞—Ç—å ZoneInfo
            zone_data = df.iloc[start_idx:end_idx + 1].copy()
            
            zone = ZoneInfo(
                zone_id=len(zones),
                type=zone_type,
                start_idx=start_idx,
                end_idx=end_idx,
                start_time=df.index[start_idx],
                end_time=df.index[end_idx],
                duration=duration,
                data=zone_data
            )
            zones.append(zone)
        
        self.logger.info(
            f"Detected {len(zones)} zones: "
            f"{sum(1 for z in zones if z.type == 'bull')} bull, "
            f"{sum(1 for z in zones if z.type == 'bear')} bear"
        )
        
        return zones
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: ThresholdDetection

```python
# bquant/analysis/zones/detection/threshold.py

import pandas as pd
import numpy as np
from typing import List

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'threshold',
    description='Detect zones by indicator crossing upper/lower thresholds',
    supported_zones=['overbought', 'neutral', 'oversold'],
    required_rules=['indicator_col', 'upper_threshold', 'lower_threshold']
)
class ThresholdDetection:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –¥–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω –ø–æ –ø–æ—Ä–æ–≥–∞–º.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - RSI (upper=70, lower=30)
        - Stochastic (upper=80, lower=20)
        - Williams %R
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - indicator_col: str (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
        - upper_threshold: float (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞
        - lower_threshold: float (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞
        
    –¢–∏–ø—ã –∑–æ–Ω:
        - 'overbought': –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä > upper_threshold
        - 'neutral': lower_threshold <= –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä <= upper_threshold
        - 'oversold': –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä < lower_threshold
    """
    
    def __init__(self):
        self.logger = get_logger(__name__)
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∑–æ–Ω—ã –ø–æ –ø–æ—Ä–æ–≥–∞–º."""
        # –í–∞–ª–∏–¥–∞—Ü–∏—è
        config.validate(required_rules=['indicator_col', 'upper_threshold', 'lower_threshold'])
        
        indicator_col = config.rules['indicator_col']
        upper = config.rules['upper_threshold']
        lower = config.rules['lower_threshold']
        
        if upper <= lower:
            raise ValueError(f"upper_threshold ({upper}) must be > lower_threshold ({lower})")
        
        if indicator_col not in data.columns:
            raise ValueError(f"Indicator column '{indicator_col}' not found")
        
        df = data.copy()
        indicator_values = df[indicator_col].values
        
        # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–∞–º
        zone_classes = np.empty(len(indicator_values), dtype=object)
        zone_classes[indicator_values > upper] = 'overbought'
        zone_classes[indicator_values < lower] = 'oversold'
        zone_classes[(indicator_values >= lower) & (indicator_values <= upper)] = 'neutral'
        
        # –ù–∞–π—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã –∑–æ–Ω (—Å–º–µ–Ω—ã –∫–ª–∞—Å—Å–∞)
        class_changes = np.where(
            np.concatenate([[True], zone_classes[1:] != zone_classes[:-1]])
        )[0]
        boundaries = np.concatenate([class_changes, [len(df)]])
        
        zones = []
        for i in range(len(boundaries) - 1):
            start_idx = boundaries[i]
            end_idx = boundaries[i + 1] - 1
            duration = end_idx - start_idx + 1
            
            if duration < config.min_duration:
                continue
            
            zone_type = zone_classes[start_idx]
            
            if zone_type not in config.zone_types:
                continue
            
            zone_data = df.iloc[start_idx:end_idx + 1].copy()
            
            zone = ZoneInfo(
                zone_id=len(zones),
                type=zone_type,
                start_idx=start_idx,
                end_idx=end_idx,
                start_time=df.index[start_idx],
                end_time=df.index[end_idx],
                duration=duration,
                data=zone_data
            )
            zones.append(zone)
        
        self.logger.info(
            f"Detected {len(zones)} zones: "
            f"OB={sum(1 for z in zones if z.type == 'overbought')}, "
            f"N={sum(1 for z in zones if z.type == 'neutral')}, "
            f"OS={sum(1 for z in zones if z.type == 'oversold')}"
        )
        
        return zones
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: LineCrossingDetection

```python
# bquant/analysis/zones/detection/line_crossing.py

import pandas as pd
import numpy as np
from typing import List

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'line_crossing',
    description='Detect zones by two lines crossing each other',
    supported_zones=['bull', 'bear'],
    required_rules=['line1_col', 'line2_col']
)
class LineCrossingDetection:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –¥–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é –¥–≤—É—Ö –ª–∏–Ω–∏–π.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - MA crosses (fast MA vs slow MA)
        - Price vs MA
        - Bollinger Bands (price vs upper/lower band)
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - line1_col: str (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è (–æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–∞—è)
        - line2_col: str (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –≤—Ç–æ—Ä–∞—è –ª–∏–Ω–∏—è (–æ–±—ã—á–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è)
        
    –¢–∏–ø—ã –∑–æ–Ω:
        - 'bull': line1 > line2
        - 'bear': line1 < line2
    """
    
    def __init__(self):
        self.logger = get_logger(__name__)
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∑–æ–Ω—ã –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é –ª–∏–Ω–∏–π."""
        config.validate(required_rules=['line1_col', 'line2_col'])
        
        line1_col = config.rules['line1_col']
        line2_col = config.rules['line2_col']
        
        for col in [line1_col, line2_col]:
            if col not in data.columns:
                raise ValueError(f"Column '{col}' not found in data")
        
        df = data.copy()
        
        # –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ª–∏–Ω–∏—è–º–∏
        diff = df[line1_col].values - df[line2_col].values
        
        # –ó–Ω–∞–∫ —Ä–∞–∑–Ω–∏—Ü—ã
        signs = np.sign(diff)
        signs[signs == 0] = 1
        
        # –ù–∞–π—Ç–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
        sign_changes = np.where(np.diff(signs) != 0)[0] + 1
        
        if len(sign_changes) == 0:
            self.logger.warning("No line crossings found")
            return []
        
        boundaries = np.concatenate([[0], sign_changes, [len(df)]])
        
        zones = []
        for i in range(len(boundaries) - 1):
            start_idx = boundaries[i]
            end_idx = boundaries[i + 1] - 1
            duration = end_idx - start_idx + 1
            
            if duration < config.min_duration:
                continue
            
            zone_mean_diff = diff[start_idx:end_idx + 1].mean()
            zone_type = 'bull' if zone_mean_diff > 0 else 'bear'
            
            if zone_type not in config.zone_types:
                continue
            
            zone_data = df.iloc[start_idx:end_idx + 1].copy()
            
            zone = ZoneInfo(
                zone_id=len(zones),
                type=zone_type,
                start_idx=start_idx,
                end_idx=end_idx,
                start_time=df.index[start_idx],
                end_time=df.index[end_idx],
                duration=duration,
                data=zone_data
            )
            zones.append(zone)
        
        self.logger.info(f"Detected {len(zones)} zones from line crossing")
        
        return zones
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: PreloadedZonesDetection

```python
# bquant/analysis/zones/detection/preloaded.py

import pandas as pd
from typing import List, Union
from pathlib import Path

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'preloaded',
    description='Import zones from external data source (CSV, DataFrame)',
    supported_zones=['any'],
    required_rules=['zones_data']
)
class PreloadedZonesDetection:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –∏–º–ø–æ—Ä—Ç –≥–æ—Ç–æ–≤—ã—Ö –∑–æ–Ω –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - –ò–º–ø–æ—Ä—Ç –∑–æ–Ω –∏–∑ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º (MT5, cTrader)
        - –ó–æ–Ω—ã, —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏
        - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ML –º–æ–¥–µ–ª–µ–π
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - zones_data: str | Path | pd.DataFrame (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
        - time_tolerance: str (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, default='1min') - –¥–æ–ø—É—Å–∫ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –º–µ—Ä–∂–∞
        
    –§–æ—Ä–º–∞—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–æ–Ω (CSV/DataFrame):
        - zone_id: int - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
        - type: str - —Ç–∏–ø –∑–æ–Ω—ã
        - start_time: datetime - –Ω–∞—á–∞–ª–æ –∑–æ–Ω—ã
        - end_time: datetime - –∫–æ–Ω–µ—Ü –∑–æ–Ω—ã
    """
    
    def __init__(self):
        self.logger = get_logger(__name__)
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≥–æ—Ç–æ–≤—ã–µ –∑–æ–Ω—ã —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏."""
        config.validate(required_rules=['zones_data'])
        
        zones_data = config.rules['zones_data']
        time_tolerance = config.rules.get('time_tolerance', '1min')
        
        # –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–æ–Ω—ã
        zones_df = self._load_zones(zones_data)
        
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–æ–Ω–æ–∫
        required_cols = ['zone_id', 'type', 'start_time', 'end_time']
        missing = [c for c in required_cols if c not in zones_df.columns]
        if missing:
            raise ValueError(f"Missing required columns in zones data: {missing}")
        
        # –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å OHLCV
        zones = []
        for _, zone_row in zones_df.iterrows():
            zone_info = self._merge_zone_with_ohlcv(
                zone_row, data, time_tolerance
            )
            
            if zone_info and zone_info.duration >= config.min_duration:
                if zone_info.type in config.zone_types or 'any' in config.zone_types:
                    zones.append(zone_info)
        
        self.logger.info(f"Loaded {len(zones)} preloaded zones")
        
        return zones
    
    def _load_zones(self, zones_data: Union[str, Path, pd.DataFrame]) -> pd.DataFrame:
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–æ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞ –∏–ª–∏ DataFrame."""
        if isinstance(zones_data, pd.DataFrame):
            return zones_data.copy()
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
        path = Path(zones_data)
        if not path.exists():
            raise FileNotFoundError(f"Zones file not found: {path}")
        
        if path.suffix == '.csv':
            df = pd.read_csv(path, parse_dates=['start_time', 'end_time'])
        elif path.suffix in ['.xlsx', '.xls']:
            df = pd.read_excel(path, parse_dates=['start_time', 'end_time'])
        else:
            raise ValueError(f"Unsupported file format: {path.suffix}")
        
        return df
    
    def _merge_zone_with_ohlcv(self, 
                                zone_row: pd.Series, 
                                ohlcv: pd.DataFrame,
                                time_tolerance: str) -> ZoneInfo:
        """–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –∑–æ–Ω—É —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏."""
        start_time = pd.Timestamp(zone_row['start_time'])
        end_time = pd.Timestamp(zone_row['end_time'])
        
        # –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã —Å –¥–æ–ø—É—Å–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏
        mask = (ohlcv.index >= start_time - pd.Timedelta(time_tolerance)) & \
               (ohlcv.index <= end_time + pd.Timedelta(time_tolerance))
        
        zone_data = ohlcv[mask].copy()
        
        if zone_data.empty:
            self.logger.warning(
                f"No OHLCV data found for zone {zone_row['zone_id']} "
                f"({start_time} - {end_time})"
            )
            return None
        
        return ZoneInfo(
            zone_id=int(zone_row['zone_id']),
            type=str(zone_row['type']),
            start_idx=ohlcv.index.get_loc(zone_data.index[0]),
            end_idx=ohlcv.index.get_loc(zone_data.index[-1]),
            start_time=zone_data.index[0],
            end_time=zone_data.index[-1],
            duration=len(zone_data),
            data=zone_data
        )


def load_preloaded_zones(zones_path: Union[str, Path], 
                         ohlcv_data: pd.DataFrame,
                         time_tolerance: str = '1min',
                         min_duration: int = 2) -> List[ZoneInfo]:
    """
    Helper function –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ—Ç–æ–≤—ã—Ö –∑–æ–Ω.
    
    Args:
        zones_path: –ü—É—Ç—å –∫ CSV/Excel —Å –∑–æ–Ω–∞–º–∏
        ohlcv_data: DataFrame —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏
        time_tolerance: –î–æ–ø—É—Å–∫ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –º–µ—Ä–∂–∞
        min_duration: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–æ–Ω—ã
        
    Returns:
        List[ZoneInfo]
        
    Example:
        zones = load_preloaded_zones('expert_zones.csv', df)
        analyzer = UniversalZoneAnalyzer()
        result = analyzer.analyze_zones(zones, df)
    """
    detector = PreloadedZonesDetection()
    config = ZoneDetectionConfig(
        min_duration=min_duration,
        zone_types=['any'],
        rules={
            'zones_data': zones_path,
            'time_tolerance': time_tolerance
        },
        strategy_name='preloaded'
    )
    
    return detector.detect_zones(ohlcv_data, config)
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è 5: CombinedRulesDetection

```python
# bquant/analysis/zones/detection/combined.py

import pandas as pd
import numpy as np
from typing import List, Callable, Literal

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'combined',
    description='Detect zones by combining multiple conditions with AND/OR logic',
    supported_zones=['custom'],
    required_rules=['conditions']
)
class CombinedRulesDetection:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –¥–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —É—Å–ª–æ–≤–∏–π.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞
        - –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        - –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - conditions: List[Callable] (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π-—É—Å–ª–æ–≤–∏–π
        - logic: 'AND' | 'OR' (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, default='AND')
        - zone_type_map: Dict[bool, str] (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞–ø–ø–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞ —Ç–∏–ø –∑–æ–Ω—ã
        
    Example:
        conditions = [
            lambda df: df['macd'] > 0,
            lambda df: df['rsi'] < 70,
            lambda df: df['close'] > df['sma_50']
        ]
        config = ZoneDetectionConfig(
            strategy_name='combined',
            rules={
                'conditions': conditions,
                'logic': 'AND'
            }
        )
    """
    
    def __init__(self):
        self.logger = get_logger(__name__)
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∑–æ–Ω—ã –ø–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º."""
        config.validate(required_rules=['conditions'])
        
        conditions = config.rules['conditions']
        logic = config.rules.get('logic', 'AND').upper()
        zone_type_map = config.rules.get('zone_type_map', {True: 'active', False: 'inactive'})
        
        if logic not in ['AND', 'OR']:
            raise ValueError(f"logic must be 'AND' or 'OR', got '{logic}'")
        
        df = data.copy()
        
        # –í—ã—á–∏—Å–ª–∏—Ç—å –≤—Å–µ —É—Å–ª–æ–≤–∏—è
        condition_results = []
        for i, cond in enumerate(conditions):
            try:
                result = cond(df)
                if not isinstance(result, (pd.Series, np.ndarray)):
                    raise TypeError(f"Condition {i} must return pd.Series or np.ndarray")
                condition_results.append(result)
            except Exception as e:
                raise ValueError(f"Error evaluating condition {i}: {e}")
        
        # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—è
        if logic == 'AND':
            combined = np.logical_and.reduce(condition_results)
        else:  # OR
            combined = np.logical_or.reduce(condition_results)
        
        # –ù–∞–π—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã –∑–æ–Ω
        changes = np.where(
            np.concatenate([[True], combined[1:] != combined[:-1]])
        )[0]
        boundaries = np.concatenate([changes, [len(df)]])
        
        zones = []
        for i in range(len(boundaries) - 1):
            start_idx = boundaries[i]
            end_idx = boundaries[i + 1] - 1
            duration = end_idx - start_idx + 1
            
            if duration < config.min_duration:
                continue
            
            zone_active = combined[start_idx]
            zone_type = zone_type_map.get(zone_active, f'zone_{zone_active}')
            
            if zone_type not in config.zone_types:
                continue
            
            zone_data = df.iloc[start_idx:end_idx + 1].copy()
            
            zone = ZoneInfo(
                zone_id=len(zones),
                type=zone_type,
                start_idx=start_idx,
                end_idx=end_idx,
                start_time=df.index[start_idx],
                end_time=df.index[end_idx],
                duration=duration,
                data=zone_data
            )
            zones.append(zone)
        
        self.logger.info(f"Detected {len(zones)} zones from combined rules ({logic})")
        
        return zones
```

### –®–∞–±–ª–æ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

```python
# bquant/analysis/zones/detection/my_new_strategy.py

"""
TEMPLATE: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–æ–Ω

–®–∞–≥–∏:
1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω
2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å –∏ —Ñ–∞–π–ª
3. –û–±–Ω–æ–≤–∏—Ç—å @register –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å detect_zones()
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
6. –ì–æ—Ç–æ–≤–æ! –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
"""

import pandas as pd
from typing import List

from .base import ZoneDetectionStrategy, ZoneDetectionConfig
from .registry import ZoneDetectionRegistry
from ..models import ZoneInfo
from bquant.core import get_logger


@ZoneDetectionRegistry.register(
    'my_strategy',  # ‚Üê –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è
    description='Short description of what this strategy does',
    supported_zones=['type1', 'type2'],
    required_rules=['param1', 'param2']
)
class MyNewDetectionStrategy:
    """
    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: [–æ–ø–∏—Å–∞–Ω–∏–µ].
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - [–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä 1]
        - [–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä 2]
        
    –ü—Ä–∞–≤–∏–ª–∞ (config.rules):
        - param1: type (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –æ–ø–∏—Å–∞–Ω–∏–µ
        - param2: type (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –æ–ø–∏—Å–∞–Ω–∏–µ
        
    –¢–∏–ø—ã –∑–æ–Ω:
        - 'type1': –∫–æ–≥–¥–∞ ...
        - 'type2': –∫–æ–≥–¥–∞ ...
    """
    
    def __init__(self, optional_param=None):
        self.logger = get_logger(__name__)
        self.optional_param = optional_param
    
    def detect_zones(self, 
                     data: pd.DataFrame,
                     config: ZoneDetectionConfig) -> List[ZoneInfo]:
        """–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∑–æ–Ω—ã –ø–æ [–≤–∞—à–∏–º –ø—Ä–∞–≤–∏–ª–∞–º]."""
        # 1. –í–∞–ª–∏–¥–∞—Ü–∏—è
        config.validate(required_rules=['param1', 'param2'])
        
        # 2. –ò–∑–≤–ª–µ—á—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        param1 = config.rules['param1']
        param2 = config.rules['param2']
        
        # 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        if 'required_col' not in data.columns:
            raise ValueError(f"Required column not found")
        
        df = data.copy()
        
        # 4. ========== –í–ê–®–ê –õ–û–ì–ò–ö–ê –ó–î–ï–°–¨ ==========
        # –ù–∞–π—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã –∑–æ–Ω...
        # –°–æ–∑–¥–∞—Ç—å List[ZoneInfo]...
        
        zones = []
        # ... –≤–∞—à –∫–æ–¥ ...
        
        # 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        self.logger.info(f"Detected {len(zones)} zones")
        
        return zones
```

---

<a name="—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è"></a>
## –¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ –≤ –±—É–¥—É—â–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞. –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Dependency Injection –∏–ª–∏ Registry Pattern –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

### 1. –°–ª–æ–π 1: Zone Detection Strategies (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞)

**–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —Ç–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏.

#### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `bquant/analysis/zones/detection/my_strategy.py`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å —Å –º–µ—Ç–æ–¥–æ–º `detect_zones(data, config)`
3. –î–æ–±–∞–≤–∏—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@ZoneDetectionRegistry.register('my_strategy', ...)`
4. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
5. **–ì–æ—Ç–æ–≤–æ!** –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–æ –≤—Å–µ—Ö Builder/Pipeline

#### –ü—Ä–∏–º–µ—Ä—ã –±—É–¥—É—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:

```python
# 1. Pattern-based Detection (—Å–≤–µ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
@ZoneDetectionRegistry.register('pattern_based')
class PatternBasedDetection:
    """
    –ó–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–µ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - Doji –∑–æ–Ω—ã
        - Hammer/Shooting star
        - Engulfing patterns
    """
    def detect_zones(self, data, config):
        patterns = config.rules['patterns']  # ['doji', 'hammer', ...]
        # –î–µ—Ç–µ–∫—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤ –∑–æ–Ω—ã
        return zones


# 2. ML-based Detection (–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ)
@ZoneDetectionRegistry.register('ml_classifier')
class MLBasedDetection:
    """
    –ó–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ ML –º–æ–¥–µ–ª–∏.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - Sklearn –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        - PyTorch –º–æ–¥–µ–ª–∏
        - Custom ML –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    """
    def __init__(self, model_path: str):
        self.model = load_model(model_path)
    
    def detect_zones(self, data, config):
        features = extract_features(data, config.rules['feature_cols'])
        predictions = self.model.predict(features)
        zones = group_predictions_to_zones(predictions, data)
        return zones


# 3. Multi-Indicator Detection (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤)
@ZoneDetectionRegistry.register('multi_indicator')
class MultiIndicatorDetection:
    """
    –ó–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - MACD + RSI + Volume
        - Bollinger + ATR + Momentum
        - Custom –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
    """
    def detect_zones(self, data, config):
        indicators = config.rules['indicators']  # {'macd': 'bull', 'rsi': 'oversold', ...}
        # –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        # Intersection/Union –∑–æ–Ω
        return zones


# 4. Volume Profile Detection
@ZoneDetectionRegistry.register('volume_profile')
class VolumeProfileDetection:
    """
    –ó–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ñ–∏–ª—è –æ–±—ä–µ–º–∞.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - POC (Point of Control) –∑–æ–Ω—ã
        - High Volume Nodes
        - Low Volume Nodes
    """
    def detect_zones(self, data, config):
        profile = calculate_volume_profile(data, config.rules['bins'])
        zones = identify_volume_zones(profile, config.rules['threshold'])
        return zones


# 5. Market Structure Detection
@ZoneDetectionRegistry.register('market_structure')
class MarketStructureDetection:
    """
    –ó–æ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞ (Smart Money Concepts).
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
        - Break of Structure (BOS)
        - Change of Character (CHoCH)
        - Order Blocks
        - Fair Value Gaps
    """
    def detect_zones(self, data, config):
        structure = analyze_market_structure(data)
        zones = identify_smc_zones(structure, config.rules['zone_type'])
        return zones
```

#### –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (0 –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ):

```python
# –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π
# bquant/analysis/zones/detection/my_new_strategy.py

@ZoneDetectionRegistry.register('my_new_strategy')
class MyNewStrategy:
    def detect_zones(self, data, config):
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
        return zones

# –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É!
result = (
    analyze_zones(df)
    .detect_zones('my_new_strategy', param1=value1)  # ‚Üê –°—Ä–∞–∑—É —Ä–∞–±–æ—Ç–∞–µ—Ç!
    .build()
)
```

### 2. –°–ª–æ–π 2: Universal Analyzer (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DI)

**–¢–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Dependency Injection.

#### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è):

```python
class UniversalZoneAnalyzer:
    def __init__(self,
                 # –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´
                 features_analyzer=None,
                 hypothesis_suite=None,
                 sequence_analyzer=None,
                 regression_analyzer=None,
                 validation_suite=None,
                 
                 # –ù–û–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ (—Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
                 ml_predictor=None,           # ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
                 optimization_engine=None,     # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                 backtesting_engine=None,      # –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
                 risk_analyzer=None,           # –†–∏—Å–∫-–∞–Ω–∞–ª–∏–∑
                 export_manager=None):         # –≠–∫—Å–ø–æ—Ä—Ç (MT5, cTrader, ...)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...
        self.ml = ml_predictor
        self.optimizer = optimization_engine
        self.backtest = backtesting_engine
        self.risk = risk_analyzer
        self.export = export_manager
```

#### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π:

```python
# 1. ML Predictor (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è)
class ZoneMLPredictor:
    """–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –∑–æ–Ω —á–µ—Ä–µ–∑ ML."""
    
    def predict_next_zone_type(self, zones_history):
        """–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ç–∏–ø —Å–ª–µ–¥—É—é—â–µ–π –∑–æ–Ω—ã."""
        pass
    
    def predict_zone_duration(self, zone_features):
        """–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–æ–Ω—ã."""
        pass
    
    def predict_zone_return(self, zone_features):
        """–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–æ–Ω—ã."""
        pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
ml_predictor = ZoneMLPredictor(model_path='models/zone_predictor.pkl')
analyzer = UniversalZoneAnalyzer(ml_predictor=ml_predictor)
result = analyzer.analyze_zones(zones, df, run_ml_predictions=True)


# 2. Backtesting Engine (–±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∑–æ–Ω)
class ZoneBacktestingEngine:
    """–ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –Ω–∞ –∑–æ–Ω–∞—Ö."""
    
    def backtest_simple_entry(self, zones, data, stop_loss, take_profit):
        """–ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—Ö–æ–¥–∞ –≤ –∑–æ–Ω—É."""
        pass
    
    def backtest_custom_strategy(self, zones, data, strategy_func):
        """–ö–∞—Å—Ç–æ–º–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è."""
        pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
backtest = ZoneBacktestingEngine()
analyzer = UniversalZoneAnalyzer(backtesting_engine=backtest)
result = analyzer.analyze_zones(zones, df, run_backtesting=True)


# 3. Risk Analyzer (—Ä–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏)
class ZoneRiskAnalyzer:
    """–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∑–æ–Ω."""
    
    def calculate_var(self, zones):
        """Value at Risk –¥–ª—è –∑–æ–Ω."""
        pass
    
    def calculate_drawdown(self, zones):
        """–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞."""
        pass
    
    def calculate_sharpe_ratio(self, zones):
        """Sharpe Ratio –¥–ª—è –∑–æ–Ω."""
        pass
```

### 3. Pipeline: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–¢–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–ø—Ü–∏–π –≤ `ZoneAnalysisConfig`.

```python
@dataclass
class ZoneAnalysisConfig:
    # –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï
    indicator: Optional[IndicatorConfig] = None
    zone_detection: ZoneDetectionConfig = None
    perform_clustering: bool = True
    n_clusters: int = 3
    run_regression: bool = False
    run_validation: bool = False
    
    # –ù–û–í–´–ï –û–ü–¶–ò–ò (—Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
    
    # –ü—Ä–µ-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    preprocessing: Optional[Dict[str, Any]] = None
    # Example: {'outlier_removal': True, 'fill_gaps': 'interpolate'}
    
    # –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–æ–Ω
    postprocessing: Optional[Dict[str, Any]] = None
    # Example: {'merge_adjacent': True, 'max_gap': 3}
    
    # –§–∏–ª—å—Ç—Ä—ã –∑–æ–Ω
    filters: Optional[List[Callable]] = None
    # Example: [lambda z: z.duration > 5, lambda z: z.type == 'bull']
    
    # –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–æ–Ω
    transformers: Optional[List[Callable]] = None
    # Example: [merge_short_zones, split_long_zones]
    
    # ML –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    ml_config: Optional[Dict[str, Any]] = None
    # Example: {'model_path': 'models/predictor.pkl', 'features': [...]}
    
    # –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
    backtest_config: Optional[Dict[str, Any]] = None
    # Example: {'strategy': 'simple_entry', 'stop_loss': 0.02}
    
    # –≠–∫—Å–ø–æ—Ä—Ç
    export_config: Optional[List[Dict[str, str]]] = None
    # Example: [{'format': 'csv', 'path': 'zones.csv'}, {'format': 'mt5', 'path': 'EA.mq5'}]
```

### 4. Builder: –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã (fluent API)

**–¢–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ `ZoneAnalysisBuilder`.

```python
class ZoneAnalysisBuilder:
    # –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –ú–ï–¢–û–î–´
    # .with_indicator(), .detect_zones(), .analyze(), .build()
    
    # –ù–û–í–´–ï –ú–ï–¢–û–î–´ (—Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):
    
    def preprocess(self, **params) -> 'ZoneAnalysisBuilder':
        """
        –ü—Ä–µ-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –¥–µ—Ç–µ–∫—Ü–∏–µ–π.
        
        Example:
            .preprocess(outlier_removal=True, fill_gaps='interpolate')
        """
        self._preprocessing = params
        return self
    
    def filter_zones(self, 
                     min_duration: int = None,
                     max_duration: int = None,
                     zone_types: List[str] = None,
                     custom_filter: Callable = None) -> 'ZoneAnalysisBuilder':
        """
        –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–æ–Ω –ø–æ—Å–ª–µ –¥–µ—Ç–µ–∫—Ü–∏–∏.
        
        Example:
            .filter_zones(min_duration=5, zone_types=['bull'])
        """
        filters = []
        if min_duration:
            filters.append(lambda z: z.duration >= min_duration)
        if max_duration:
            filters.append(lambda z: z.duration <= max_duration)
        if zone_types:
            filters.append(lambda z: z.type in zone_types)
        if custom_filter:
            filters.append(custom_filter)
        
        self._filters = filters
        return self
    
    def transform_zones(self, *transformers: Callable) -> 'ZoneAnalysisBuilder':
        """
        –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–æ–Ω.
        
        Example:
            .transform_zones(merge_adjacent_zones, split_long_zones)
        """
        self._transformers = list(transformers)
        return self
    
    def with_ml_predictions(self, 
                           model_path: str,
                           features: List[str] = None) -> 'ZoneAnalysisBuilder':
        """
        –î–æ–±–∞–≤–∏—Ç—å ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.
        
        Example:
            .with_ml_predictions('models/zone_predictor.pkl', features=['duration', 'volatility'])
        """
        self._ml_config = {'model_path': model_path, 'features': features}
        return self
    
    def with_backtesting(self, 
                        strategy: str = 'simple_entry',
                        **params) -> 'ZoneAnalysisBuilder':
        """
        –î–æ–±–∞–≤–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥.
        
        Example:
            .with_backtesting('simple_entry', stop_loss=0.02, take_profit=0.05)
        """
        self._backtest_config = {'strategy': strategy, **params}
        return self
    
    def export_to(self, 
                  format: str, 
                  path: str,
                  **options) -> 'ZoneAnalysisBuilder':
        """
        –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
        
        Example:
            .export_to('csv', 'results/zones.csv')
            .export_to('mt5', 'EA_Zones.mq5', template='scalping')
        """
        if self._export_config is None:
            self._export_config = []
        
        self._export_config.append({
            'format': format,
            'path': path,
            **options
        })
        return self
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π:

```python
result = (
    analyze_zones(df)
    
    # –û—Å–Ω–æ–≤–Ω–æ–π pipeline
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    
    # –ù–û–í–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò:
    
    # –ü—Ä–µ-–æ–±—Ä–∞–±–æ—Ç–∫–∞
    .preprocess(outlier_removal=True, fill_gaps='interpolate')
    
    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–æ–Ω
    .filter_zones(min_duration=5, zone_types=['bull'])
    
    # –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
    .transform_zones(merge_adjacent_zones, normalize_zone_data)
    
    # ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    .with_ml_predictions('models/zone_predictor.pkl')
    
    # –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
    .with_backtesting('simple_entry', stop_loss=0.02, take_profit=0.05)
    
    # –ê–Ω–∞–ª–∏–∑
    .analyze(clustering=True, n_clusters=3, regression=True)
    
    # –≠–∫—Å–ø–æ—Ä—Ç
    .export_to('csv', 'results/zones.csv')
    .export_to('json', 'results/zones.json')
    .export_to('mt5', 'EA_Zones.mq5', template='scalping')
    
    .build()
)
```

### 5. –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (–±—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

```
bquant/analysis/zones/
‚îú‚îÄ‚îÄ detection/          # –°–ª–æ–π 1 (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îú‚îÄ‚îÄ analyzer.py         # –°–ª–æ–π 2 (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îú‚îÄ‚îÄ pipeline.py         # Pipeline + Builder (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îÇ
‚îú‚îÄ‚îÄ filters.py          # –ù–û–í–û–ï - —Ñ–∏–ª—å—Ç—Ä—ã –∑–æ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ DurationFilter
‚îÇ   ‚îú‚îÄ‚îÄ TypeFilter
‚îÇ   ‚îú‚îÄ‚îÄ VolatilityFilter
‚îÇ   ‚îî‚îÄ‚îÄ CustomFilter
‚îÇ
‚îú‚îÄ‚îÄ transformers.py     # –ù–û–í–û–ï - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–æ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ MergeAdjacentZones
‚îÇ   ‚îú‚îÄ‚îÄ SplitLongZones
‚îÇ   ‚îú‚îÄ‚îÄ NormalizeZoneData
‚îÇ   ‚îî‚îÄ‚îÄ EnrichWithFeatures
‚îÇ
‚îú‚îÄ‚îÄ exporters/          # –ù–û–í–û–ï - —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ base.py        # BaseExporter
‚îÇ   ‚îú‚îÄ‚îÄ csv_exporter.py
‚îÇ   ‚îú‚îÄ‚îÄ json_exporter.py
‚îÇ   ‚îú‚îÄ‚îÄ mt5_exporter.py
‚îÇ   ‚îî‚îÄ‚îÄ ctrader_exporter.py
‚îÇ
‚îú‚îÄ‚îÄ ml/                 # –ù–û–í–û–ï - ML –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ predictors.py  # ZoneMLPredictor
‚îÇ   ‚îú‚îÄ‚îÄ classifiers.py # ZoneClassifier
‚îÇ   ‚îú‚îÄ‚îÄ features.py    # Feature engineering –¥–ª—è ML
‚îÇ   ‚îî‚îÄ‚îÄ optimization.py # Hyperparameter optimization
‚îÇ
‚îú‚îÄ‚îÄ backtesting/        # –ù–û–í–û–ï - –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ engine.py      # BacktestingEngine
‚îÇ   ‚îú‚îÄ‚îÄ strategies.py  # TradingStrategies
‚îÇ   ‚îú‚îÄ‚îÄ metrics.py     # Performance metrics
‚îÇ   ‚îî‚îÄ‚îÄ reports.py     # Reporting
‚îÇ
‚îî‚îÄ‚îÄ risk/               # –ù–û–í–û–ï - —Ä–∏—Å–∫-–∞–Ω–∞–ª–∏–∑
    ‚îú‚îÄ‚îÄ metrics.py     # VaR, Sharpe, Sortino, ...
    ‚îú‚îÄ‚îÄ drawdown.py    # Drawdown analysis
    ‚îî‚îÄ‚îÄ portfolio.py   # Portfolio-level risk
```

### 6. –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ç–æ—á–µ–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

| –û–±–ª–∞—Å—Ç—å | –°–ø–æ—Å–æ–± —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ | –£—Å–∏–ª–∏—è |
|---------|-------------------|------------------|--------|
| **Zone Detection** | –ù–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è + @register | 0 —Å—Ç—Ä–æ–∫ | –ù–∏–∑–∫–∏–µ |
| **Zone Analyzer** | DI –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ | ~10 —Å—Ç—Ä–æ–∫ (–æ–ø—Ü–∏–∏) | –°—Ä–µ–¥–Ω–∏–µ |
| **Pipeline Config** | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ dataclass | ~5 —Å—Ç—Ä–æ–∫ | –ù–∏–∑–∫–∏–µ |
| **Builder Methods** | –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã (return self) | ~20 —Å—Ç—Ä–æ–∫/–º–µ—Ç–æ–¥ | –ù–∏–∑–∫–∏–µ |
| **Filters** | –ù–æ–≤—ã–π –∫–ª–∞—Å—Å/—Ñ—É–Ω–∫—Ü–∏—è | 0 —Å—Ç—Ä–æ–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ config) | –ù–∏–∑–∫–∏–µ |
| **Transformers** | –ù–æ–≤—ã–π –∫–ª–∞—Å—Å/—Ñ—É–Ω–∫—Ü–∏—è | 0 —Å—Ç—Ä–æ–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ config) | –ù–∏–∑–∫–∏–µ |
| **Exporters** | –ù–æ–≤—ã–π –∫–ª–∞—Å—Å + registry | ~10 —Å—Ç—Ä–æ–∫ (registry) | –°—Ä–µ–¥–Ω–∏–µ |
| **ML Components** | –ù–æ–≤—ã–π –∫–ª–∞—Å—Å + DI | ~10 —Å—Ç—Ä–æ–∫ (–æ–ø—Ü–∏–∏) | –°—Ä–µ–¥–Ω–∏–µ-–í—ã—Å–æ–∫–∏–µ |

### 7. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (Design Patterns)

1. **Open/Closed Principle** - –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –∑–∞–∫—Ä—ã—Ç–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. **Strategy Pattern** - –¥–ª—è Zone Detection
3. **Dependency Injection** - –¥–ª—è Zone Analyzer –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **Builder Pattern** - –¥–ª—è fluent API
5. **Registry Pattern** - –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
6. **Protocol/Interface** - –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

---

<a name="–ø—Ä–∏–º–µ—Ä—ã"></a>
## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: MACD —á–µ—Ä–µ–∑ fluent builder (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```python
from bquant.analysis.zones import analyze_zones

result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26, signal=9)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True, n_clusters=3)
    .build()
)

print(f"Found {len(result.zones)} zones")
```

### –ü—Ä–∏–º–µ—Ä 2: PRELOADED –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä + —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –∑–æ–Ω—ã

```python
# df —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç MACD –∫–æ–ª–æ–Ω–∫–∏
result = (
    analyze_zones(df)
    # –ù–ï–¢ with_indicator - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É–∂–µ –≤ –¥–∞–Ω–Ω—ã—Ö!
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True)
    .build()
)
```

### –ü—Ä–∏–º–µ—Ä 3: PRELOADED –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä + PRELOADED –∑–æ–Ω—ã

```python
# df —Å–æ–¥–µ—Ä–∂–∏—Ç MACD, –∑–æ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞
result = (
    analyze_zones(df)
    # –ù–ï–¢ with_indicator
    .detect_zones('preloaded', zones_data='expert_zones.csv', time_tolerance='5min')
    .analyze()
    .build()
)

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - –Ω–µ—Ç —Ä–∞—Å—á–µ—Ç–æ–≤!
```

### –ü—Ä–∏–º–µ—Ä 4: AO —á–µ—Ä–µ–∑ pandas_ta

```python
result = (
    analyze_zones(df)
    .with_indicator('pandas_ta', 'ao')
    .detect_zones('zero_crossing', indicator_col='AO_5_34')
    .analyze()
    .build()
)
```

### –ü—Ä–∏–º–µ—Ä 5: RSI —á–µ—Ä–µ–∑ talib —Å 3 —Ç–∏–ø–∞–º–∏ –∑–æ–Ω

```python
result = (
    analyze_zones(df)
    .with_indicator('talib', 'rsi', timeperiod=14)
    .detect_zones('threshold', indicator_col='RSI', upper_threshold=70, lower_threshold=30)
    .analyze(clustering=True)
    .build()
)

# –¢–∏–ø—ã –∑–æ–Ω: overbought, neutral, oversold
print(f"Overbought: {sum(1 for z in result.zones if z.type == 'overbought')}")
print(f"Oversold: {sum(1 for z in result.zones if z.type == 'oversold')}")
```

### –ü—Ä–∏–º–µ—Ä 6: –ß–µ—Ä–µ–∑ Pipeline —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

```python
from bquant.analysis.zones.pipeline import ZoneAnalysisPipeline, ZoneAnalysisConfig, IndicatorConfig
from bquant.analysis.zones.detection import ZoneDetectionConfig

# –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª)
config = ZoneAnalysisConfig(
    indicator=IndicatorConfig(
        source='custom',
        name='macd',
        params={'fast': 12, 'slow': 26, 'signal': 9}
    ),
    zone_detection=ZoneDetectionConfig(
        strategy_name='zero_crossing',
        min_duration=2,
        rules={'indicator_col': 'macd'}
    ),
    perform_clustering=True,
    n_clusters=3,
    run_regression=True
)

# –í—ã–ø–æ–ª–Ω—è–µ–º
pipeline = ZoneAnalysisPipeline(config)
result = pipeline.run(df)
```

### –ü—Ä–∏–º–µ—Ä 7: –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å)

```python
from bquant.indicators import IndicatorFactory
from bquant.analysis.zones.detection import ZoneDetectionRegistry, ZoneDetectionConfig
from bquant.analysis.zones import UniversalZoneAnalyzer

# 1. –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
indicator = IndicatorFactory.create('custom', 'macd', fast=12, slow=26)
result_ind = indicator.calculate(df)

df_with_macd = df.copy()
for col in result_ind.data.columns:
    df_with_macd[col] = result_ind.data[col]

# 2. –î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω
detector = ZoneDetectionRegistry.get('zero_crossing')
zones = detector.detect_zones(
    df_with_macd,
    ZoneDetectionConfig(
        strategy_name='zero_crossing',
        rules={'indicator_col': 'macd'}
    )
)

# 3. –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω
analyzer = UniversalZoneAnalyzer()
result = analyzer.analyze_zones(zones, df_with_macd, perform_clustering=True)
```

> **–î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ [`zomodul.md`](zomodul.md)**  
> –í–∫–ª—é—á–∞—è: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, feature engineering –¥–ª—è ML

### –ü—Ä–∏–º–µ—Ä 8: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

```python
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('combined', 
                  conditions=[
                      lambda df: df['macd'] > 0,
                      lambda df: df['close'] > df['close'].rolling(50).mean()
                  ],
                  logic='AND')
    .analyze()
    .build()
)
```

---

<a name="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è"></a>
## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ BQuant

–ü–∞–∫–µ—Ç —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–æ–¥—É–ª—å `bquant.visualization` —Å –∫–ª–∞—Å—Å–æ–º `ZoneVisualizer`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- `plot_zones_on_price_chart()` - –æ–±—â–∏–π –≥—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω —Å –∑–æ–Ω–∞–º–∏
- `plot_macd_zones()` - –∑–æ–Ω—ã –Ω–∞ MACD –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ
- `plot_zones_analysis()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–æ–Ω
- `plot_zones_distribution()` - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- `plot_zones_correlation()` - –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –º–µ—Ç—Ä–∏–∫

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** Plotly (–æ—Å–Ω–æ–≤–Ω–æ–π) + Matplotlib (fallback)

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–æ–Ω —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –º–µ—Ç—Ä–∏–∫ (zigzag, pivot points, divergence, etc.) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–≤–∞ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–∞ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `ZoneVisualizer`:

#### 1. –î–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–æ–Ω—ã (plot_zone_detail)

```python
# bquant/visualization/zones.py (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–ª–∞—Å—Å–∞)

class ZoneVisualizer(ZoneChartBuilder):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã ...
    
    def plot_zone_detail(self,
                        zone: Union[ZoneInfo, Dict],
                        analysis_data: pd.DataFrame,
                        show_indicators: Optional[List[str]] = None,
                        context_bars: int = 10,
                        **kwargs) -> Union[go.Figure, plt.Figure]:
        """
        –î–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–æ–Ω—ã —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –º–µ—Ç—Ä–∏–∫.
        
        –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
        - Row 1: Candlestick chart —Å –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (zigzag, pivots)
        - Row 2: –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä (MACD/RSI/CCI –µ—Å–ª–∏ –µ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã—Ö)
        - Row 3: Volume (–µ—Å–ª–∏ –µ—Å—Ç—å)
        
        Args:
            zone: ZoneInfo –∏–ª–∏ dict —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–æ–Ω—ã
            analysis_data: –ü–æ–ª–Ω—ã–π DataFrame —Å OHLCV + all indicators
            show_indicators: –°–ø–∏—Å–æ–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                           None = auto-detect from zone.features
                           Supported: ['zigzag', 'pivot_points', 'divergence', 
                                      'volatility_bands']
            context_bars: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞—Ä–æ–≤ –¥–æ/–ø–æ—Å–ª–µ –∑–æ–Ω—ã –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
            **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
                - show_swings: bool (default=True if detected)
                - show_pivots: bool (default=True if detected)
                - show_divergence: bool (default=True if detected)
                - show_volume: bool (default=True if available)
                - width: int (default=1200)
                - height: int (default=800)
        
        Returns:
            Plotly/Matplotlib —Ñ–∏–≥—É—Ä–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–æ–º
            
        Example:
            visualizer = ZoneVisualizer()
            
            # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ features –∑–æ–Ω—ã
            fig = visualizer.plot_zone_detail(zones[0], df)
            fig.show()
            
            # –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
            fig = visualizer.plot_zone_detail(
                zones[0], df,
                show_indicators=['zigzag', 'pivot_points'],
                context_bars=20
            )
            fig.show()
        """
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–æ–Ω—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
        zone_window = self._get_zone_window(zone, analysis_data, context_bars)
        
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        if show_indicators is None:
            show_indicators = self._detect_indicators_from_features(zone)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        if self.backend == 'plotly':
            return self._create_plotly_zone_detail(
                zone, zone_window, show_indicators, **kwargs
            )
        else:
            return self._create_matplotlib_zone_detail(
                zone, zone_window, show_indicators, **kwargs
            )
    
    # Helper methods
    def _get_zone_window(self, zone, df: pd.DataFrame, context_bars: int) -> pd.DataFrame:
        """–ü–æ–ª—É—á–∏—Ç—å –æ–∫–Ω–æ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∫—Ä—É–≥ –∑–æ–Ω—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º."""
        start_idx = max(0, zone.start_idx - context_bars)
        end_idx = min(len(df), zone.end_idx + context_bars)
        return df.iloc[start_idx:end_idx].copy()
    
    def _detect_indicators_from_features(self, zone) -> List[str]:
        """
        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏–∑ zone.features.
        
        –ü—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏:
        - 'swing_*' keys ‚Üí 'zigzag'
        - 'pivot_*' keys ‚Üí 'pivot_points'
        - 'divergence_*' keys ‚Üí 'divergence'
        - 'volatility_*' keys ‚Üí 'volatility_bands'
        """
        indicators = []
        if hasattr(zone, 'features') and zone.features:
            if any(k.startswith('swing_') for k in zone.features):
                indicators.append('zigzag')
            if any(k.startswith('pivot_') for k in zone.features):
                indicators.append('pivot_points')
            if any(k.startswith('divergence_') for k in zone.features):
                indicators.append('divergence')
            if any(k.startswith('volatility_') for k in zone.features):
                indicators.append('volatility_bands')
        return indicators
```

#### 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–æ–Ω (plot_zones_comparison)

```python
    def plot_zones_comparison(self,
                             zones: List[Union[ZoneInfo, Dict]],
                             analysis_data: pd.DataFrame,
                             date_range: Optional[Tuple[datetime, datetime]] = None,
                             max_zones: int = 5,
                             **kwargs) -> Union[go.Figure, plt.Figure]:
        """
        –ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–æ–Ω –∏–ª–∏ –∑–æ–Ω –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç.
        
        Args:
            zones: –°–ø–∏—Å–æ–∫ –∑–æ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏–ª–∏ –≤—Å–µ –∑–æ–Ω—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
            analysis_data: –ü–æ–ª–Ω—ã–π DataFrame —Å OHLCV + indicators
            date_range: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (start, end) –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
            max_zones: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö –∑–æ–Ω
            **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
                - overlay_mode: bool (default=False) - –Ω–∞–ª–æ–∂–∏—Ç—å –∑–æ–Ω—ã
                - show_legend: bool (default=True)
                - highlight_selected: bool (default=True)
        
        Returns:
            Plotly/Matplotlib —Ñ–∏–≥—É—Ä–∞ —Å –≥—Ä–∞—Ñ–∏–∫–æ–º
            
        Example:
            # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–æ–Ω—ã
            selected = [result.zones[i] for i in [0, 3, 7, 12]]
            fig = visualizer.plot_zones_comparison(selected, df)
            fig.show()
            
            # –ó–æ–Ω—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç
            fig = visualizer.plot_zones_comparison(
                result.zones, df,
                date_range=(datetime(2024, 1, 1), datetime(2024, 3, 1))
            )
            fig.show()
        """
        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–æ–Ω –ø–æ –¥–∞—Ç–µ
        if date_range:
            zones = self._filter_zones_by_date(zones, date_range)
        
        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–æ–Ω
        if len(zones) > max_zones:
            zones = zones[:max_zones]
            self.logger.warning(f"Showing only first {max_zones} zones")
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        if self.backend == 'plotly':
            return self._create_plotly_zones_comparison(
                zones, analysis_data, **kwargs
            )
        else:
            return self._create_matplotlib_zones_comparison(
                zones, analysis_data, **kwargs
            )
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZoneAnalysisResult

–î–æ–±–∞–≤–∏—Ç—å convenience –º–µ—Ç–æ–¥ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä—è–º–æ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:

```python
# bquant/analysis/zones/models.py

@dataclass
class ZoneAnalysisResult:
    zones: List[ZoneInfo]
    statistics: Dict[str, Any]
    hypothesis_tests: Dict[str, Any]
    clustering: Optional[Dict[str, Any]] = None
    sequence_analysis: Optional[Dict[str, Any]] = None
    regression_results: Optional[Dict[str, Any]] = None
    validation_results: Optional[Dict[str, Any]] = None
    data: Optional[pd.DataFrame] = None
    metadata: Dict[str, Any] = field(default_factory=dict)
    
    def visualize(self, 
                  mode: str = 'overview',
                  zone_id: Optional[int] = None,
                  date_range: Optional[Tuple] = None,
                  **kwargs):
        """
        –£–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞.
        
        Args:
            mode: –†–µ–∂–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
                - 'overview': –û–±—â–∏–π –≥—Ä–∞—Ñ–∏–∫ –≤—Å–µ—Ö –∑–æ–Ω –Ω–∞ —Ü–µ–Ω–µ
                - 'detail': –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ–¥–Ω–æ–π –∑–æ–Ω—ã
                - 'comparison': –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–æ–Ω
                - 'statistics': –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–æ–Ω
            zone_id: ID –∑–æ–Ω—ã –¥–ª—è mode='detail'
            date_range: –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –¥–ª—è mode='comparison'
            **kwargs: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è ZoneVisualizer
            
        Returns:
            Plotly/Matplotlib —Ñ–∏–≥—É—Ä–∞
            
        Examples:
            # –û–±—â–∏–π –æ–±–∑–æ—Ä
            fig = result.visualize('overview')
            fig.show()
            
            # –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–æ–Ω—ã #3
            fig = result.visualize('detail', zone_id=3, context_bars=20)
            fig.show()
            
            # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 5 –∑–æ–Ω
            fig = result.visualize('comparison', max_zones=5)
            fig.show()
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            fig = result.visualize('statistics')
            fig.show()
        """
        from bquant.visualization import ZoneVisualizer
        
        if self.data is None:
            raise ValueError("data not available in ZoneAnalysisResult")
        
        visualizer = ZoneVisualizer()
        
        if mode == 'overview':
            return visualizer.plot_zones_on_price_chart(
                self.data, self.zones, **kwargs
            )
        
        elif mode == 'detail':
            if zone_id is None:
                raise ValueError("zone_id required for detail mode")
            zone = next((z for z in self.zones if z.zone_id == zone_id), None)
            if not zone:
                raise ValueError(f"Zone {zone_id} not found")
            return visualizer.plot_zone_detail(zone, self.data, **kwargs)
        
        elif mode == 'comparison':
            return visualizer.plot_zones_comparison(
                self.zones, self.data, date_range=date_range, **kwargs
            )
        
        elif mode == 'statistics':
            return visualizer.plot_zones_analysis(
                self.zones, self.statistics, **kwargs
            )
        
        else:
            raise ValueError(
                f"Unknown mode: {mode}. "
                f"Available: 'overview', 'detail', 'comparison', 'statistics'"
            )
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

#### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –æ–±–∑–æ—Ä –≤—Å–µ—Ö –∑–æ–Ω

```python
from bquant.analysis.zones import analyze_zones

result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True)
    .build()
)

# –û–±—â–∏–π –≥—Ä–∞—Ñ–∏–∫ —Å –∑–æ–Ω–∞–º–∏
fig = result.visualize('overview')
fig.show()

# –ò–ª–∏ —á–µ—Ä–µ–∑ ZoneVisualizer
from bquant.visualization import ZoneVisualizer
visualizer = ZoneVisualizer()
fig = visualizer.plot_zones_on_price_chart(df, result.zones)
fig.show()
```

#### –ü—Ä–∏–º–µ—Ä 2: –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–æ–Ω—ã —Å zigzag

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ zone.features
fig = result.visualize('detail', zone_id=5, context_bars=15)
fig.show()

# –ò–ª–∏ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
visualizer = ZoneVisualizer()
fig = visualizer.plot_zone_detail(
    result.zones[5],
    df,
    show_indicators=['zigzag', 'pivot_points'],
    context_bars=20
)
fig.show()
```

#### –ü—Ä–∏–º–µ—Ä 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–æ–Ω

```python
from datetime import datetime

# –ü–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç
fig = result.visualize(
    'comparison',
    date_range=(datetime(2024, 1, 1), datetime(2024, 3, 1)),
    max_zones=5
)
fig.show()

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–æ–Ω—ã
selected_zones = [result.zones[i] for i in [0, 3, 7, 12]]
visualizer = ZoneVisualizer()
fig = visualizer.plot_zones_comparison(selected_zones, df)
fig.show()
```

#### –ü—Ä–∏–º–µ—Ä 4: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

```python
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–æ–Ω
fig = result.visualize('statistics')
fig.show()

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏
visualizer = ZoneVisualizer()
fig = visualizer.plot_zones_distribution(
    result.zones,
    feature='duration',
    title='Zone Duration Distribution'
)
fig.show()
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** - —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `ZoneVisualizer`  
‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –≤—Å–µ–≥–æ 2 –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–∞ (~150 —Å—Ç—Ä–æ–∫) + 1 –º–µ—Ç–æ–¥ –≤ models  
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ auto-detect  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - auto-detect –∏–ª–∏ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤  
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - fallback –Ω–∞ matplotlib –µ—Å–ª–∏ plotly –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω  
‚úÖ **–ù–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ  
‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ** - –º–µ—Ç–æ–¥ `visualize()` –ø—Ä—è–º–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∞–Ω–∞–ª–∏–∑–∞  

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```
bquant/visualization/
‚îî‚îÄ‚îÄ zones.py                  # + 2 –º–µ—Ç–æ–¥–∞ –≤ ZoneVisualizer (~150 —Å—Ç—Ä–æ–∫)
                             # + 3 helper –º–µ—Ç–æ–¥–∞ (~50 —Å—Ç—Ä–æ–∫)

bquant/analysis/zones/
‚îî‚îÄ‚îÄ models.py                # + –º–µ—Ç–æ–¥ visualize() –≤ ZoneAnalysisResult (~50 —Å—Ç—Ä–æ–∫)
```

**–ò—Ç–æ–≥–æ:** ~250 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, 0 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, 0 –∏–∑–º–µ–Ω–µ–Ω–∏–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

<a name="–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ"></a>
## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

### –¢–µ–∫—É—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ BQuant

–ü–∞–∫–µ—Ç —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–≤–∏—Ç—É—é —Å–∏—Å—Ç–µ–º—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `bquant.core.cache`:

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `MemoryCache` - –∫—ç—à –≤ –ø–∞–º—è—Ç–∏ —Å LRU —ç–≤–∏–∫—Ü–∏–µ–π –∏ TTL
- `DiskCache` - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫–µ (pickle, `~/.cache/bquant/`)
- `CacheManager` - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –æ–±–∞ –∫—ç—à–∞ (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫)
- –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@cached` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
- –ú–µ—Ç–æ–¥ `calculate_with_cache()` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è –∑–æ–Ω:**
- ‚ùå –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–æ–Ω
- ‚ùå –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
- ‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ `ZoneAnalysisResult`
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Pipeline —Å –∫—ç—à–µ–º

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Pipeline

#### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ZoneAnalysisPipeline

```python
# bquant/analysis/zones/pipeline.py (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

import hashlib
from bquant.core.cache import get_cache_manager

class ZoneAnalysisPipeline:
    """
    –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
    """
    
    def __init__(self, 
                 config: ZoneAnalysisConfig,
                 zone_analyzer: Optional[UniversalZoneAnalyzer] = None,
                 enable_cache: bool = True,
                 cache_ttl: int = 3600):
        """
        Args:
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pipeline
            zone_analyzer: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä (DI)
            enable_cache: –í–∫–ª—é—á–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            cache_ttl: –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (default: 1 —á–∞—Å)
        """
        self.config = config
        self.analyzer = zone_analyzer or UniversalZoneAnalyzer()
        self.enable_cache = enable_cache
        self.cache_ttl = cache_ttl
        self.cache_manager = get_cache_manager() if enable_cache else None
        self.logger = get_logger(__name__)
    
    def run(self, df: pd.DataFrame) -> ZoneAnalysisResult:
        """
        –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π pipeline –∞–Ω–∞–ª–∏–∑–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
        
        –ï—Å–ª–∏ enable_cache=True, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫—ç—à
        (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫) –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
        """
        if not self.enable_cache:
            return self._run_without_cache(df)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã—Ö
        cache_key = self._generate_cache_key(df)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
        cached_result = self.cache_manager.get(cache_key)
        if cached_result is not None:
            self.logger.info(f"Zone analysis result loaded from cache (key: {cache_key[:8]}...)")
            return cached_result
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∞–Ω–∞–ª–∏–∑
        self.logger.info("Cache miss, running zone analysis...")
        result = self._run_without_cache(df)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à (TTL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–∞ –¥–∏—Å–∫)
        self.cache_manager.put(cache_key, result, ttl=self.cache_ttl, disk=True)
        self.logger.info(f"Zone analysis result saved to cache (key: {cache_key[:8]}...)")
        
        return result
    
    def _run_without_cache(self, df: pd.DataFrame) -> ZoneAnalysisResult:
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å pipeline –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞)."""
        # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)
        df_prepared = self._prepare_data(df)
        
        # 2. –î–µ—Ç–µ–∫—Ü–∏—è –∑–æ–Ω
        zones = self._detect_zones(df_prepared)
        
        # 3. –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω
        return self._analyze_zones(zones, df_prepared)
    
    def _generate_cache_key(self, df: pd.DataFrame) -> str:
        """
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã—Ö.
        
        –ö–ª—é—á –≤–∫–ª—é—á–∞–µ—Ç:
        - –•—ç—à –¥–∞–Ω–Ω—ã—Ö (OHLCV)
        - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–æ–Ω
        - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∞–ª–∏–∑–∞
        """
        import json
        from dataclasses import asdict
        
        # –•—ç—à –¥–∞–Ω–Ω—ã—Ö
        data_hash = pd.util.hash_pandas_object(df[['open', 'high', 'low', 'close']]).sum()
        
        # –°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        config_dict = {
            'indicator': asdict(self.config.indicator) if self.config.indicator else None,
            'zone_detection': asdict(self.config.zone_detection),
            'perform_clustering': self.config.perform_clustering,
            'n_clusters': self.config.n_clusters,
            'run_regression': self.config.run_regression,
            'run_validation': self.config.run_validation
        }
        config_str = json.dumps(config_dict, sort_keys=True)
        config_hash = hashlib.md5(config_str.encode()).hexdigest()
        
        # –°–æ–±–∏—Ä–∞–µ–º –∫–ª—é—á
        key = f"zone_analysis_{data_hash}_{config_hash}"
        
        return key
    
    def invalidate_cache(self, df: pd.DataFrame) -> None:
        """–ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö."""
        if self.cache_manager:
            cache_key = self._generate_cache_key(df)
            self.cache_manager.invalidate(cache_key)
            self.logger.info(f"Cache invalidated for key: {cache_key[:8]}...")
```

#### 2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Builder

```python
class ZoneAnalysisBuilder:
    """Fluent builder —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è."""
    
    def __init__(self, data: pd.DataFrame):
        self.data = data
        # ... existing fields ...
        self._enable_cache = True
        self._cache_ttl = 3600
    
    def with_cache(self, 
                   enable: bool = True,
                   ttl: int = 3600) -> 'ZoneAnalysisBuilder':
        """
        –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ.
        
        Args:
            enable: –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫—ç—à
            ttl: –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            
        Returns:
            self –¥–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤
            
        Example:
            # –° –∫—ç—à–µ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
            result = analyze_zones(df).detect_zones(...).build()
            
            # –ë–µ–∑ –∫—ç—à–∞
            result = (
                analyze_zones(df)
                .with_cache(enable=False)
                .detect_zones(...)
                .build()
            )
            
            # –ö—ç—à —Å TTL 2 —á–∞—Å–∞
            result = (
                analyze_zones(df)
                .with_cache(ttl=7200)
                .detect_zones(...)
                .build()
            )
        """
        self._enable_cache = enable
        self._cache_ttl = ttl
        return self
    
    def build(self) -> ZoneAnalysisResult:
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å pipeline —Å —É—á–µ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫—ç—à–∞."""
        if self._zone_detection_config is None:
            raise ValueError("Zone detection strategy not configured")
        
        # –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        config = ZoneAnalysisConfig(
            indicator=self._indicator_config,
            zone_detection=self._zone_detection_config,
            perform_clustering=self._perform_clustering,
            n_clusters=self._n_clusters,
            run_regression=self._run_regression,
            run_validation=self._run_validation
        )
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º —á–µ—Ä–µ–∑ pipeline —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        pipeline = ZoneAnalysisPipeline(
            config,
            enable_cache=self._enable_cache,
            cache_ttl=self._cache_ttl
        )
        return pipeline.run(self.data)
```

### –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ZoneAnalysisResult

```python
# bquant/analysis/zones/models.py (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

from pathlib import Path
import pickle
import gzip
import json

@dataclass
class ZoneAnalysisResult:
    zones: List[ZoneInfo]
    statistics: Dict[str, Any]
    hypothesis_tests: Dict[str, Any]
    clustering: Optional[Dict[str, Any]] = None
    sequence_analysis: Optional[Dict[str, Any]] = None
    regression_results: Optional[Dict[str, Any]] = None
    validation_results: Optional[Dict[str, Any]] = None
    data: Optional[pd.DataFrame] = None
    metadata: Dict[str, Any] = field(default_factory=dict)
    
    def save(self, 
             filepath: Union[str, Path],
             format: str = 'pickle',
             compress: bool = False,
             include_data: bool = True) -> None:
        """
        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –¥–∏—Å–∫.
        
        Args:
            filepath: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
            format: –§–æ—Ä–º–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                - 'pickle': –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç Python (–±—ã—Å—Ç—Ä–æ, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
                - 'json': –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (—á–∏—Ç–∞–µ–º–æ, –±–µ–∑ DataFrame)
                - 'parquet': Columnar —Ñ–æ—Ä–º–∞—Ç (–∫–æ–º–ø–∞–∫—Ç–Ω–æ, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
            compress: –°–∂–∏–º–∞—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è pickle/parquet)
            include_data: –í–∫–ª—é—á–∞—Ç—å –ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π DataFrame
            
        Example:
            # –ü–æ–ª–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏
            result.save('results/macd_zones.pkl')
            
            # –°–∂–∞—Ç–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            result.save('results/macd_zones.pkl.gz', compress=True)
            
            # JSON –±–µ–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ª–µ–≥–∫–∏–π —Ñ–∞–π–ª)
            result.save('results/macd_zones.json', format='json', include_data=False)
            
            # Parquet (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
            result.save('results/macd_zones.parquet', format='parquet')
        """
        filepath = Path(filepath)
        filepath.parent.mkdir(parents=True, exist_ok=True)
        
        if format == 'pickle':
            self._save_pickle(filepath, compress, include_data)
        elif format == 'json':
            self._save_json(filepath, include_data)
        elif format == 'parquet':
            self._save_parquet(filepath, compress, include_data)
        else:
            raise ValueError(
                f"Unsupported format: {format}. "
                f"Supported: 'pickle', 'json', 'parquet'"
            )
    
    def _save_pickle(self, filepath: Path, compress: bool, include_data: bool) -> None:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ pickle."""
        # –í—Ä–µ–º–µ–Ω–Ω–æ —É–¥–∞–ª—è–µ–º data –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω
        data_backup = None
        if not include_data and self.data is not None:
            data_backup = self.data
            self.data = None
        
        try:
            if compress:
                with gzip.open(filepath.with_suffix('.pkl.gz'), 'wb') as f:
                    pickle.dump(self, f, protocol=pickle.HIGHEST_PROTOCOL)
            else:
                with open(filepath, 'wb') as f:
                    pickle.dump(self, f, protocol=pickle.HIGHEST_PROTOCOL)
        finally:
            # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º data
            if data_backup is not None:
                self.data = data_backup
    
    def _save_json(self, filepath: Path, include_data: bool) -> None:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON."""
        data_dict = self.to_dict(include_data=include_data)
        
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(data_dict, f, indent=2, default=str, ensure_ascii=False)
    
    def _save_parquet(self, filepath: Path, compress: bool, include_data: bool) -> None:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Parquet (–Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤)."""
        import pyarrow as pa
        import pyarrow.parquet as pq
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –Ω–∞–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
        output_dir = filepath.with_suffix('.parquet')
        output_dir.mkdir(exist_ok=True)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–æ–Ω—ã
        zones_data = [self._zone_to_dict(z) for z in self.zones]
        zones_df = pd.DataFrame(zones_data)
        zones_df.to_parquet(output_dir / 'zones.parquet', compression='gzip' if compress else None)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
        metadata = {
            'statistics': self.statistics,
            'hypothesis_tests': self.hypothesis_tests,
            'clustering': self.clustering,
            'sequence_analysis': self.sequence_analysis,
            'regression_results': self.regression_results,
            'validation_results': self.validation_results,
            'metadata': self.metadata
        }
        
        with open(output_dir / 'metadata.json', 'w') as f:
            json.dump(metadata, f, indent=2, default=str)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        if include_data and self.data is not None:
            self.data.to_parquet(output_dir / 'data.parquet', compression='gzip' if compress else None)
    
    @classmethod
    def load(cls, 
             filepath: Union[str, Path],
             format: str = 'pickle') -> 'ZoneAnalysisResult':
        """
        –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏–∑ —Ñ–∞–π–ª–∞.
        
        Args:
            filepath: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
            format: –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
            
        Returns:
            ZoneAnalysisResult
            
        Example:
            # –ó–∞–≥—Ä—É–∑–∫–∞ pickle
            result = ZoneAnalysisResult.load('results/macd_zones.pkl')
            
            # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∂–∞—Ç–æ–≥–æ pickle
            result = ZoneAnalysisResult.load('results/macd_zones.pkl.gz')
            
            # –ó–∞–≥—Ä—É–∑–∫–∞ JSON
            result = ZoneAnalysisResult.load('results/macd_zones.json', format='json')
            
            # –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
            fig = result.visualize('overview')
            print(f"Loaded {len(result.zones)} zones")
        """
        filepath = Path(filepath)
        
        if format == 'pickle':
            return cls._load_pickle(filepath)
        elif format == 'json':
            return cls._load_json(filepath)
        elif format == 'parquet':
            return cls._load_parquet(filepath)
        else:
            raise ValueError(f"Unsupported format: {format}")
    
    @classmethod
    def _load_pickle(cls, filepath: Path) -> 'ZoneAnalysisResult':
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ pickle."""
        # –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∂–∞—Ç–∏—è
        if filepath.suffix == '.gz' or filepath.name.endswith('.pkl.gz'):
            with gzip.open(filepath, 'rb') as f:
                return pickle.load(f)
        else:
            with open(filepath, 'rb') as f:
                return pickle.load(f)
    
    @classmethod
    def _load_json(cls, filepath: Path) -> 'ZoneAnalysisResult':
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ JSON."""
        with open(filepath, 'r', encoding='utf-8') as f:
            data_dict = json.load(f)
        
        return cls.from_dict(data_dict)
    
    @classmethod
    def _load_parquet(cls, filepath: Path) -> 'ZoneAnalysisResult':
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Parquet."""
        parquet_dir = filepath.with_suffix('.parquet')
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–æ–Ω—ã
        zones_df = pd.read_parquet(parquet_dir / 'zones.parquet')
        zones = [cls._zone_from_dict(row) for _, row in zones_df.iterrows()]
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
        with open(parquet_dir / 'metadata.json', 'r') as f:
            metadata = json.load(f)
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –µ—Å—Ç—å
        data_file = parquet_dir / 'data.parquet'
        data = pd.read_parquet(data_file) if data_file.exists() else None
        
        return cls(
            zones=zones,
            statistics=metadata['statistics'],
            hypothesis_tests=metadata['hypothesis_tests'],
            clustering=metadata.get('clustering'),
            sequence_analysis=metadata.get('sequence_analysis'),
            regression_results=metadata.get('regression_results'),
            validation_results=metadata.get('validation_results'),
            data=data,
            metadata=metadata.get('metadata', {})
        )
    
    def to_dict(self, include_data: bool = False) -> Dict[str, Any]:
        """
        –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–æ–≤–∞—Ä—å (–¥–ª—è JSON).
        
        Args:
            include_data: –í–∫–ª—é—á–∞—Ç—å –ª–∏ DataFrame (warning: –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º)
        """
        result = {
            'zones': [self._zone_to_dict(z) for z in self.zones],
            'statistics': self.statistics,
            'hypothesis_tests': self.hypothesis_tests,
            'clustering': self.clustering,
            'sequence_analysis': self.sequence_analysis,
            'regression_results': self.regression_results,
            'validation_results': self.validation_results,
            'metadata': self.metadata
        }
        
        if include_data and self.data is not None:
            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º DataFrame –≤ dict (–±—É–¥–µ—Ç –±–æ–ª—å—à–æ–π!)
            result['data'] = self.data.to_dict('records')
        
        return result
    
    @classmethod
    def from_dict(cls, data_dict: Dict[str, Any]) -> 'ZoneAnalysisResult':
        """–°–æ–∑–¥–∞–Ω–∏–µ –∏–∑ —Å–ª–æ–≤–∞—Ä—è."""
        zones = [cls._zone_from_dict(z) for z in data_dict['zones']]
        
        # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º DataFrame –µ—Å–ª–∏ –µ—Å—Ç—å
        data = None
        if 'data' in data_dict:
            data = pd.DataFrame(data_dict['data'])
        
        return cls(
            zones=zones,
            statistics=data_dict['statistics'],
            hypothesis_tests=data_dict['hypothesis_tests'],
            clustering=data_dict.get('clustering'),
            sequence_analysis=data_dict.get('sequence_analysis'),
            regression_results=data_dict.get('regression_results'),
            validation_results=data_dict.get('validation_results'),
            data=data,
            metadata=data_dict.get('metadata', {})
        )
    
    @staticmethod
    def _zone_to_dict(zone: ZoneInfo) -> Dict[str, Any]:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ZoneInfo –≤ —Å–ª–æ–≤–∞—Ä—å."""
        return {
            'zone_id': zone.zone_id,
            'type': zone.type,
            'start_idx': zone.start_idx,
            'end_idx': zone.end_idx,
            'start_time': zone.start_time.isoformat(),
            'end_time': zone.end_time.isoformat(),
            'duration': zone.duration,
            'features': zone.features
            # data –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ dict (—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π)
        }
    
    @staticmethod
    def _zone_from_dict(zone_dict: Dict[str, Any]) -> ZoneInfo:
        """–°–æ–∑–¥–∞–Ω–∏–µ ZoneInfo –∏–∑ —Å–ª–æ–≤–∞—Ä—è."""
        from datetime import datetime
        
        return ZoneInfo(
            zone_id=zone_dict['zone_id'],
            type=zone_dict['type'],
            start_idx=zone_dict['start_idx'],
            end_idx=zone_dict['end_idx'],
            start_time=datetime.fromisoformat(zone_dict['start_time']),
            end_time=datetime.fromisoformat(zone_dict['end_time']),
            duration=zone_dict['duration'],
            data=pd.DataFrame(),  # –ü—É—Å—Ç–æ–π DataFrame, –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
            features=zone_dict.get('features')
        )
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ü—Ä–∏–º–µ—Ä 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from bquant.analysis.zones import analyze_zones

# –° –∫—ç—à–µ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True)
    .build()
)
# Output: "Cache miss, running zone analysis..."
# Output: "Zone analysis result saved to cache..."

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ - –∏–∑ –∫—ç—à–∞
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True)
    .build()
)
# Output: "Zone analysis result loaded from cache..."
# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ!
```

#### –ü—Ä–∏–º–µ—Ä 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º

```python
# –û—Ç–∫–ª—é—á–∏—Ç—å –∫—ç—à –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
result = (
    analyze_zones(df)
    .with_cache(enable=False)  # –û—Ç–∫–ª—é—á–∞–µ–º –∫—ç—à
    .with_indicator('custom', 'macd')
    .detect_zones('zero_crossing', indicator_col='macd')
    .build()
)

# –ö—ç—à —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º TTL (6 —á–∞—Å–æ–≤)
result = (
    analyze_zones(df)
    .with_cache(ttl=21600)
    .with_indicator('custom', 'macd')
    .detect_zones('zero_crossing', indicator_col='macd')
    .build()
)

# –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
from bquant.core.cache import get_cache_manager

cache = get_cache_manager()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
stats = cache.stats()
print(f"Cache entries: {stats['memory']['entries']}")
print(f"Hit rate: {stats['memory']['hit_rate']:.1f}%")
print(f"Disk cache: {stats.get('disk', {}).get('entries', 0)} files")

# –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –∑–∞–ø–∏—Å–µ–π
cleaned = cache.cleanup()
print(f"Cleaned: {cleaned['memory_cleaned']} from memory, {cleaned['disk_cleaned']} from disk")

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
cache.clear()
```

#### –ü—Ä–∏–º–µ—Ä 3: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

```python
# –ê–Ω–∞–ª–∏–∑ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True, regression=True)
    .build()
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
result.save('results/macd_analysis.pkl')                    # Pickle (–±—ã—Å—Ç—Ä–æ)
result.save('results/macd_analysis.pkl.gz', compress=True)  # –°–∂–∞—Ç—ã–π pickle
result.save('results/macd_analysis.json', format='json')    # JSON (—á–∏—Ç–∞–µ–º–æ)
result.save('results/macd_analysis.parquet', format='parquet')  # Parquet (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)

# JSON –±–µ–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ª–µ–≥–∫–∏–π —Ñ–∞–π–ª –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
result.save('results/macd_summary.json', format='json', include_data=False)

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
loaded_result = ZoneAnalysisResult.load('results/macd_analysis.pkl')

print(f"Loaded analysis with {len(loaded_result.zones)} zones")
print(f"Analysis date: {loaded_result.metadata.get('analysis_timestamp')}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
fig = loaded_result.visualize('detail', zone_id=3)
fig.show()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
print(f"Bull zones: {loaded_result.statistics['bull_zones']}")
print(f"Avg duration: {loaded_result.statistics['avg_duration']:.1f}")
```

#### –ü—Ä–∏–º–µ—Ä 4: Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –∫—ç—à–µ–º

```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
instruments = ['EURUSD', 'GBPUSD', 'USDJPY']
results = {}

for instrument in instruments:
    df = load_data(instrument)  # –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
    result = (
        analyze_zones(df)
        .with_indicator('custom', 'macd')
        .detect_zones('zero_crossing', indicator_col='macd')
        .analyze(clustering=True)
        .build()
    )
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result.save(f'results/{instrument}_zones.pkl')
    results[instrument] = result

# –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ - –≤—Å–µ –∏–∑ –∫—ç—à–∞!
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É** - `bquant.core.cache` —É–∂–µ –µ—Å—Ç—å  
‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Pipeline  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∫—ç—à —á–µ—Ä–µ–∑ `.with_cache(enable=False)`  
‚úÖ **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - `save()`/`load()` –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è  
‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤** - pickle (–±—ã—Å—Ç—Ä–æ), JSON (—á–∏—Ç–∞–µ–º–æ), parquet (–∫–æ–º–ø–∞–∫—Ç–Ω–æ)  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –æ—á–∏—Å—Ç–∫–∞, –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è, TTL  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π (–∏–∑ –∫—ç—à–∞)  
‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** - ~300 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º API  

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```
bquant/analysis/zones/
‚îú‚îÄ‚îÄ pipeline.py            # + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Pipeline (~100 —Å—Ç—Ä–æ–∫)
‚îÇ                         # + –º–µ—Ç–æ–¥ _generate_cache_key()
‚îÇ                         # + –ø–∞—Ä–∞–º–µ—Ç—Ä—ã enable_cache, cache_ttl
‚îÇ
‚îî‚îÄ‚îÄ models.py             # + –º–µ—Ç–æ–¥—ã save/load –≤ ZoneAnalysisResult (~200 —Å—Ç—Ä–æ–∫)
                          # + –º–µ—Ç–æ–¥—ã to_dict/from_dict
                          # + –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: pickle, json, parquet

bquant/core/
‚îî‚îÄ‚îÄ cache.py              # –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (–∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å)
```

**–ò—Ç–æ–≥–æ:** ~300 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, 0 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫—ç—à–µ–º

---

<a name="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞"></a>
## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –ü—Ä–æ—Å—Ç–æ—Ç–∞

| –ë—ã–ª–æ (—Å —Ñ–∞—Å–∞–¥–∞–º–∏) | –°—Ç–∞–ª–æ (Pipeline + Builder) |
|-------------------|----------------------------|
| 3 —Å–ª–æ—è | 2 —Å–ª–æ—è |
| N —Ñ–∞—Å–∞–¥–æ–≤ –¥–ª—è N –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ | 1 Pipeline –¥–ª—è –≤—Å–µ—Ö |
| Hardcode –≤ —Ñ–∞—Å–∞–¥–∞—Ö | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| ~500 —Å—Ç—Ä–æ–∫ –Ω–∞ —Ñ–∞—Å–∞–¥—ã | ~250 —Å—Ç—Ä–æ–∫ Pipeline + Builder |

### 2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ API –¥–ª—è –í–°–ï–• –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ù–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è MACD, AO, RSI, ...
- ‚úÖ –ù–æ–≤—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä = 0 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (—Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è!)

### 3. –ì–∏–±–∫–æ—Å—Ç—å

**Fluent Builder:**
```python
analyze_zones(df)
    .with_indicator(...)  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    .detect_zones(...)     # –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    .analyze(...)          # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    .build()
```

**Pipeline + Config:**
- –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ JSON/YAML
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

**–ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
- –í—Å—Ç–∞–≤–∫–∞ —Å–≤–æ–µ–π –ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndicatorFactory

```python
# –í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
.with_indicator('preloaded', 'macd')        # –∏–∑–≤–ª–µ—á—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö
.with_indicator('custom', 'macd', fast=12)   # –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
.with_indicator('pandas_ta', 'ao')          # pandas_ta
.with_indicator('talib', 'rsi', timeperiod=14)  # TA-Lib
```

---

<a name="–ø–ª–∞–Ω-–º–∏–≥—Ä–∞—Ü–∏–∏"></a>
## –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

**üìö –í–∞–∂–Ω–æ:** –í—Å–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –∫–æ–¥–∞ –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ (zonan.md). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–∞–∑–¥–µ–ª—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π. –î–ª—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–º. [zomodul.md](zomodul.md).

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:** –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –∏–º–µ–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –≥–æ—Ç–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏–ª–∏ –∑–∞–≥–æ—Ç–æ–≤–∫–æ–π –∫–æ–¥–∞. –°–ª–µ–¥—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—É, –Ω–µ –∏–∑–æ–±—Ä–µ—Ç–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ!

---

### –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (1-2 –¥–Ω—è) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

**üìñ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª—ã [–ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–æ–≤—ã–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã) –∏ [–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

1. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/models.py` (~430 —Å—Ç—Ä–æ–∫) ‚úÖ
   - [x] –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å ZoneInfo, ZoneAnalysisResult –∏–∑ `bquant/indicators/macd.py`
   - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `ZoneInfo.to_analyzer_format()` ‚Üí –°–º. [–ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–æ–≤—ã–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
   - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Üí –°–º. [–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
     - `ZoneAnalysisResult.save()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫ (pickle, JSON, parquet)
     - `ZoneAnalysisResult.load()` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
     - `to_dict()` / `from_dict()` - JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
     - `_save_pickle()`, `_save_json()`, `_save_parquet()` - —Ñ–æ—Ä–º–∞—Ç—ã
     - `_zone_to_dict()`, `_zone_from_dict()` - helper –º–µ—Ç–æ–¥—ã
   - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `ZoneAnalysisResult.visualize()` ‚Üí –°–º. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZoneAnalysisResult](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)

2. [x] –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö ‚úÖ
   - `bquant/indicators/macd.py` - –∏–º–ø–æ—Ä—Ç –∏–∑ models
   - Backward compatibility —á–µ—Ä–µ–∑ —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç
   - –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã (514 passed, 1 failed, 1 skipped) ‚úÖ
   - [x] `pytest tests/` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
   - [x] 514 passed - –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - [x] 1 failed - –Ω–µ —Å–≤—è–∑–∞–Ω —Å –Ω–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (scripts output formats)
   - [x] –í—Å–µ —Ç–µ—Å—Ç—ã MACD analyzer –ø—Ä–æ—Ö–æ–¥—è—Ç (16/16)
   - [x] –í—Å–µ —Ç–µ—Å—Ç—ã zone features –ø—Ä–æ—Ö–æ–¥—è—Ç
   - [x] –ú–æ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è: "Zone models (ZoneInfo, ZoneAnalysisResult) loaded successfully"

4. [x] –û–±–Ω–æ–≤–∏—Ç—å `bquant/analysis/zones/__init__.py` ‚úÖ
   - [x] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å ZoneInfo, ZoneAnalysisResult
   - [x] –î–æ–±–∞–≤–ª–µ–Ω conditional import —Å try/except

5. [x] Unit-—Ç–µ—Å—Ç—ã –¥–ª—è models.py (15 —Ç–µ—Å—Ç–æ–≤) ‚úÖ
   - [x] –¢–µ—Å—Ç—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (save/load) –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
   - [x] –¢–µ—Å—Ç—ã to_dict/from_dict
   - [x] –¢–µ—Å—Ç—ã —Å/–±–µ–∑ include_data
   - [x] –¢–µ—Å—Ç—ã —Å–∂–∞—Ç–∏—è (pickle.gz)
   - [x] –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
   - [x] 14 passed, 1 skipped (parquet —Ç—Ä–µ–±—É–µ—Ç pyarrow - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ, –ø–æ–ª–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Å—Ç–∞—Ä—ã–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, backward compatibility —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (4-6 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

**üìñ –û–±–∑–æ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:** –°–º. —Ä–∞–∑–¥–µ–ª [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞) - –ø–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

#### 1.1 –°–ª–æ–π 1: Zone Detection Strategies (2-3 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**üìñ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª—ã [–°–ª–æ–π 1: Zone Detection Strategies](#—Å–ª–æ–π-1) –∏ [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (Code Templates)](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)

1. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/detection/__init__.py`
   - –≠–∫—Å–ø–æ—Ä—Ç—ã: ZoneDetectionStrategy, ZoneDetectionConfig, ZoneDetectionRegistry
   - ‚úÖ –°–æ–∑–¥–∞–Ω, –≤—Å–µ —ç–∫—Å–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

2. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/detection/base.py` (~100 —Å—Ç—Ä–æ–∫)
   - –ü—Ä–æ—Ç–æ–∫–æ–ª `ZoneDetectionStrategy` ‚Üí –°–º. [base.py - –ü—Ä–æ—Ç–æ–∫–æ–ª –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
   - Dataclass `ZoneDetectionConfig` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π ‚Üí –°–º. [base.py - –ü—Ä–æ—Ç–æ–∫–æ–ª –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ç–æ—á–Ω–æ –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, 76 —Å—Ç—Ä–æ–∫

3. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/detection/registry.py` (~100 —Å—Ç—Ä–æ–∫)
   - –ö–ª–∞—Å—Å `ZoneDetectionRegistry` —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º ‚Üí –°–º. [registry.py - –†–µ–µ—Å—Ç—Ä —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
   - –ú–µ—Ç–æ–¥—ã: register, get, list_strategies, get_info ‚Üí –°–º. [registry.py - –†–µ–µ—Å—Ç—Ä —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, 83 —Å—Ç—Ä–æ–∫–∏, 5 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ

4. [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ ‚Üí –°–º. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π):
   - [x] `zero_crossing.py` (~150 —Å—Ç—Ä–æ–∫) ‚Üí –°–º. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: ZeroCrossingDetection](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π) ‚úÖ 156 —Å—Ç—Ä–æ–∫
   - [x] `line_crossing.py` (~120 —Å—Ç—Ä–æ–∫) ‚Üí –°–º. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: LineCrossingDetection](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π) ‚úÖ 116 —Å—Ç—Ä–æ–∫
   - [x] `threshold.py` (~130 —Å—Ç—Ä–æ–∫) ‚Üí –°–º. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: ThresholdDetection](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π) ‚úÖ 142 —Å—Ç—Ä–æ–∫–∏
   - [x] `preloaded.py` (~200 —Å—Ç—Ä–æ–∫) ‚Üí –°–º. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: PreloadedZonesDetection](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π) ‚úÖ 185 —Å—Ç—Ä–æ–∫
   - [x] `combined.py` (~150 —Å—Ç—Ä–æ–∫, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Üí –°–º. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è 5: CombinedRulesDetection](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π) ‚úÖ 156 —Å—Ç—Ä–æ–∫

5. [x] Unit-—Ç–µ—Å—Ç—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (~50 —Ç–µ—Å—Ç–æ–≤)
   - –ü–æ 10 —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
   - –¢–µ—Å—Ç—ã: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 28 —Ç–µ—Å—Ç–æ–≤ (ZoneDetectionConfig + Registry + –≤—Å–µ 5 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π), –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

#### 1.2 –°–ª–æ–π 2: Universal Analyzer (1 –¥–µ–Ω—å) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**üìñ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª [–°–ª–æ–π 2: Universal Zone Analyzer](#—Å–ª–æ–π-2)

1. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/analyzer.py` (~200 —Å—Ç—Ä–æ–∫)
   - –ö–ª–∞—Å—Å `UniversalZoneAnalyzer` —Å DI ‚Üí –°–º. [–°–ª–æ–π 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Å–ª–æ–π-2)
   - –ú–µ—Ç–æ–¥ `analyze_zones(zones: List[ZoneInfo], ...)` ‚Üí –°–º. [–°–ª–æ–π 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Å–ª–æ–π-2)
   - –ß–∏—Å—Ç–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –±–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
   - –û —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ DI ‚Üí –°–º. [–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: –°–ª–æ–π 2](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 216 —Å—Ç—Ä–æ–∫, —á–∏—Å—Ç–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å DI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - ‚úÖ –ò–∑—è—â–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–æ–Ω (< 3 –¥–ª—è sequence_analysis)

2. [x] –û–±–Ω–æ–≤–∏—Ç—å `bquant/analysis/zones/zone_features.py`
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `extract_all_zones_features(zones: List[ZoneInfo])`
   - –ú–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç List[ZoneInfo] –≤–º–µ—Å—Ç–æ List[Dict]
   - ‚úÖ –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω, –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç ZoneInfo –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É

3. [x] Unit-—Ç–µ—Å—Ç—ã UniversalZoneAnalyzer (~15 —Ç–µ—Å—Ç–æ–≤)
   - –¢–µ—Å—Ç—ã –Ω–∞ DI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –¢–µ—Å—Ç—ã –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏
   - –¢–µ—Å—Ç—ã –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 8 —Ç–µ—Å—Ç–æ–≤ (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, DI, basic analysis, clustering, regression, empty zones, few zones, metadata), –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

#### 1.3 Pipeline + Builder (1-2 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**üìñ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª—ã [Pipeline: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞](#pipeline), [Builder: Fluent API](#builder), [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Pipeline](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

1. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/pipeline.py` (~500 —Å—Ç—Ä–æ–∫)
   - [x] Dataclass `IndicatorConfig` ‚Üí –°–º. [Pipeline: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#pipeline) ‚úÖ
   - [x] Dataclass `ZoneAnalysisConfig` ‚Üí –°–º. [Pipeline: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#pipeline) ‚úÖ
   - [x] –ö–ª–∞—Å—Å `ZoneAnalysisPipeline` ‚Üí –°–º. [Pipeline: Pipeline –∫–ª–∞—Å—Å](#pipeline):
     - –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ pipeline ‚úÖ
     - **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** (enable_cache, cache_ttl) ‚Üí –°–º. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ZoneAnalysisPipeline](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ
     - –ú–µ—Ç–æ–¥ `_generate_cache_key()` ‚Üí –°–º. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ZoneAnalysisPipeline](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ
     - –ú–µ—Ç–æ–¥ `_run_without_cache()` ‚Üí –°–º. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ZoneAnalysisPipeline](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ
     - –ú–µ—Ç–æ–¥ `invalidate_cache()` ‚Üí –°–º. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ZoneAnalysisPipeline](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ
   - [x] –ö–ª–∞—Å—Å `ZoneAnalysisBuilder` (fluent API) ‚Üí –°–º. [Builder: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#builder):
     - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã (with_indicator, detect_zones, analyze) ‚úÖ
     - **–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `with_cache(enable, ttl)`** ‚Üí –°–º. [–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Builder](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ
   - [x] Helper —Ñ—É–Ω–∫—Ü–∏—è `analyze_zones(df)` ‚Üí –°–º. [Builder: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#builder) ‚úÖ
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 463 —Å—Ç—Ä–æ–∫–∏, –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndicatorFactory –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

2. [x] –û–±–Ω–æ–≤–∏—Ç—å `bquant/analysis/zones/__init__.py`
   - [x] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
   - [x] –î–æ–±–∞–≤–∏—Ç—å __all__ —Å–ø–∏—Å–æ–∫
   - ‚úÖ –í—Å–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã, —É—Å–ª–æ–≤–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

3. [x] Unit-—Ç–µ—Å—Ç—ã Pipeline + Builder (~25 —Ç–µ—Å—Ç–æ–≤)
   - [x] –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π ‚úÖ
   - [x] –¢–µ—Å—Ç—ã Pipeline –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚úÖ
   - [x] –¢–µ—Å—Ç—ã Builder —Ü–µ–ø–æ—á–µ–∫ ‚úÖ
   - [x] –¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å IndicatorFactory ‚Üí –°–º. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IndicatorFactory](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è) ‚úÖ
   - [x] **–¢–µ—Å—Ç—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è](#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ):
     - Cache hit/miss ‚úÖ
     - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ ‚úÖ (—á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã)
     - TTL expiration ‚úÖ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é)
     - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∞ ‚úÖ
     - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞ ‚úÖ
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 14 —Ç–µ—Å—Ç–æ–≤ (configs + pipeline + builder + —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏), –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π IndicatorFactory, —Å—Ç–∞—Ä–∞—è –Ω–µ —Å–ª–æ–º–∞–Ω–∞, 50 —Ç–µ—Å—Ç–æ–≤ Stage 1 –ø—Ä–æ—Ö–æ–¥—è—Ç**

---

**üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≠—Ç–∞–ø–∞ 1:**
- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 11 (5 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π + base + registry + analyzer + pipeline + 2 —Ç–µ—Å—Ç–∞)
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~1700 —Å—Ç—Ä–æ–∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–∞ + ~800 —Å—Ç—Ä–æ–∫ —Ç–µ—Å—Ç–æ–≤
- **–¢–µ—Å—Ç–æ–≤:** 50 —Ç–µ—Å—Ç–æ–≤ (28 detection + 8 analyzer + 14 pipeline/builder)
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **–í—Ä–µ–º—è:** ~2-3 –¥–Ω—è (–ø–æ –ø–ª–∞–Ω—É 4-6)
- **–ö–∞—á–µ—Å—Ç–≤–æ:** –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –≠—Ç–∞–ø 2: –ú–∏–≥—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (2-3 –¥–Ω—è)

**–¶–µ–ª—å:** –û–±–µ—Å–ø–µ—á–∏—Ç—å backward compatibility –∏ —Å–æ–∑–¥–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**üìñ –°–ø—Ä–∞–≤–∫–∞:** –°–º. —Ä–∞–∑–¥–µ–ª—ã [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã) –∏ [–ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](zomodul.md)

**üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

> **–í–∞–∂–Ω–æ:** –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã/–º–æ–¥—É–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ (RSIZoneAnalyzer, AOZoneAnalyzer –∏ —Ç.–¥.)
> 
> **–ü—Ä–∏—á–∏–Ω–∞:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Stage 1 —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π API. –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ–¥–∞.
>
> **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `analyze_zones()` + fluent API –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - —Ç–æ–Ω–∫–∏–µ convenience wrappers (5-10 —Å—Ç—Ä–æ–∫) –≤ `presets.py`.

#### 2.1 Slim down MACDZoneAnalyzer (0.5 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**–¶–µ–ª—å:** –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç –≤ —Ç–æ–Ω–∫–∏–π backward compatibility wrapper

1. [x] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `bquant/indicators/macd.py` (517 —Å—Ç—Ä–æ–∫ ‚Üí 254 —Å—Ç—Ä–æ–∫–∏)
   - [x] **–£–¥–∞–ª–µ–Ω–æ** –≤–µ—Å—å –∫–æ–¥ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–æ–Ω, –∞–Ω–∞–ª–∏–∑–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (~450 —Å—Ç—Ä–æ–∫)
   - [x] **–û—Å—Ç–∞–≤–ª–µ–Ω** —Ç–æ–ª—å–∫–æ wrapper –∫–ª–∞—Å—Å `MACDZoneAnalyzer` (~100 —Å—Ç—Ä–æ–∫ —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞)
   - [x] –ö–ª–∞—Å—Å –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É –≤ `analyze_zones()` pipeline ‚úÖ
   - [x] –î–æ–±–∞–≤–ª–µ–Ω `@deprecated` decorator —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º ‚úÖ
   - [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å—Ç–∞—Ä–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ ‚úÖ
   - [x] **–£–ª—É—á—à–µ–Ω–∏–µ:** –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (fast/slow/signal ‚Üí fast_period/slow_period/signal_period)
   - [x] **–£–ª—É—á—à–µ–Ω–∏–µ:** lazy import `analyze_zones` –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–æ–≤ (–∏–∑–±–µ–≥–∞–µ–º circular dependency)
   
   **–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
   ```python
   from bquant.analysis.zones import analyze_zones
   from bquant.core.utils import deprecated
   
   @deprecated(
       message="MACDZoneAnalyzer is deprecated. Use universal API instead: "
               "from bquant.analysis.zones import analyze_zones",
       version="2.0.0",
       removal_version="3.0.0"
   )
   class MACDZoneAnalyzer:
       """Deprecated wrapper for backward compatibility."""
       
       def __init__(self, macd_params=None, zone_params=None):
           self.macd_params = macd_params or {'fast_period': 12, 'slow_period': 26, 'signal_period': 9}
           self.zone_params = zone_params or {'min_duration': 2}
       
       def analyze_complete_modular(self, df, **kwargs):
           """Delegate to universal pipeline."""
           return (
               analyze_zones(df)
               .with_indicator('custom', 'macd', **self.macd_params)
               .detect_zones('zero_crossing', 
                            indicator_col='macd_hist',
                            min_duration=self.zone_params.get('min_duration', 2))
               .analyze(**kwargs)
               .build()
           )
   ```

2. [x] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã MACDZoneAnalyzer
   - [x] –°–æ–∑–¥–∞–Ω `tests/unit/test_macd_backward_compatibility.py` (255 —Å—Ç—Ä–æ–∫, 11 —Ç–µ—Å—Ç–æ–≤) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ deprecation warnings (3 —Ç–µ—Å—Ç–∞) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ delegation –≤ –Ω–æ–≤—ã–π API (3 —Ç–µ—Å—Ç–∞) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (—Å—Ç–∞—Ä—ã–π/–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç) (2 —Ç–µ—Å—Ç–∞) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (2 —Ç–µ—Å—Ç–∞) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ clustering –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (1 —Ç–µ—Å—Ç) ‚úÖ
   - ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 11/11 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç, –≤—Å–µ deprecation warnings —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### 2.2 Convenience wrappers (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 0.5 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —É–¥–æ–±–Ω—ã–µ shortcuts –¥–ª—è —á–∞—Å—Ç—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

1. [x] –°–æ–∑–¥–∞—Ç—å `bquant/analysis/zones/presets.py` (315 —Å—Ç—Ä–æ–∫)
   - [x] `analyze_macd_zones(df, **params)` - wrapper –¥–ª—è MACD ‚úÖ
   - [x] `analyze_rsi_zones(df, **params)` - wrapper –¥–ª—è RSI ‚úÖ
   - [x] `analyze_ao_zones(df, **params)` - wrapper –¥–ª—è AO ‚úÖ
   - [x] `analyze_preloaded_zones(df, zones_data, **params)` - –¥–ª—è preloaded zones ‚úÖ
   - [x] **–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏:** –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (clustering, regression, validation, caching)
   - [x] **–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏:** comprehensive docstrings —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   
   **–ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è - 5-10 —Å—Ç—Ä–æ–∫:**
   ```python
   def analyze_macd_zones(df: pd.DataFrame,
                          fast: int = 12,
                          slow: int = 26,
                          signal: int = 9,
                          min_duration: int = 2,
                          **analysis_params) -> ZoneAnalysisResult:
       """Convenience wrapper –¥–ª—è MACD –∑–æ–Ω."""
       return (
           analyze_zones(df)
           .with_indicator('custom', 'macd', fast_period=fast, slow_period=slow, signal_period=signal)
           .detect_zones('zero_crossing', indicator_col='macd_hist', min_duration=min_duration)
           .analyze(**analysis_params)
           .build()
       )
   ```

2. [x] –û–±–Ω–æ–≤–∏—Ç—å `bquant/analysis/zones/__init__.py`
   - [x] –î–æ–±–∞–≤–ª–µ–Ω —É—Å–ª–æ–≤–Ω—ã–π –∏–º–ø–æ—Ä—Ç presets —Ñ—É–Ω–∫—Ü–∏–π ‚úÖ
   - [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ __all__ —Å–ø–∏—Å–æ–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ ‚úÖ
   - [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ presets ‚úÖ

3. [x] Unit-—Ç–µ—Å—Ç—ã –¥–ª—è presets (13 —Ç–µ—Å—Ç–æ–≤)
   - [x] –°–æ–∑–¥–∞–Ω `tests/unit/test_zone_presets.py` (343 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
   - [x] TestMACDPreset: 3 —Ç–µ—Å—Ç–∞ (default params, custom params, equals direct builder) ‚úÖ
   - [x] TestRSIPreset: 2 —Ç–µ—Å—Ç–∞ (default params, custom thresholds) ‚úÖ
   - [x] TestAOPreset: 2 —Ç–µ—Å—Ç–∞ (default params, custom periods) ‚úÖ
   - [x] TestPreloadedZonesPreset: 2 —Ç–µ—Å—Ç–∞ (from DataFrame, from CSV) ‚úÖ
   - [x] TestPresetsIntegration: 4 —Ç–µ—Å—Ç–∞ (all presets return result, caching, regression, zone_types) ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 13/13 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç, –≤—Å–µ preset —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### 2.3 –ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã (examples/) - 1 –¥–µ–Ω—å ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ—Å—Ç—ã–µ, —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ quick start

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–µ (100-300 —Å—Ç—Ä–æ–∫ –º–∞–∫—Å–∏–º—É–º)
- ‚úÖ –°–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ (–º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (–ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ use cases)
- ‚úÖ –•–æ—Ä–æ—à–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
- ‚úÖ –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚ùå –ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏

1. [x] –û–±–Ω–æ–≤–∏—Ç—å `examples/02_macd_zone_analysis.py` (241 —Å—Ç—Ä–æ–∫–∞)
   - [x] **–†–∞–∑–¥–µ–ª 1:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è deprecated –ø–æ–¥—Ö–æ–¥–∞ (—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 2:** –ù–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (fluent API + preset) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 3:** –†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–ª—è MACD (zero_crossing, line_crossing, combined) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 4:** –ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–µ—Ç–µ–∫—Ü–∏—è, —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 5:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (pickle, JSON) ‚úÖ
   - [x] **–ò—Ç–æ–≥–∏:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ vs –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ API ‚úÖ

2. [x] –°–æ–∑–¥–∞—Ç—å `examples/02a_universal_zones.py` (297 —Å—Ç—Ä–æ–∫) - **–ù–û–í–´–ô** ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 1:** MACD zones (zero_crossing strategy) - builder + preset ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 2:** RSI zones (threshold strategy) - builder + preset ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 3:** AO zones (zero_crossing strategy) - builder + preset ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 4:** MA crossover zones (line_crossing strategy) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 5:** Preloaded zones (external data from CSV/DataFrame) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 6:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (3 —Ñ–æ—Ä–º–∞—Ç–∞) ‚úÖ
   - [x] **–†–∞–∑–¥–µ–ª 7:** –ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–¥–µ—Ç–µ–∫—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ, –∞–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ) ‚úÖ
   - [x] **–ò—Ç–æ–≥–∏:** –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è ZERO –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ ‚úÖ

3. [x] –û–±–Ω–æ–≤–∏—Ç—å `examples/04_comprehensive_analysis.py` (237 —Å—Ç—Ä–æ–∫) ‚úÖ
   - [x] –ü–æ–ª–Ω—ã–π pipeline: data ‚Üí indicator ‚Üí detection ‚Üí analysis ‚Üí save ‚úÖ
   - [x] –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (statistics, sequences, clustering) ‚úÖ
   - [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ 3 —Ñ–æ—Ä–º–∞—Ç–∞—Ö (pickle, JSON, parquet) ‚úÖ
   - [x] –ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (IndicatorFactory, ZoneDetectionRegistry, UniversalZoneAnalyzer) ‚úÖ
   - [x] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (MACD, RSI, AO) ‚úÖ
   - [x] –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ ‚úÖ

4. [x] –°–æ–∑–¥–∞—Ç—å `examples/README.md` (181 —Å—Ç—Ä–æ–∫–∞) ‚úÖ
   - [x] –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö example —Ñ–∞–π–ª–æ–≤ —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º ‚úÖ
   - [x] –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø—É—Ç—å –æ–±—É—á–µ–Ω–∏—è (–Ω–∞—á–∏–Ω–∞—é—â–∏–µ ‚Üí —Å—Ä–µ–¥–Ω–∏–π ‚Üí –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ) ‚úÖ
   - [x] –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 —à–∞–≥–∞) ‚úÖ
   - [x] –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ (—Å—Ç–∞—Ä—ã–π vs –Ω–æ–≤—ã–π API, convenience presets) ‚úÖ
   - [x] –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Å–æ–≤–µ—Ç—ã ‚úÖ
   - [x] –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã ‚úÖ

#### 2.4 –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–æ—É—Ç–±—É–∫–∏ (research/notebooks/) - 1 –¥–µ–Ω—å ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û (2025-10-22)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å NotebookSimulator –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ (500+ —Å—Ç—Ä–æ–∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
- ‚úÖ –° —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç NotebookSimulator (–∑–∞–º–µ–Ω–∞ Jupyter)
- ‚úÖ –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ –ú–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –±–µ–Ω—á–º–∞—Ä–∫–∏, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, edge cases
- ‚ùå –ù–ï –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ (2025-10-22 - –û–ë–ù–û–í–õ–ï–ù–û):**

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** 20/20 —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å `--no-trap` - –ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –†–∞–±–æ—Ç–∞—é—Ç | –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç | –ù–µ–ø–æ–ª–Ω—ã–µ | –ò—Ç–æ–≥–æ |
|-----------|----------|-------------|----------|-------|
| Data Processing | 6/6 (100%) ‚úÖ | 0/6 | 0/6 | 6 |
| Indicators | 7/7 (100%) ‚úÖ | 0/7 | 0/7 | 7 |
| Analysis | 6/6 (100%) ‚úÖ | 0/6 | 0/6 | 6 |
| Utilities | 1/1 (100%) ‚úÖ | 0/1 | 0/1 | 1 |
| **–ò–¢–û–ì–û** | **20/20 (100%) üéâ** | **0/20 (0%)** | **0/20 (0%)** | **20** |

**–î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:**

| # | –°–∫—Ä–∏–ø—Ç | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º–∞ |
|---|--------|-----------|--------|----------|
| 1 | `00_logging_demo.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0 |
| 2 | `01_data.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã |
| 3 | `01_data_loader.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –≤—Å–µ —Ç–µ—Å—Ç—ã OK |
| 4 | `01_data_processor.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 5 | `01_data_schemas.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 6 | `01_data_validator.py` | Data | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 7 | `02_ind_base.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 8 | `02_ind_calculators.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 9 | `02_ind_factory.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 10 | `02_ind_lib.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, talib unavailable (OK) |
| 11 | `02_ind_library.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 12 | `02_ind_macd.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –æ—Ç—Å—Ç—É–ø—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| 13 | `02_ind_types.py` | Indicators | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã |
| 14 | `03_analysis_base.py` | Analysis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –Ω–µ—Ç —ç–º–æ–¥–∑–∏ |
| 15 | `03_analysis_new_features.py` | Analysis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, v2.1 migrated (–≠–¢–ê–ü 2) |
| 16 | `03_analysis_statistical.py` | Analysis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –Ω–µ—Ç —ç–º–æ–¥–∑–∏ |
| 17 | `03_analysis_zones.py` | Analysis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –Ω–µ—Ç —ç–º–æ–¥–∑–∏ |
| 18 | `03_zones.py` | Analysis | ‚úÖ –£–¥–∞–ª–µ–Ω (2025-10-22) | –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ 03_zones_universal.py |
| 18a | `03_zones_universal.py` | Analysis | ‚úÖ –°–æ–∑–¥–∞–Ω (2025-10-22) | Exit code 0, 11 steps, v2.1 (–≠–¢–ê–ü 1) |
| 19 | `bq.py` | Utilities | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (2025-10-22) | Exit code 0, –Ω–µ—Ç —ç–º–æ–¥–∑–∏ |

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- **Indicators:** 1/7 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (MACD - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π API) ‚Üí ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22)
- **Analysis:** 3/5 –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö (2 –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, 1 –Ω–µ–ø–æ–ª–Ω—ã–π) ‚Üí ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22)
- **Data Processing:** 2/6 —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –æ—à–∏–±–∫–∞–º–∏ ‚Üí ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22)

**–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫:**
- **`02_ind_macd.py`**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22) - –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ v2.1 API
- **`03_analysis_zones.py`**: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ (2025-10-22) - –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **`03_analysis_new_features.py`**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22) - –ø–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ v2.1 API
- **`03_zones.py`**: ‚úÖ –£–î–ê–õ–ï–ù (2025-10-22) - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ 03_zones_universal.py
- **`01_data.py`**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22) - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã IndentationError –∏ TypeError —Å WindowsPath
- **`01_data_processor.py`**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (2025-10-22) - —ç–º–æ–¥–∑–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ ASCII —Å–∏–º–≤–æ–ª—ã ([OK], [+])

**–°–º. —Ç–∞–∫–∂–µ:** `research/notebooks/README.md` - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏

---

**üìä –ò–¢–û–ì–ò –ü–†–û–í–ï–†–ö–ò –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô (2025-10-22):**

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 12 –∏–∑ 20
1. ‚úÖ `01_data.py` - IndentationError, TypeError (WindowsPath)
2. ‚úÖ `01_data_processor.py` - 14 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
3. ‚úÖ `01_data_schemas.py` - 12 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
4. ‚úÖ `01_data_validator.py` - 10 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
5. ‚úÖ `02_ind_base.py` - 19 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
6. ‚úÖ `02_ind_calculators.py` - 18 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
7. ‚úÖ `02_ind_factory.py` - 3 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
8. ‚úÖ `02_ind_library.py` - 17 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
9. ‚úÖ `02_ind_macd.py` - IndentationError
10. ‚úÖ `02_ind_types.py` - 5 —ç–º–æ–¥–∑–∏ ‚Üí ASCII
11. ‚úÖ `03_analysis_new_features.py` - v2.1 API migration (–≠–¢–ê–ü 2)
12. ‚úÖ `03_zones_universal.py` - —Å–æ–∑–¥–∞–Ω (–≠–¢–ê–ü 1)

**–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** 8 —Ñ–∞–π–ª–æ–≤ (—É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ)
- 00_logging_demo.py, 01_data_loader.py, 02_ind_lib.py
- 03_analysis_base.py, 03_analysis_statistical.py, 03_analysis_zones.py
- bq.py

**–£–¥–∞–ª–µ–Ω—ã:** 1 —Ñ–∞–π–ª
- 03_zones.py (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ 03_zones_universal.py)

**–ó–∞–º–µ–Ω —ç–º–æ–¥–∑–∏:** 98 —Å–∏–º–≤–æ–ª–æ–≤ (‚úÖ‚ùåüîßüèóÔ∏è ‚Üí [OK][!][+][*])

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ 20 notebooks —Ä–∞–±–æ—Ç–∞—é—Ç —Å exit code 0
- ‚úÖ –í—Å–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å Windows cp1251 (ASCII-safe)
- ‚úÖ –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π v2.1 API
- ‚úÖ NotebookSimulator —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö

---

**üìã –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ—É—Ç–±—É–∫–æ–≤:**

–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `research/notebooks/` (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 2025-10-22):
- `02_ind_macd.py` (262 —Å—Ç—Ä–æ–∫–∏) - ‚úÖ **–û–ë–ù–û–í–õ–ï–ù** (2025-10-22) - migration guide –Ω–∞ v2.1 API
- `03_zones.py` - ‚úÖ **–£–î–ê–õ–ï–ù** (2025-10-22) - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ 03_zones_universal.py
- `03_zones_universal.py` (418 —Å—Ç—Ä–æ–∫) - ‚úÖ **–°–û–ó–î–ê–ù** (2025-10-22) - 11 steps, v2.1 API, –ø–æ–ª–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- `03_analysis_zones.py` (656 —Å—Ç—Ä–æ–∫) - ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** (2025-10-22) - —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- `03_analysis_new_features.py` (640 —Å—Ç—Ä–æ–∫) - ‚úÖ **–ü–ï–†–ï–ü–ò–°–ê–ù** (2025-10-22) - –ø–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ v2.1 API (–≠–¢–ê–ü 2)

**üõ†Ô∏è NotebookSimulator API (–∏–∑ bquant.core.nb):**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞: `nb = NotebookSimulator("Description")`
- –®–∞–≥–∏: `nb.step()`, `nb.substep()`
- –í—ã–≤–æ–¥: `nb.info()`, `nb.success()`, `nb.error()`, `nb.warning()`, `nb.data_info()`
- –ö–æ–Ω—Ç—Ä–æ–ª—å: `nb.wait()` (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å `--no-trap`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: `with nb.error_handling("Operation", critical=True):`
- –ó–∞–ø—É—Å–∫: `python script.py --no-trap` (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `script_name_log.txt`

**üìù –ü–ª–∞–Ω —Ä–∞–±–æ—Ç—ã:**

1. [x] **–û–±–Ω–æ–≤–∏—Ç—å `research/notebooks/02_ind_macd.py`** (729 ‚Üí 262 —Å—Ç—Ä–æ–∫–∏) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - [x] –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ migration guide ‚úÖ
   - [x] 8 —à–∞–≥–æ–≤ NotebookSimulator (–≤–º–µ—Å—Ç–æ 10) ‚úÖ
   - [x] –°—Ç–∞—Ä—ã–π API –ø–æ–∫–∞–∑–∞–Ω –∫–∞–∫ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ (–±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –∏–∑-–∑–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º) ‚úÖ
   - [x] –ù–æ–≤—ã–π API –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é (fluent builder + preset) ‚úÖ
   - [x] Migration guide —Å –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ ‚úÖ
   - [x] –†–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ ‚úÖ
   - [x] –ú–æ–¥—É–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ‚úÖ
   - [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚úÖ
   - [x] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (–ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞) ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ 8 —à–∞–≥–æ–≤ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å --no-trap)

2. [x] **–°–æ–∑–¥–∞—Ç—å `research/notebooks/03_zones_universal.py`** (412 —Å—Ç—Ä–æ–∫) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   
   **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (10 —à–∞–≥–æ–≤ NotebookSimulator):**
   ```python
   nb = NotebookSimulator("Universal Zone Analysis - Deep Dive")
   
   nb.step("Step 1: Data Loading & Preparation")
   # - Load sample data (tv_xauusd_1h, 1000 bars)
   # - Show data structure, statistics, visualization
   
   nb.step("Step 2: Old vs New API Comparison")
   nb.substep("2.1: Old API (MACDZoneAnalyzer)")
   # - Time measurement
   # - Show deprecation warnings
   nb.substep("2.2: New Universal API (analyze_zones)")
   # - Time measurement
   # - Show fluent builder syntax
   nb.substep("2.3: Results Comparison")
   # - Compare zones count, types, features
   # - Performance comparison (old vs new)
   # - Memory usage comparison
   
   nb.step("Step 3: Detection Strategies Experiments")
   nb.substep("3.1: Zero Crossing (MACD, AO)")
   nb.substep("3.2: Threshold (RSI)")
   nb.substep("3.3: Line Crossing (MA crossover)")
   nb.substep("3.4: Combined Rules")
   nb.substep("3.5: Preloaded Zones")
   # For each: show detected zones, statistics, visualization
   
   nb.step("Step 4: Parameter Sensitivity Analysis")
   # - MACD: vary fast/slow/signal
   # - RSI: vary thresholds
   # - min_duration impact
   # - smooth_window impact
   # Show how parameters affect zones count and quality
   
   nb.step("Step 5: Full Analysis Pipeline Deep Dive")
   # - Feature extraction details
   # - Statistical tests results
   # - Sequence analysis (transitions, patterns)
   # - Clustering (quality metrics, cluster characteristics)
   # Detailed visualization of each analysis component
   
   nb.step("Step 6: Modular Usage Scenarios")
   # - Scenario 1: Only detection ‚Üí save ‚Üí load ‚Üí analyze
   # - Scenario 2: Only analysis of preloaded zones
   # - Scenario 3: Custom feature extraction
   # - Scenario 4: Custom detection strategy
   # Use examples from zomodul.md
   
   nb.step("Step 7: Caching & Persistence Deep Dive")
   # - Cache hit/miss demonstration
   # - TTL expiration testing
   # - Save/load in 3 formats (pickle, JSON, parquet)
   # - File sizes comparison
   # - Load speed comparison
   
   nb.step("Step 8: Multiple Indicators Comparison")
   # - MACD vs RSI vs AO zones on same data
   # - Zone overlap analysis
   # - Consensus signals (multiple indicators agree)
   # - Best indicator selection criteria
   
   nb.step("Step 9: Edge Cases & Error Handling")
   # - Small datasets (< 50 bars)
   # - No zones detected
   # - Missing indicator columns
   # - Invalid parameters
   # Show how architecture handles edge cases gracefully
   
   nb.step("Step 10: Performance Benchmarks")
   # - Large datasets (5000+ bars)
   # - Multiple indicators
   # - With/without caching
   # - Memory profiling
   # - Recommendations for optimization
   
   nb.finish("Universal zone analysis investigation complete!")
   ```
   
   **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:**
   - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã) ‚úÖ
   - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã) ‚úÖ
   - [x] –î–æ–±–∞–≤–ª–µ–Ω—ã benchmarks –¥–ª—è 100 –∏ 1000 –±–∞—Ä–æ–≤ ‚úÖ
   - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ nb.error_handling() ‚úÖ
   - [x] –†–∞–±–æ—Ç–∞–µ—Ç —Å `--no-trap` ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** 11 —à–∞–≥–æ–≤, 72 MACD –∑–æ–Ω—ã, ~14K –∑–æ–Ω/—Å–µ–∫, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
   - [x] **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** Problems 1.1-1.7 —á–µ—Ä–µ–∑ zonan_uni_full.md ‚úÖ

3. [x] **–£–¥–∞–ª–∏—Ç—å `research/notebooks/03_zones.py`** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - [x] –§–∞–π–ª —É–¥–∞–ª–µ–Ω (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ 03_zones_universal.py) ‚úÖ

4. [x] **–û–±–Ω–æ–≤–∏—Ç—å `research/notebooks/README.md`** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ 03_zones_universal.py (418 —Å—Ç—Ä–æ–∫, 11 —à–∞–≥–æ–≤) ‚úÖ
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å 02_ind_macd.py (—Ä–∞–±–æ—Ç–∞–µ—Ç, migration guide) ‚úÖ
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (20/20 —Ä–∞–±–æ—Ç–∞—é—Ç, 100%) ‚úÖ
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é ‚úÖ
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (Stage 2.4 –∑–∞–≤–µ—Ä—à–µ–Ω) ‚úÖ
   - [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –≤ —Å–ø–∏—Å–æ–∫ ‚úÖ

5. [x] **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –Ω–æ—É—Ç–±—É–∫–∏ research/notebooks/** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û (2025-10-22)**
   - [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ 20 —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å --no-trap ‚úÖ
   - [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 12 —Ñ–∞–π–ª–æ–≤ (—ç–º–æ–¥–∑–∏, –æ—Ç—Å—Ç—É–ø—ã, v2.1 migration) ‚úÖ
   - [x] 8 —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ) ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 20/20 —Ä–∞–±–æ—Ç–∞—é—Ç —Å exit code 0 ‚úÖ

#### 2.5 Integration —Ç–µ—Å—Ç—ã (0.5 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û (2025-10-22)**

1. [x] –°–æ–∑–¥–∞—Ç—å `tests/integration/test_zone_analysis_e2e.py` (283 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
   - [x] End-to-end —Ç–µ—Å—Ç—ã –≤—Å–µ–≥–æ pipeline –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ ‚úÖ
   - [x] MACD: `test_macd_full_pipeline()`, `test_macd_preset_convenience()` ‚úÖ
   - [x] RSI: `test_rsi_full_pipeline()`, `test_rsi_preset_convenience()` ‚úÖ
   - [x] AO: `test_ao_full_pipeline()`, `test_ao_preset_convenience()` ‚úÖ
   - [x] Preloaded: `test_preloaded_zones_pipeline()` ‚ö†Ô∏è (skipped - —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞)
   - [x] Performance: `test_pipeline_performance()`, `test_multiple_indicators_performance()` ‚úÖ
   - [x] Edge cases: `test_small_dataset()`, `test_no_zones_detected()` ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 10 —Ç–µ—Å—Ç–æ–≤ (9 passed, 1 skipped)
   
2. [x] –°–æ–∑–¥–∞—Ç—å `tests/integration/test_backward_compatibility.py` (210 —Å—Ç—Ä–æ–∫) ‚úÖ
   - [x] –¢–µ—Å—Ç—ã —á—Ç–æ —Å—Ç–∞—Ä—ã–π MACDZoneAnalyzer —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π API ‚úÖ
   - [x] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ç–∞—Ä–æ–≥–æ vs –Ω–æ–≤–æ–≥–æ (–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å) ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ deprecation warnings ‚úÖ
   - [x] –¢–µ—Å—Ç—ã –Ω–æ–≤—ã—Ö v2.1 features (.with_strategies(), zone.features) ‚úÖ
   - [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 8 —Ç–µ—Å—Ç–æ–≤ (all passed)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- ‚úÖ –°—Ç–∞—Ä—ã–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (backward compatibility)
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: –ø—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã (examples/) vs –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ (notebooks/)
- ‚úÖ –ù–ï–¢ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ (–æ–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤)

### –≠—Ç–∞–ø 3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (2-3 –¥–Ω—è) ‚Äî **—Å—Ç–∞—Ç—É—Å: –≤ —Ä–∞–±–æ—Ç–µ**

**–¶–µ–ª—å:** –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**üìñ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** –°–º. –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã zonan.md + [zomodul.md](zomodul.md) + –æ—Ç—á—ë—Ç—ã `zoval_check.md`

1. [x] API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –∏–∑ zonan.md
   - [x] –ü–µ—Ä–µ–ø–∏—Å–∞–Ω—ã `docs/api/analysis/zones.md`, `strategies.md`, `pipeline.md` –ø–æ–¥ Universal Pipeline (—Å–º. –≤–∞–ª–∏–¥–∞—Ü–∏—é `docs/api` –≤ `zoval_check.md`).
   - [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω legacy-–ø—Ä–∏–º–µ—Ä `find_support_resistance` –≤ `docs/api/analysis/zones.md` (—Ä–∞–±–æ—á–∏–µ –¥–∞–Ω–Ω—ã–µ + –ø–æ—è—Å–Ω–µ–Ω–∏—è –ø–æ ZoneFeaturesAnalyzer).
   - [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—ã–π developer guide –≤ `docs/api/analysis/strategies.md` –∏ `docs/developer_guide/README.md`.
   - [x] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏/–ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `FICTIONAL_INDICATOR_99`) –ª–∏–±–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–∞–º.
   - [x] –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫/–∫—Ä–µ—Å—Ç-—Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–≤ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è legacy-–±–ª–æ–∫–∞.
   - **–ü—Ä–æ–≥—Ä–µ—Å—Å:** 5/5 –∑–∞–¥–∞—á –∑–∞–∫—Ä—ã—Ç–æ ‚Äî doc-–ø—Ä–∏–º–µ—Ä—ã –ø–æ–∫—Ä—ã—Ç—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–º, —Å—Å—ã–ª–∫–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã.

2. [x] User Guide ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏–∑ zonan.md
   - ‚úÖ Quick Start –∏ –æ—Å–Ω–æ–≤–Ω–æ–π README –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–¥ Universal Pipeline.
   - ‚úÖ –§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: `docs/user_guide/zone_analysis_pipeline.md` –ø—Ä–∏–∑–Ω–∞–Ω –æ—Å–Ω–æ–≤–Ω—ã–º –≥–∏–¥–æ–º, –æ–±–Ω–æ–≤–ª–µ–Ω—ã TOC –∏ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏.
   - [x] Migration guide (–ø–µ—Ä–µ—Ö–æ–¥ —Å–æ —Å—Ç–∞—Ä–æ–≥–æ API) ‚Äî –æ—Ñ–æ—Ä–º–ª–µ–Ω –∫–∞–∫ `docs/user_guide/MIGRATION_v2.md` —Å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ü—Ä–∏–º–µ—Ä 7 –∏ `MACDZoneAnalyzer`.
   - [x] Best practices ‚Äî –≤—ã–Ω–µ—Å–µ–Ω –º–∞—Ç–µ—Ä–∏–∞–ª –∏–∑ [Best Practices](zomodul.md#best-practices) –≤ —Ä–∞–∑–¥–µ–ª `docs/user_guide/zone_analysis_pipeline.md#best-practices` —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

3. [x] Developer Guide ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
   - [x] –°–æ–∑–¥–∞–Ω–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ `docs/developer_guide/zone_detection_strategies.md` (—à–∞–±–ª–æ–Ω + –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏).
   - [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ [–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: –°–ª–æ–π 1](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è).
   - [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `UniversalZoneAnalyzer` —Å –æ–ø–æ—Ä–æ–π –Ω–∞ [–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: –°–ª–æ–π 2](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è).
   - [x] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω contribution guide —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ç–µ—Å—Ç–∞–º, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ä–µ–≤—å—é.

4. [x] Tutorials ‚Üí –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ zonan.md
   - [x] Tutorial: –∞–Ω–∞–ª–∏–∑ –∑–æ–Ω MACD ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä 1](#–ø—Ä–∏–º–µ—Ä—ã).
   - [x] Tutorial: –∞–Ω–∞–ª–∏–∑ –∑–æ–Ω RSI ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä 5](#–ø—Ä–∏–º–µ—Ä—ã).
   - [x] Tutorial: –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä 8](#–ø—Ä–∏–º–µ—Ä—ã).
   - [x] Tutorial: —Ä–∞–±–æ—Ç–∞ —Å preloaded –∑–æ–Ω–∞–º–∏ ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä 3](#–ø—Ä–∏–º–µ—Ä—ã) –∏ [–°—Ü–µ–Ω–∞—Ä–∏–π 9](zomodul.md).

5. [ ] –¢—Ä—ç–π—Å–ª–æ–≥ –∏ migration notes
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–Ω–µ–≤–Ω–æ–π —Ç—Ä—ç–π—Å–ª–æ–≥ –≤ `changelogs/CHANGE_TRACE_LOG_YYYY-MM-DD.md` –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º –∏–∑ `changelogs/README.md`, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–≤ –∫–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è Universal Zone Analyzer + pipeline.
   - [ ] –°–æ–∑–¥–∞—Ç—å `MIGRATION_v2.md` (–∏–ª–∏ –æ–¥–Ω–æ–∏–º—ë–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª user guide) —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å–æ —Å—Ç–∞—Ä–æ–≥–æ API.
   - [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å breaking changes / legacy-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –¥–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (2025-10-xx):** API/User Guide/Developer Guide –∏ tutorials –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω—ã. –û—Ç–∫—Ä—ã—Ç –±–ª–æ–∫ –ø–æ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç—Ä—ç–π—Å–ª–æ–≥–µ –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–≤–æ–¥–∫–µ; —ç—Ç–∞–ø –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –ø–æ—Å–ª–µ –∏—Ö –∑–∞–∫—Ä—ã—Ç–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

### –≠—Ç–∞–ø 4: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (1-2 –¥–Ω—è)

**–¶–µ–ª—å:** –†–∞—Å—à–∏—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω

**üìñ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)

1. [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `bquant/visualization/zones.py` (~250 —Å—Ç—Ä–æ–∫)
   - [ ] –ú–µ—Ç–æ–¥ `plot_zone_detail()` ‚Üí –°–º. [–î–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–æ–Ω—ã (plot_zone_detail)](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - [ ] –ú–µ—Ç–æ–¥ `plot_zones_comparison()` ‚Üí –°–º. [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–æ–Ω (plot_zones_comparison)](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - [ ] Helper `_get_zone_window()` ‚Üí –°–º. [–î–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–æ–Ω—ã](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - [ ] Helper `_detect_indicators_from_features()` ‚Üí –°–º. [–î–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–æ–Ω—ã](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - [ ] Helper `_filter_zones_by_date()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ
   - [ ] Plotly —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤
   - [ ] Matplotlib —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ)

2. [ ] –û–±–Ω–æ–≤–∏—Ç—å `bquant/analysis/zones/models.py` (~50 —Å—Ç—Ä–æ–∫)
   - [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `ZoneAnalysisResult.visualize()` ‚Üí –°–º. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZoneAnalysisResult](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–∂–∏–º–æ–≤: overview, detail, comparison, statistics

3. [ ] –û–±–Ω–æ–≤–∏—Ç—å `bquant/visualization/__init__.py`
   - [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å convenience —Ñ—É–Ω–∫—Ü–∏–∏

4. [ ] Unit-—Ç–µ—Å—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (~15 —Ç–µ—Å—Ç–æ–≤)
   - [ ] –¢–µ—Å—Ç—ã `plot_zone_detail()` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - [ ] –¢–µ—Å—Ç—ã `plot_zones_comparison()` —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
   - [ ] –¢–µ—Å—Ç—ã `ZoneAnalysisResult.visualize()` –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
   - [ ] –¢–µ—Å—Ç—ã auto-detect –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

5. [ ] –ü—Ä–∏–º–µ—Ä—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è) –∏ [–°—Ü–µ–Ω–∞—Ä–∏–π 10](zomodul.md)
   - [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ examples/ –ø—Ä–∏–º–µ—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
   - [ ] Notebook —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
   - [ ] Screenshots –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### –≠—Ç–∞–ø 5: –û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (1 –¥–µ–Ω—å)

**–¶–µ–ª—å:** –£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

1. [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ (–ø–æ—Å–ª–µ –ø–µ—Ä–∏–æ–¥–∞ deprecation)
   - [ ] –£–¥–∞–ª–∏—Ç—å –º–µ—Ç–æ–¥—ã —Ä–∞—Å—á–µ—Ç–∞ –∏–∑ `MACDZoneAnalyzer`
   - [ ] –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ wrapper –¥–ª—è backward compatibility
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å deprecation warnings

2. [ ] Code review –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å code style (black, isort, flake8)
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å type hints
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å docstrings
   - [ ] –£–±—Ä–∞—Ç—å TODO –∏ FIXME –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

3. [ ] –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - [ ] –í—Å–µ unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (~600+ —Ç–µ—Å—Ç–æ–≤)
   - [ ] –í—Å–µ integration —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
   - [ ] Coverage > 90%
   - [ ] No regression –≤ performance

4. [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–µ–ª–∏–∑—É
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –ø–∞–∫–µ—Ç–∞
   - [ ] –§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å CHANGELOG
   - [ ] –°–æ–∑–¥–∞—Ç—å release notes
   - [ ] Tag –≤ git

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–∏—Å—Ç–∞—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞, –≥–æ—Ç–æ–≤–∞—è –∫ production

---

### –ë—É–¥—É—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ (Post-Release)

**üìñ Roadmap:** –°–º. —Ä–∞–∑–¥–µ–ª [–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞:

**–ù–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏** (0 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ):
- ML-based Detection ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä—ã –±—É–¥—É—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- Pattern-based Detection ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä—ã –±—É–¥—É—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- Volume Profile, Market Structure ‚Üí –°–º. [–ü—Ä–∏–º–µ—Ä—ã –±—É–¥—É—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

**–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–Ω–∞–ª–∏–∑–∞** (—á–µ—Ä–µ–∑ DI):
- ML Predictor, Backtesting Engine, Risk Analyzer ‚Üí –°–º. [–°–ª–æ–π 2: —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DI](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Builder** (–Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã):
- `.preprocess()`, `.filter_zones()`, `.transform_zones()` ‚Üí –°–º. [Builder: –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- `.with_ml_predictions()`, `.with_backtesting()`, `.export_to()` ‚Üí –°–º. [Builder: –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

**–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏:**
- `filters.py`, `transformers.py`, `exporters/`, `ml/`, `backtesting/`, `risk/` ‚Üí –°–º. [–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (–±—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)](#—Ç–æ—á–∫–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

### –°–≤–æ–¥–∫–∞ –ø–æ —ç—Ç–∞–ø–∞–º

| –≠—Ç–∞–ø | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ó–∞–¥–∞—á–∏ | –¢–µ—Å—Ç—ã | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------|--------------|--------|-------|-----------|
| **–≠—Ç–∞–ø 0** | 1-2 –¥–Ω—è | –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ + —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è | –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ (507) + 15 –Ω–æ–≤—ã—Ö | –§—É–Ω–¥–∞–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ |
| **–≠—Ç–∞–ø 1** | 4-6 –¥–Ω–µ–π | Detection + Analyzer + Pipeline + Cache | +90 –Ω–æ–≤—ã—Ö | –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∫—ç—à–µ–º |
| **–≠—Ç–∞–ø 2** | 2-3 –¥–Ω—è | Backward compatibility + –ø—Ä–∏–º–µ—Ä—ã | +48 –Ω–æ–≤—ã—Ö | ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û (2025-10-22) |
| **–≠—Ç–∞–ø 3** | 2-3 –¥–Ω—è | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | - | –í –ø—Ä–æ—Ü–µ—Å—Å–µ: –∑–∞–≤–µ—Ä—à–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |
| **–≠—Ç–∞–ø 4** | 1-2 –¥–Ω—è | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | +15 –Ω–æ–≤—ã—Ö | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| **–≠—Ç–∞–ø 5** | 1 –¥–µ–Ω—å | –û—á–∏—Å—Ç–∫–∞ + —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è | ~657+ –∏—Ç–æ–≥–æ | Production ready |
| **–ò–¢–û–ì–û** | **11-17 –¥–Ω–µ–π** | **~2800 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞** | **~150 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤** | **–ì–æ—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** |

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–¥–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | –§–∞–π–ª–æ–≤ | –¢–µ—Å—Ç–æ–≤ |
|-----------|------------|--------|--------|
| Models (+ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è) | 400 | 1 | 15 |
| Detection Strategies | 850 | 6 | 50 |
| Universal Analyzer | 200 | 1 | 15 |
| Pipeline + Builder (+ –∫—ç—à) | 500 | 1 | 25 |
| Visualization | 250 | 1 (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ) | 15 |
| Backward compatibility | 100 | 1 (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ) | 20 |
| Integration tests | 200 | 2-3 | 10 |
| Tests (unit) | ~2500 | 12-15 | 150 |
| Documentation | ~5000 | 15-20 | - |
| **–ò–¢–û–ì–û** | **~10000** | **40-48** | **~657** |

### –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|-----------|
| –ù–∞—Ä—É—à–µ–Ω–∏–µ backward compatibility | –°—Ä–µ–¥–Ω—è—è | Wrapper –∫–ª–∞—Å—Å—ã + deprecation warnings + —Ç–µ—Å—Ç—ã |
| Performance regression | –ù–∏–∑–∫–∞—è | Performance —Ç–µ—Å—Ç—ã –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ |
| –ù–µ–ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ | –°—Ä–µ–¥–Ω—è—è | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ coverage > 90% |
| –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –°—Ä–µ–¥–Ω—è—è | –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —ç—Ç–∞–ø –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ù–∏–∑–∫–∞—è | Fluent API + –ø—Ä–∏–º–µ—Ä—ã + migration guide |

---

<a name="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ"></a>
## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
IndicatorFactory (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    ‚Üì
ZoneAnalysisPipeline / Builder (–Ω–æ–≤–æ–µ - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
    ‚îú‚îÄ –°–ª–æ–π 1: ZoneDetectionStrategies (5 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
    ‚îî‚îÄ –°–ª–æ–π 2: UniversalZoneAnalyzer (–∞–≥–Ω–æ—Å—Ç–∏—á–µ–Ω –∫ –∑–æ–Ω–∞–º)
```

**–£–ë–†–ê–ù–û:**
- ‚ùå –°–ª–æ–π 3 (Indicator Facades) - hardcode, –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å

**–î–û–ë–ê–í–õ–ï–ù–û:**
- ‚úÖ ZoneAnalysisPipeline - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ ZoneAnalysisBuilder - fluent API —Å `.with_cache()`
- ‚úÖ –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IndicatorFactory
- ‚úÖ PreloadedZonesDetection –∫–∞–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫)
- ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (pickle, JSON, parquet)
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (`plot_zone_detail`, `plot_zones_comparison`)

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ü—Ä–æ—â–µ:** 2 —Å–ª–æ—è –≤–º–µ—Å—Ç–æ 3, –Ω–µ—Ç hardcode —Ñ–∞—Å–∞–¥–æ–≤
2. **–ì–∏–±—á–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è + Fluent API + –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã
3. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–µ–µ:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –õ–Æ–ë–´–ú –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –∏–∑ IndicatorFactory
4. **–ü—Ä–∞–≤–∏–ª—å–Ω–µ–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–µ–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫)
6. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ pickle/JSON/parquet
7. **–ù–∞–≥–ª—è–¥–Ω–æ:** –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –º–µ—Ç—Ä–∏–∫

### –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|--------|-----------|
| –†–∞–∑–º–µ—Ä MACDZoneAnalyzer | 564 —Å—Ç—Ä–æ–∫–∏ | 0 —Å—Ç—Ä–æ–∫ (—É–¥–∞–ª–µ–Ω) | -100% |
| –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞—Å–∞–¥–æ–≤ | 1 (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å N) | 0 | -100% |
| –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ | 0 | 2 (Pipeline + Builder) | +‚àû |
| –ö–æ–¥ –¥–ª—è –Ω–æ–≤–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ | 20-60 —Å—Ç—Ä–æ–∫ | 0 —Å—Ç—Ä–æ–∫ | -100% |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ | 1 (hardcoded) | 4 (—á–µ—Ä–µ–∑ IndicatorFactory) | +300% |
| –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–µ—Ç | Auto (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫) | +100% |
| –§–æ—Ä–º–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è | –ù–µ—Ç | 3 (pickle, JSON, parquet) | +300% |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω | –û–±—â–∞—è | –î–µ—Ç–∞–ª—å–Ω–∞—è + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | +200% |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (3 —Å–ø–æ—Å–æ–±–∞ –Ω–∞ –≤—ã–±–æ—Ä)

**1. Fluent Builder (—Å–∞–º—ã–π —É–¥–æ–±–Ω—ã–π):**
```python
result = (
    analyze_zones(df)
    .with_indicator('custom', 'macd', fast=12, slow=26)
    .detect_zones('zero_crossing', indicator_col='macd')
    .analyze(clustering=True)
    .with_cache(ttl=7200)  # –ö—ç—à –Ω–∞ 2 —á–∞—Å–∞
    .build()
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
result.save('results/macd_zones.pkl')

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
result.visualize('overview')
result.visualize('detail', zone_id=3)
```

**2. Pipeline + Config (–¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è):**
```python
config = ZoneAnalysisConfig(...)
result = ZoneAnalysisPipeline(config).run(df)
```

**3. –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å):**
```python
indicator = IndicatorFactory.create(...)
zones = detector.detect_zones(...)
result = analyzer.analyze_zones(...)
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-15  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-18  
**–ê–≤—Ç–æ—Ä—ã:** AI Assistant (Claude Sonnet 4.5), Ivan  
**–í–µ—Ä—Å–∏—è:** v8.4 (Stage 2.1-2.4 Complete + Critical Bugfixes)  
**–°—Ç–∞—Ç—É—Å:** Stage 1 ‚úÖ | Stage 2.1-2.4 ‚úÖ | Stage 2.5-3 Ready for Implementation

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.5 (2025-10-18):**
- ‚úÖ **Bugfixes #1-3 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:**
  - #1: ZoneFeaturesAnalyzer - –¥–æ–±–∞–≤–ª–µ–Ω–∞ auto-detection –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (universal)
  - #2: HypothesisTestSuite - –∑–∞–º–µ–Ω–µ–Ω–∞ 'type' ‚Üí 'zone_type' (8 occurrences)
  - #3: RSI/AO presets - —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø–æ–ª–Ω—ã–º analyze() (–∞–≤—Ç–æ-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- ‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:** RSI/AO zones —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚ö†Ô∏è **–ê–Ω–∞–ª–∏–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—è–≤–∏–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
  - **Bug #4 (CRITICAL):** StatisticalShapeStrategy hardcoded 'macd_hist'
  - **Bug #5 (CRITICAL):** ClassicDivergenceStrategy hardcoded 'macd_hist'/'macd'
  - **Bug #6 (LOW):** StandardVolumeStrategy - volume_macd_corr –Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω
- üìä **–¢–µ–∫—É—â–∞—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** 75% (—Ö–æ—Ä–æ—à–æ, –Ω–æ –Ω—É–∂–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
  - Zone Detection: 100% ‚úÖ
  - Swing Strategies: 100% ‚úÖ
  - Volatility Strategy: 100% ‚úÖ
  - Shape/Divergence: 0% ‚ùå (CRITICAL)
  - Volume: 90% ‚ö†Ô∏è
- üìÑ **–°–æ–∑–¥–∞–Ω [zouni.md](zouni.md)** - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 95%+ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ (~15 hours)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.4 (2025-10-18):**
- ‚úÖ **Stage 2.4 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω:**
  - –û–±–Ω–æ–≤–ª–µ–Ω `02_ind_macd.py` (729‚Üí262 —Å—Ç—Ä–æ–∫–∏, migration guide, 8 —à–∞–≥–æ–≤)
  - –°–æ–∑–¥–∞–Ω `03_zones_universal.py` (412 —Å—Ç—Ä–æ–∫, comprehensive test, 10 —à–∞–≥–æ–≤)
  - –£–¥–∞–ª–µ–Ω `03_zones.py` (–Ω–µ–ø–æ–ª–Ω—ã–π —á–µ—Ä–Ω–æ–≤–∏–∫)
  - –û–±–Ω–æ–≤–ª–µ–Ω `research/notebooks/README.md` (+150 —Å—Ç—Ä–æ–∫)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: ‚úÖ –û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å `--no-trap`
- üêõ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô BUGFIX:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è swing strategies
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –≤ `bquant/analysis/zones/strategies/__init__.py`
  - –¢–µ–ø–µ—Ä—å ZigZag/FindPeaks/PivotPoints strategies —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ "Unknown swing strategy: zigzag. Available: []"
- üêõ **–í—ã—è–≤–ª–µ–Ω—ã –±–∞–≥–∏ #1-3** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ v8.5):
  - ZoneFeaturesAnalyzer hardcoded –¥–ª—è MACD –∫–æ–ª–æ–Ω–æ–∫
  - HypothesisTestSuite expects 'type' column (–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º)
  - RSI/AO presets fall –∏–∑-–∑–∞ –±–∞–≥–∞ –≤ features analyzer
- üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** 15/19 —Ä–∞–±–æ—Ç–∞—é—Ç (79%, +2), 4/19 –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (21%, -2)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.3 (2025-10-18):**
- ‚úÖ **–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ü–û–õ–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö research/notebooks** (19/19 —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å `--no-trap`)
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω `research/notebooks/README.md`** —Å –ø–æ–ª–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º:
  - –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö 19 —Å–∫—Ä–∏–ø—Ç–æ–≤
  - –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é (Data / Indicators / Analysis / Utilities)
  - –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫
  - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è Stage 2.4
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω `zonan.md` Stage 2.4** —Å –ø–æ–ª–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:
  - –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
  - –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö 19 —Å–∫—Ä–∏–ø—Ç–æ–≤
  - –ê–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
  - –î–µ—Ç–∞–ª–∏ –≤—Å–µ—Ö 6 –æ—à–∏–±–æ–∫
- üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:** 13/19 —Ä–∞–±–æ—Ç–∞—é—Ç (68%), 5/19 –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (26%), 1/19 –Ω–µ–ø–æ–ª–Ω—ã–π (5%)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.2 (2025-10-18):**
- ‚úÖ **–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ research/notebooks** (6 —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å `--no-trap`)
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω `research/notebooks/README.md`** —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω `zonan.md` Stage 2.4** —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2/6 —Ä–∞–±–æ—Ç–∞—é—Ç, 3/6 —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, 1/6 –Ω–µ–ø–æ–ª–Ω—ã–π

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.1 (2025-10-18):**
- ‚úÖ **Stage 2.1-2.3 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:**
  - 2.1: MACDZoneAnalyzer slim down (517‚Üí254 lines, 11 tests)
  - 2.2: Convenience presets (4 functions, 13 tests)
  - 2.3: Public examples (4 files, ~956 lines documentation)
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ research/notebooks:**
  - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã 4 —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ—É—Ç–±—É–∫–∞
  - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ñ–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
  - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω NotebookSimulator API
  - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è 03_zones_universal.py (10 —à–∞–≥–æ–≤)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –ø–ª–∞–Ω Stage 2.4 —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v8.0 (2025-10-18):**
- ‚úÖ **Stage 1 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω:**
  - 11 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (~1700 —Å—Ç—Ä–æ–∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥–∞)
  - 50 unit-—Ç–µ—Å—Ç–æ–≤ (100% passing)
  - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏"
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–æ–¥–∞:**
  - –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω: —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –ø–æ–¥ –∫–∞–∂–¥—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
  - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API
  - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: examples/ vs research/notebooks/
  - –†–∞–∑–º–µ—â–µ–Ω–∏–µ: indicators/ (—Ä–∞—Å—á–µ—Ç) vs analysis/zones/ (–∞–Ω–∞–ª–∏–∑)
- ‚úÖ **–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –≠—Ç–∞–ø 2 —Å —É—á–µ—Ç–æ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:**
  - 2.1: Slim down MACDZoneAnalyzer (518‚Üí100 —Å—Ç—Ä–æ–∫)
  - 2.2: Convenience wrappers (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, presets.py)
  - 2.3: –ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã (examples/)
  - 2.4: –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–æ—É—Ç–±—É–∫–∏ (research/notebooks/)
  - 2.5: Integration —Ç–µ—Å—Ç—ã
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ —Å—Ç–∞—Ç—É—Å–∞
- –ü—Ä–∏–Ω—Ü–∏–ø: "–û–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ - ZERO –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞"

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v7.1:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –ø–ª–∞–Ω–µ –º–∏–≥—Ä–∞—Ü–∏–∏
  - –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–∞–∑–¥–µ–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∑–∞–≥–æ—Ç–æ–≤–∫–æ–π –∫–æ–¥–∞
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—â–∞—è —Å–ø—Ä–∞–≤–∫–∞ –≤ –Ω–∞—á–∞–ª–µ –ø–ª–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
  - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ zomodul.md –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ë—É–¥—É—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ" —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ü—Ä–∏–Ω—Ü–∏–ø: "–°–ª–µ–¥—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—É, –Ω–µ –∏–∑–æ–±—Ä–µ—Ç–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ!"

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v7:**
- –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ" (~660 —Å—Ç—Ä–æ–∫)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `bquant.core.cache`
- –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (pickle, JSON, parquet)
- –û–±–Ω–æ–≤–ª–µ–Ω –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: ~2800 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, ~150 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v6:**
- –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω" (~400 —Å—Ç—Ä–æ–∫)
- –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ (5 —ç—Ç–∞–ø–æ–≤)
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ZoneVisualizer –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- –ú–µ—Ç–æ–¥ `visualize()` –≤ ZoneAnalysisResult

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v5:**
- –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (Code Templates)"
- –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã"
- –ü–æ–ª–Ω—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –¥–ª—è –≤—Å–µ—Ö 5 –±–∞–∑–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –®–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–ò–∑–º–µ–Ω–µ–Ω–∏—è v4:**
- –£–¥–∞–ª–µ–Ω –°–ª–æ–π 3 (–∏–∑–±—ã—Ç–æ—á–Ω—ã–µ —Ñ–∞—Å–∞–¥—ã)
- –î–æ–±–∞–≤–ª–µ–Ω ZoneAnalysisPipeline –∏ ZoneAnalysisBuilder (fluent API)
- –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IndicatorFactory

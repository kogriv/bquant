# Анализ ошибки: set_data_dir не влияет на load_symbol_data

## Описание проблемы

При выполнении скрипта `research/notebooks/01_data_loader.py` на шаге 3 возникает ошибка `DataLoadingError: Data file not found`. Ошибка происходит при вызове `load_symbol_data` после попытки изменить рабочую директорию данных с помощью `set_data_dir`.

## Анализ корневой причины

Причина — логическая ошибка во взаимодействии двух функций в модуле `bquant/core/config.py`: `set_data_dir` и `get_data_path`.

1.  **Намерение в скрипте:** В шаге 3 вы совершенно правильно вызываете
    `set_data_dir(...)`, чтобы временно установить рабочую директорию для
    данных как `C:\...bquant\data\row`. Вы ожидаете, что все последующие
    операции с данными будут происходить именно там.

2.  **Что происходит на самом деле:** Функция `load_symbol_data` внутри себя
    вызывает другую функцию, `get_data_path`, чтобы построить полный путь к
    файлу.

3.  **Корень проблемы:** Функция `get_data_path` игнорирует временную директорию,
    установленную через `set_data_dir`. Вместо того чтобы использовать гибкую
    функцию `get_data_dir()`, она жестко привязана к исходной, "зашитой" в коде
    константе `DATA_DIR` (`C:\...bquant\data`).

**Итог:** `load_symbol_data` пытается найти файл `XAUUSDH1.csv` не в `data\row`, а в `data`, где его нет. Это и приводит к ошибке `Data file not found`.

## План решения

Решение заключается в простом, но ключевом исправлении одной строки в функции `get_data_path`.

-   **Файл для изменения:** `bquant/core/config.py`
-   **Функция:** `get_data_path`
-   **Текущая реализация (неверная):**
    ```python
    def get_data_path(...):
        # ... логика генерации имени файла ...
        filename = pattern.format(...)
        return DATA_DIR / filename
    ```
-   **Проблема:** Возврат значения `DATA_DIR / filename` использует глобальную константу, игнорируя изменения, сделанные функцией `set_data_dir`.
-   **Корректная реализация:**
    ```python
    def get_data_path(...):
        # ... логика генерации имени файла ...
        filename = pattern.format(...)
        return get_data_dir() / filename
    ```
-   **Объяснение:** Замена `DATA_DIR` на вызов функции `get_data_dir()` исправит ошибку. Функция `get_data_dir()` спроектирована так, чтобы возвращать либо временный путь (если он был установлен через `set_data_dir`), либо путь по умолчанию (`DATA_DIR`), если ничего не менялось. Это сделает поведение системы предсказуемым и логичным.

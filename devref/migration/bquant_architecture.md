# BQuant - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**BQuant** - —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤. –ü—Ä–æ–µ–∫—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å MACD –∞–Ω–∞–ª–∏–∑–∞ –∑–æ–Ω –∫–∞–∫ –ø–µ—Ä–≤–æ–≥–æ –∫–µ–π—Å–∞, –Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤: —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, —Å–≤–µ—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ü–∏–π, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üîß **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –±—Ä–æ–∫–µ—Ä–æ–≤
- üìä **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∞–Ω–∞–ª–∏–∑** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π, —Å–≤–µ—á–Ω–æ–π, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã
- ü§ñ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ ML** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (–∑–∞–≥–ª—É—à–∫–∏)
- üìà **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏** - –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç—ã
- üß™ **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å—Ä–µ–¥–∞** - –Ω–æ—É—Ç–±—É–∫–∏ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
- üöÄ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã** - –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** - –Ω–∞—á–∏–Ω–∞–µ–º —Å MACD, —Ä–∞–∑–≤–∏–≤–∞–µ–º—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω—É –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—Å–µ—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Ä—ã–Ω–∫–∞
- **–ù–∞—É—á–Ω–∞—è —Å—Ç—Ä–æ–≥–æ—Å—Ç—å** - —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –º–∏–Ω–∏–º—É–º –∫–æ–¥–∞ –¥–ª—è –º–∞–∫—Å–∏–º—É–º–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏  
- **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –º–µ—Ç–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bquant/
‚îú‚îÄ‚îÄ setup.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ pyproject.toml              # –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Python
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ README.md                   # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ bquant/                     # üì¶ –û–°–ù–û–í–ù–û–ô –ü–ê–ö–ï–¢
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ core/                   # üéØ –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ data/                   # üíæ –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏  
‚îÇ   ‚îú‚îÄ‚îÄ indicators/             # üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ analysis/              # üî¨ –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ ml/                    # ü§ñ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ visualization/         # üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ research/                   # üß™ –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø
‚îÇ   ‚îú‚îÄ‚îÄ notebooks/             # Jupyter –Ω–æ—É—Ç–±—É–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ experiments/           # ML —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ studies/               # –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ methodology/           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ scripts/                    # üöÄ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø
‚îÇ   ‚îú‚îÄ‚îÄ pipelines/             # –ü–∞–π–ø–ª–∞–π–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ data_processing/       # –°–∫—Ä–∏–ø—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ analysis/              # –ì–æ—Ç–æ–≤—ã–µ –∞–Ω–∞–ª–∏–∑—ã
‚îÇ   ‚îî‚îÄ‚îÄ deployment/            # –î–µ–ø–ª–æ–π –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ
‚îú‚îÄ‚îÄ data/                       # üíΩ –î–ê–ù–ù–´–ï
‚îÇ   ‚îú‚îÄ‚îÄ raw/                   # –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ processed/             # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ features/              # –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è ML (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ models/                # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ
‚îú‚îÄ‚îÄ tests/                      # ‚úÖ –¢–ï–°–¢–´ (–í–ù–ï –ü–ê–ö–ï–¢–ê)
‚îÇ   ‚îú‚îÄ‚îÄ unit/                  # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ integration/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/              # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ
‚îú‚îÄ‚îÄ docs/                       # üìñ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ tutorials/             # –¢—É—Ç–æ—Ä–∏–∞–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ examples/              # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ logs/                       # üìù –õ–æ–≥–∏
‚îî‚îÄ‚îÄ results/                    # üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
```

---

## üì¶ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

### üéØ `bquant/core/` - –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã

```python
bquant/core/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ config.py                   # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ utils.py                    # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ logging_config.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ exceptions.py               # –ò—Å–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îî‚îÄ‚îÄ numpy_fix.py                # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è numpy
```

#### `bquant/core/config.py`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `core/config.py`

**–ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:**
- –í—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (`PROJECT_ROOT`, `DATA_DIR`, `TIMEFRAME_MAPPING`, `DATA_FILE_PATTERNS`)
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`get_data_path()`, `get_indicator_params()`, `validate_timeframe()`)
- `DEFAULT_INDICATORS` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å:**
- –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—É—Ç—è—Ö –Ω–∞ `bquant`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –≥–æ—Ç–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö

#### `bquant/core/utils.py` - –ù–æ–≤—ã–π –º–æ–¥—É–ª—å
```python
"""
–û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã BQuant
"""
import pandas as pd
import numpy as np
from typing import Dict, Any, List
import logging

def setup_project_logging(level: str = 'INFO') -> logging.Logger:
    """–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞"""
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    pass

def calculate_returns(prices: pd.Series) -> pd.Series:
    """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
    return prices.pct_change()

def normalize_data(data: pd.DataFrame, method: str = 'zscore') -> pd.DataFrame:
    """–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ"""
    # –ü—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
    pass

def save_results(data: Any, filepath: str, format: str = 'csv'):
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
    pass
```

#### `bquant/core/exceptions.py`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π, –±–∞–∑–∏—Ä—É—è—Å—å –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö –∏–∑ —Å—Ç–∞—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤

```python
"""–ò—Å–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã BQuant"""

class BQuantError(Exception):
    """–ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ BQuant"""
    pass

class DataError(BQuantError):
    """–û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö"""
    pass

class ConfigurationError(BQuantError):
    """–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""  
    pass

class AnalysisError(BQuantError):
    """–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞"""
    pass
```

#### `bquant/core/numpy_fix.py`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `scripts/core/numpy_fix.py`

```python
"""
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ numpy
–ò–°–¢–û–ß–ù–ò–ö: scripts/core/numpy_fix.py
"""
import numpy as np
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Å–µ–≤–¥–æ–Ω–∏–º –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
if not hasattr(np, 'NaN'):
    np.NaN = np.nan

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª—å numpy —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
sys.modules['numpy'].NaN = np.nan
```

### üíæ `bquant/data/` - –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

```python
bquant/data/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ loader.py                   # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ processor.py                # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ validator.py                # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ schemas.py                  # –°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö (–∑–∞–≥–ª—É—à–∫–∞)
```

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `loader.py` - –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `data/data_loader.py` —Ñ—É–Ω–∫—Ü–∏–∏ `load_symbol_data()`, `load_all_data_files()`
- `processor.py` - –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `data/data_processor.py` —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `validator.py` - –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `data/data_validator.py` —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ß—Ç–æ —É–±—Ä–∞—Ç—å:** –ò–∑–±—ã—Ç–æ—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ fallback –∫–æ–¥

### üìä `bquant/indicators/` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

```python
bquant/indicators/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ base.py                     # –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ loaders.py                  # –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ç–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ library.py                  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pandas_ta, ta-lib
‚îú‚îÄ‚îÄ calculators.py              # –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–æ–≤  
‚îú‚îÄ‚îÄ registry.py                 # –†–µ–µ—Å—Ç—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ macd.py                     # –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π MACD –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
```

#### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º

BQuant –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **—Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ —Ä–∞–±–æ—Ç—ã —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏**:

1. **–ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∫–æ–≥–¥–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –∏ –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–∞—Ö
2. **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–µ—Ö–∞–Ω–∞–ª–∏–∑–∞** - pandas-ta, ta-lib –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤  
3. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** - –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º

#### `bquant/indicators/base.py`
```python
"""–ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"""
from abc import ABC, abstractmethod
from enum import Enum
import pandas as pd

class IndicatorSource(Enum):
    """–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞"""
    PRELOADED = "preloaded"    # –ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞
    LIBRARY = "library"        # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ (pandas_ta, ta-lib)
    CUSTOM = "custom"          # –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

class BaseIndicator(ABC):
    def __init__(self, data: pd.DataFrame, source: IndicatorSource = IndicatorSource.LIBRARY):
        self.data = data
        self.source = source
        self.result = None
        self._config = {}
    
    @abstractmethod
    def calculate(self) -> pd.DataFrame:
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ–≥–ª–∞—Å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É"""
        pass
    
    def validate_data(self):
        required_cols = ['open', 'high', 'low', 'close']
        missing = [col for col in required_cols if col not in self.data.columns]
        if missing:
            raise ValueError(f"–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏: {missing}")
    
    def get_result(self) -> pd.DataFrame:
        if self.result is None:
            self.result = self.calculate()
        return self.result

class IndicatorFactory:
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞"""
    
    @staticmethod
    def create_indicator(indicator_name: str, data: pd.DataFrame, 
                        source: IndicatorSource = None, **params):
        """
        –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞
        
        Args:
            indicator_name: –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ (macd, rsi, etc.)
            data: –î–∞–Ω–Ω—ã–µ OHLCV
            source: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
            **params: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        """
        if source is None:
            source = IndicatorFactory._detect_best_source(indicator_name, data)
        
        indicator_class = IndicatorFactory._get_indicator_class(indicator_name)
        return indicator_class(data, source=source, **params)
    
    @staticmethod
    def _detect_best_source(indicator_name: str, data: pd.DataFrame) -> IndicatorSource:
        """–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        expected_columns = IndicatorFactory._get_expected_columns(indicator_name)
        if all(col in data.columns for col in expected_columns):
            return IndicatorSource.PRELOADED
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö
        if IndicatorFactory._is_available_in_library(indicator_name):
            return IndicatorSource.LIBRARY
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
        return IndicatorSource.CUSTOM
```

#### `bquant/indicators/loaders.py` - –ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```python
"""–ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ç–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö"""
import pandas as pd
from .base import BaseIndicator, IndicatorSource

class PreloadedMACDIndicator(BaseIndicator):
    def __init__(self, data: pd.DataFrame, **params):
        super().__init__(data, source=IndicatorSource.PRELOADED)
        self.params = params
    
    def calculate(self) -> pd.DataFrame:
        """–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ MACD –∏–∑ —Ñ–∞–π–ª–∞"""
        result = self.data.copy()
        
        # –ü–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫ MACD –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
        macd_candidates = ['macd', 'MACD', 'Macd']
        signal_candidates = ['signal', 'Signal', 'SIGNAL', 'macd_signal']  
        hist_candidates = ['histogram', 'Histogram', 'macd_hist', 'hist']
        
        # –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
        for candidates, target_name in [
            (macd_candidates, 'macd'),
            (signal_candidates, 'macd_signal'), 
            (hist_candidates, 'macd_hist')
        ]:
            found_col = next((col for col in candidates if col in self.data.columns), None)
            if found_col and found_col != target_name:
                result[target_name] = result[found_col]
        
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–ª–∏—á–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        required_cols = ['macd', 'macd_signal', 'macd_hist']
        missing = [col for col in required_cols if col not in result.columns]
        if missing:
            raise ValueError(f"–í –≥–æ—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏ MACD: {missing}")
        
        return result

def load_precomputed_indicators(data: pd.DataFrame) -> dict:
    """–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ—Ç–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã"""
    indicators = {}
    
    # MACD
    macd_columns = ['macd', 'signal', 'histogram']
    if any(col.lower() in [c.lower() for c in data.columns] for col in macd_columns):
        indicators['macd'] = PreloadedMACDIndicator(data)
    
    # RSI  
    rsi_columns = ['rsi', 'RSI']
    if any(col in data.columns for col in rsi_columns):
        indicators['rsi'] = PreloadedRSIIndicator(data)
    
    # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã...
    
    return indicators
```

#### `bquant/indicators/library.py` - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–µ—Ö–∞–Ω–∞–ª–∏–∑–∞
```python
"""–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pandas_ta –∏ ta-lib –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"""
import pandas as pd
import pandas_ta as ta
from .base import BaseIndicator, IndicatorSource
from ..core.config import get_indicator_params

class LibraryMACDIndicator(BaseIndicator):
    def __init__(self, data: pd.DataFrame, **params):
        super().__init__(data, source=IndicatorSource.LIBRARY)
        self.params = get_indicator_params('macd', **params)
    
    def calculate(self) -> pd.DataFrame:
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å MACD —á–µ—Ä–µ–∑ pandas_ta"""
        self.validate_data()
        
        result = self.data.copy()
        
        # –†–∞—Å—á–µ—Ç —á–µ—Ä–µ–∑ pandas_ta
        macd_result = ta.macd(
            result['close'], 
            fast=self.params['fast'],
            slow=self.params['slow'], 
            signal=self.params['signal']
        )
        
        if macd_result is not None and not macd_result.empty:
            # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫
            for col in macd_result.columns:
                if col.startswith('MACD_'):
                    result['macd'] = macd_result[col]
                elif col.startswith('MACDs_'):
                    result['macd_signal'] = macd_result[col]
                elif col.startswith('MACDh_'):
                    result['macd_hist'] = macd_result[col]
        
        return result

class LibraryRSIIndicator(BaseIndicator):
    def __init__(self, data: pd.DataFrame, **params):
        super().__init__(data, source=IndicatorSource.LIBRARY)
        self.params = get_indicator_params('rsi', **params)
    
    def calculate(self) -> pd.DataFrame:
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å RSI —á–µ—Ä–µ–∑ pandas_ta"""
        self.validate_data()
        
        result = self.data.copy()
        result['rsi'] = ta.rsi(result['close'], length=self.params['length'])
        return result

# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
def calculate_library_indicator(indicator_name: str, data: pd.DataFrame, **params) -> pd.DataFrame:
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ pandas_ta"""
    
    library_mapping = {
        'macd': lambda d, p: ta.macd(d['close'], **p),
        'rsi': lambda d, p: ta.rsi(d['close'], **p), 
        'bbands': lambda d, p: ta.bbands(d['close'], **p),
        'atr': lambda d, p: ta.atr(d['high'], d['low'], d['close'], **p),
        'sma': lambda d, p: ta.sma(d['close'], **p),
        'ema': lambda d, p: ta.ema(d['close'], **p)
    }
    
    if indicator_name not in library_mapping:
        raise ValueError(f"–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä {indicator_name} –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π")
    
    config_params = get_indicator_params(indicator_name, **params)
    result = data.copy()
    
    indicator_result = library_mapping[indicator_name](data, config_params)
    if indicator_result is not None:
        if isinstance(indicator_result, pd.Series):
            result[indicator_name] = indicator_result
        else:  # DataFrame
            for col in indicator_result.columns:
                result[col] = indicator_result[col]
    
    return result
```

#### `bquant/indicators/calculators.py` - –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `research/macd_analysis.py` —Ñ—É–Ω–∫—Ü–∏—é `calculate_macd()`

**–ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:**
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ MACD —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ fallback –ª–æ–≥–∏–∫—É
- –†–∞—Å—á–µ—Ç ATR –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

```python
"""–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"""
import pandas as pd
import numpy as np
from .base import BaseIndicator, IndicatorSource
from ..core.config import get_indicator_params

class CustomMACDIndicator(BaseIndicator):
    def __init__(self, data: pd.DataFrame, **params):
        super().__init__(data, source=IndicatorSource.CUSTOM)
        self.params = get_indicator_params('macd', **params)
    
    def calculate(self) -> pd.DataFrame:
        """–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ MACD"""
        # –ü–ï–†–ï–ù–û–°–ò–ú –∏–∑ research/macd_analysis.py —Ñ—É–Ω–∫—Ü–∏—é calculate_macd()
        # –í–µ—Å—å –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å, —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
        pass

def calculate_custom_macd(data: pd.DataFrame, **overrides) -> pd.DataFrame:
    """
    –ò–°–¢–û–ß–ù–ò–ö: research/macd_analysis.py -> calculate_macd()
    
    –ü–µ—Ä–µ–Ω–æ—Å–∏–º –ø–æ–ª–Ω–æ—Å—Ç—å—é:
    - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - –†–∞—Å—á–µ—Ç EMA –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏  
    - –†–∞—Å—á–µ—Ç —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
    - –†–∞—Å—á–µ—Ç –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ATR
    - –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
    """
    # –í–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Å—é–¥–∞
    pass

def calculate_custom_rsi(data: pd.DataFrame, **overrides) -> pd.DataFrame:
    """–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RSI"""
    params = get_indicator_params('rsi', **overrides)
    period = params['length']
    
    close = data['close']
    delta = close.diff()
    
    gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
    
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    result = data.copy()
    result['rsi'] = rsi
    return result
```

#### `bquant/indicators/macd.py` - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π MACD –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `research/macd_analysis.py`

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—Å–µ—Ö —Ç—Ä–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö

```python
"""
–ò–°–¢–û–ß–ù–ò–ö: research/macd_analysis.py
–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π MACD –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
"""

class MACDAnalyzer:
    def __init__(self, data: pd.DataFrame, source: IndicatorSource = None, **macd_params):
        self.data = data.copy()
        self.macd_params = macd_params
        self.source = source
        self._macd_data = None
        self._zones = None
    
    def calculate_macd(self) -> pd.DataFrame:
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å MACD –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫"""
        if self._macd_data is None:
            # –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞
            if self.source is None:
                self.source = self._detect_optimal_source()
            
            if self.source == IndicatorSource.PRELOADED:
                indicator = PreloadedMACDIndicator(self.data, **self.macd_params)
            elif self.source == IndicatorSource.LIBRARY:
                indicator = LibraryMACDIndicator(self.data, **self.macd_params)  
            else:  # CUSTOM
                indicator = CustomMACDIndicator(self.data, **self.macd_params)
            
            self._macd_data = indicator.calculate()
        
        return self._macd_data
    
    def _detect_optimal_source(self) -> IndicatorSource:
        """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫"""
        # –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        macd_cols = ['macd', 'signal', 'histogram']
        if any(col.lower() in [c.lower() for c in self.data.columns] for col in macd_cols):
            return IndicatorSource.PRELOADED
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å pandas_ta
        try:
            import pandas_ta as ta
            return IndicatorSource.LIBRARY
        except ImportError:
            return IndicatorSource.CUSTOM
    
    # –í–°–ï –û–°–¢–ê–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ –ü–ï–†–ï–ù–û–°–ò–ú –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô:
    # - identify_zones()
    # - calculate_zone_features()  
    # - find_divergences()
    # - get_macd_statistics()
    # - cluster_zone_shapes()
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

```python
from bquant.indicators import MACDAnalyzer, IndicatorSource
from bquant.indicators import IndicatorFactory

# –°–ø–æ—Å–æ–± 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞
analyzer = MACDAnalyzer(data)  # –°–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫

# –°–ø–æ—Å–æ–± 2: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞
analyzer_preloaded = MACDAnalyzer(data, source=IndicatorSource.PRELOADED)
analyzer_library = MACDAnalyzer(data, source=IndicatorSource.LIBRARY) 
analyzer_custom = MACDAnalyzer(data, source=IndicatorSource.CUSTOM)

# –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏–∫—É
indicator = IndicatorFactory.create_indicator('macd', data, fast=8, slow=21)

# –í—Å–µ —Å–ø–æ—Å–æ–±—ã –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
zones = analyzer.identify_zones()
features = [analyzer.calculate_zone_features(zone) for zone in zones]
```

### üî¨ `bquant/analysis/` - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏

```python
bquant/analysis/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ technical/                  # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ trends.py              # –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ momentum.py            # –ê–Ω–∞–ª–∏–∑ –º–æ–º–µ–Ω—Ç—É–º–∞ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îî‚îÄ‚îÄ oscillators.py         # –ê–Ω–∞–ª–∏–∑ –æ—Å—Ü–∏–ª–ª—è—Ç–æ—Ä–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
‚îú‚îÄ‚îÄ chart/                     # –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ patterns.py           # –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ support_resistance.py # –£—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ candlestick/              # –°–≤–µ—á–Ω–æ–π –∞–Ω–∞–ª–∏–∑ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ patterns.py           # –°–≤–µ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
‚îú‚îÄ‚îÄ timeseries/               # üÜï –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ stationarity.py       # –¢–µ—Å—Ç—ã —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ seasonality.py        # –ê–Ω–∞–ª–∏–∑ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ autocorrelation.py    # –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îî‚îÄ‚îÄ decomposition.py      # –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Ä—è–¥–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
‚îú‚îÄ‚îÄ statistical/              # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ distributions.py      # –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ hypothesis_testing.py # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑
‚îÇ   ‚îî‚îÄ‚îÄ correlations.py       # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ zones/                    # –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ zone_features.py      # –ü—Ä–∏–∑–Ω–∞–∫–∏ –∑–æ–Ω
    ‚îî‚îÄ‚îÄ sequence_analysis.py  # –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
```

#### `bquant/analysis/statistical/hypothesis_testing.py`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `research/hypothesis_testing.py`

**–ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∏–ø–æ—Ç–µ–∑ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### `bquant/analysis/zones/zone_features.py`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `research/macd_analysis.py` —Ñ—É–Ω–∫—Ü–∏–∏:
- `analyze_zones_distribution()`
- `create_zone_sequence_analysis()`

### ü§ñ `bquant/ml/` - –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–∑–∞–≥–ª—É—à–∫–∏)

```python
bquant/ml/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç ML –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–∑–∞–≥–ª—É—à–∫–∏)
‚îú‚îÄ‚îÄ features/                   # –†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ models/                     # ML –º–æ–¥–µ–ª–∏ (–∑–∞–≥–ª—É—à–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ training/                   # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π (–∑–∞–≥–ª—É—à–∫–∏)  
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îî‚îÄ‚îÄ evaluation/                 # –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π (–∑–∞–≥–ª—É—à–∫–∏)
    ‚îî‚îÄ‚îÄ __init__.py
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø–∞–∫–µ—Ç–æ–º
```python
# bquant/ml/__init__.py
"""
ML –º–æ–¥—É–ª—å BQuant - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –∑–æ–Ω
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–æ–Ω
- –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
"""

def extract_zone_features(zones):
    """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ML –ø—Ä–∏–∑–Ω–∞–∫–æ–≤"""
    raise NotImplementedError("ML –º–æ–¥—É–ª—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ")

def classify_zones(features):
    """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–æ–Ω"""
    raise NotImplementedError("ML –º–æ–¥—É–ª—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ")
```

### üìà `bquant/visualization/` - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```python
bquant/visualization/
‚îú‚îÄ‚îÄ __init__.py                 # –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ charts.py                   # –û—Å–Ω–æ–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
‚îú‚îÄ‚îÄ zones.py                    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–æ–Ω
‚îú‚îÄ‚îÄ statistical.py              # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ themes.py                   # –¢–µ–º—ã –∏ —Å—Ç–∏–ª–∏ (–∑–∞–≥–ª—É—à–∫–∞)
```

#### `bquant/visualization/charts.py`
**–ù–æ–≤—ã–π –º–æ–¥—É–ª—å** - —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `FinancialCharts` —Å –º–µ—Ç–æ–¥–∞–º–∏:
```python
class FinancialCharts:
    def __init__(self, style='seaborn', figsize=(12, 8)):
        self.setup_style()
    
    def plot_ohlcv(self, data, title=None, show_volume=True):
        """OHLCV –≥—Ä–∞—Ñ–∏–∫"""
        pass
    
    def plot_macd_with_zones(self, data, zones, title=None):
        """MACD —Å –∑–æ–Ω–∞–º–∏"""  
        pass
    
    def plot_zone_features_distribution(self, features):
        """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∑–æ–Ω"""
        pass
```

---

## üß™ –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### `research/notebooks/`
```python
research/notebooks/
‚îú‚îÄ‚îÄ 01_data_exploration.ipynb      # –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ 02_macd_zones_analysis.ipynb   # –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω MACD  
‚îú‚îÄ‚îÄ 03_hypothesis_testing.ipynb    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑
‚îú‚îÄ‚îÄ 04_pattern_recognition.ipynb   # –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ 05_timeseries_analysis.ipynb   # –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
```

### `research/methodology/`
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–µ—Ä–µ–Ω–æ—Å–∏–º `research/macd_research.md` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üöÄ –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### `scripts/analysis/`
```python
scripts/analysis/
‚îú‚îÄ‚îÄ run_macd_analysis.py     # –ü–æ–ª–Ω—ã–π MACD –∞–Ω–∞–ª–∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ test_hypotheses.py      # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≥–∏–ø–æ—Ç–µ–∑
‚îú‚îÄ‚îÄ batch_analysis.py       # –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  
‚îî‚îÄ‚îÄ generate_report.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞)
```

#### –ü—Ä–∏–º–µ—Ä `scripts/analysis/run_macd_analysis.py`
```python
#!/usr/bin/env python3
"""
–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ MACD –∑–æ–Ω –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
"""
import sys
sys.path.append('.')

from bquant.data import load_symbol_data
from bquant.indicators import MACDAnalyzer  
from bquant.analysis.statistical import run_all_hypothesis_tests
from bquant.visualization import FinancialCharts

def main(symbol='XAUUSD', timeframe='1h'):
    print(f"üîç –ê–Ω–∞–ª–∏–∑ {symbol} {timeframe}")
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    data = load_symbol_data(symbol, timeframe)
    print(f"üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(data)} –∑–∞–ø–∏—Å–µ–π")
    
    # MACD –∞–Ω–∞–ª–∏–∑
    analyzer = MACDAnalyzer(data, fast=8, slow=21)
    zones = analyzer.identify_zones()
    features = [analyzer.calculate_zone_features(zone) for zone in zones]
    
    print(f"üéØ –ù–∞–π–¥–µ–Ω–æ {len(zones)} –∑–æ–Ω")
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
    hypothesis_results = run_all_hypothesis_tests(features)
    significant = hypothesis_results['summary']['significant_tests']
    print(f"üìà –ó–Ω–∞—á–∏–º—ã—Ö —Ç–µ—Å—Ç–æ–≤: {significant}")
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    charts = FinancialCharts()
    fig = charts.plot_macd_with_zones(analyzer.calculate_macd(), zones)
    fig.savefig(f'results/{symbol}_{timeframe}_analysis.png')
    print(f"üíæ –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω")

if __name__ == "__main__":
    if len(sys.argv) > 1:
        main(sys.argv[1])
    else:
        main()
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### `pyproject.toml`
```toml
[build-system]
requires = ["setuptools>=45", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "bquant"
version = "0.0.0"
description = "Quantitative research toolkit"
authors = [{name = "kogriv", email = "kogriv@gmail.com"}]
readme = "README.md"
requires-python = ">=3.13"
license = {text = "MIT"}
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Financial and Insurance Industry",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3.13",
]
dependencies = [
    "pandas==2.3.1",
    "numpy==2.3.2",
    "matplotlib==3.10.5",
    "seaborn==0.13.2",
    "pandas-ta==0.3.14b0",
    "statsmodels==0.14.5",
    "scipy==1.16.1",
    "scikit-learn==1.7.1",
    "plotly==6.3.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=6.0",
    "jupyter==1.1.1",
]
notebooks = [
    "jupyter==1.1.1",
    "plotly==6.3.0",
]

[project.scripts]
bquant-analyze = "scripts.analysis.run_macd_analysis:main"
bquant-batch = "scripts.analysis.batch_analysis:main"

[tool.setuptools.packages.find]
where = ["."]

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]

[tool.black]
line-length = 88
target-version = ['py313']
```

---

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–∫ –∫–æ–¥**
–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `bquant/core/config.py` —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

### 2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏–º–ø–æ—Ä—Ç–æ–≤**
```python
# –ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install -e .

# –ü—Ä–æ—Å—Ç—ã–µ –∏–º–ø–æ—Ä—Ç—ã
from bquant.data import load_symbol_data
from bquant.indicators import MACDAnalyzer
from bquant.analysis.statistical import run_all_hypothesis_tests
```

### 3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π**
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:** pandas_ta, ta-lib –∏–ª–∏ –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- **ML:** scikit-learn –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** matplotlib + seaborn + plotly

### 4. **–ü–æ—ç—Ç–∞–ø–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ**
- **–≠—Ç–∞–ø 1:** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–¥–∞–Ω–Ω—ã–µ, MACD –∞–Ω–∞–ª–∏–∑ –∫–∞–∫ –ø–µ—Ä–≤—ã–π –∫–µ–π—Å, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- **–≠—Ç–∞–ø 2:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, –¥—Ä—É–≥–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- **–≠—Ç–∞–ø 3:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ ML, –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

---

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

BQuant –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö –≥–∏–±–∫–æ—Å—Ç—å, —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –∏ maintainability –∫–æ–¥–∞.

### 1. **–ü–∞—Ç—Ç–µ—Ä–Ω "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–∫ –∫–æ–¥" (Configuration as Code)**

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ `bquant/core/config.py`:

```python
# –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
DEFAULT_INDICATORS = {
    'macd': {'fast': 12, 'slow': 26, 'signal': 9},
    'rsi': {'length': 14}
}

# –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
def get_indicator_params(indicator: str, **overrides) -> Dict[str, Any]:
    params = DEFAULT_INDICATORS[indicator].copy()
    params.update(overrides)  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
    return params

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
macd_params = get_indicator_params('macd', fast=8, slow=21)  # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –õ–µ–≥–∫–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### 2. **–ü–∞—Ç—Ç–µ—Ä–Ω "–°—Ç—Ä–∞—Ç–µ–≥–∏—è" (Strategy Pattern)**

–í–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã:

```python
# –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
class BaseIndicator(ABC):
    @abstractmethod
    def calculate(self) -> pd.DataFrame:
        pass

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
class MACDIndicator(BaseIndicator):
    def calculate(self) -> pd.DataFrame:
        return ta.macd(self.data['close'], **self.params)

class RSIIndicator(BaseIndicator):
    def calculate(self) -> pd.DataFrame:
        return ta.rsi(self.data['close'], **self.params)

# –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
def analyze_indicator(indicator: BaseIndicator):
    return indicator.calculate()
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ

### 3. **–ü–∞—Ç—Ç–µ—Ä–Ω "–§–∞–±—Ä–∏–∫–∞" (Factory Pattern)**

–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:

```python
def create_macd_analyzer(data: pd.DataFrame, **custom_params) -> MACDAnalyzer:
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MACD –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞"""
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    config_params = get_indicator_params('macd', **custom_params)
    return MACDAnalyzer(data, **config_params)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
analyzer = create_macd_analyzer(data, fast=8)  # –ü—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞

### 4. **–ü–∞—Ç—Ç–µ—Ä–Ω "–ê–¥–∞–ø—Ç–µ—Ä" (Adapter Pattern)**

–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:

```python
class DataSourceAdapter(ABC):
    @abstractmethod
    def load_data(self, symbol: str, timeframe: str) -> pd.DataFrame:
        pass

class TradingViewAdapter(DataSourceAdapter):
    def load_data(self, symbol: str, timeframe: str) -> pd.DataFrame:
        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è TradingView
        file_pattern = "OANDA_{symbol}, {timeframe}.csv"
        return self._load_csv(file_pattern.format(symbol=symbol, timeframe=timeframe))

class MetaTraderAdapter(DataSourceAdapter):
    def load_data(self, symbol: str, timeframe: str) -> pd.DataFrame:
        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è MetaTrader
        file_pattern = "{symbol}{timeframe}.csv"
        return self._load_csv(file_pattern.format(symbol=symbol, timeframe=timeframe))

# –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–≥—Ä—É–∑–∫–∏
def load_symbol_data(symbol: str, timeframe: str, source: str = 'tradingview'):
    adapter = get_adapter(source)  # –§–∞–±—Ä–∏–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
    return adapter.load_data(symbol, timeframe)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ò–∑–æ–ª—è—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–∏

---

## üîß –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### 1. **–ù–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
```python
# –í bquant/core/config.py –¥–æ–±–∞–≤–∏—Ç—å:
DATA_FILE_PATTERNS['new_source'] = {
    'default': '{symbol}_{timeframe}.csv'
}
```

### 2. **–ù–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**
```python
# –í bquant/indicators/calculators.py –¥–æ–±–∞–≤–∏—Ç—å:
def calculate_custom_indicator(data, **params):
    return ta.custom_indicator(data['close'], **params)
```

### 3. **ML –º–æ–¥—É–ª–∏ (–±—É–¥—É—â–µ–µ)**
–ó–∞–≥–ª—É—à–∫–∏ –≥–æ—Ç–æ–≤—ã –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –≤:
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–æ–Ω
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

---

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
```python
from bquant.data import load_symbol_data
from bquant.indicators import MACDAnalyzer

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑
data = load_symbol_data('XAUUSD', '1h')
analyzer = MACDAnalyzer(data, fast=8, slow=21)
zones = analyzer.identify_zones()

print(f"–ù–∞–π–¥–µ–Ω–æ {len(zones)} –∑–æ–Ω")
```

### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤ –Ω–æ—É—Ç–±—É–∫–µ
```python
# –í Jupyter –Ω–æ—É—Ç–±—É–∫–µ
from bquant.visualization import FinancialCharts
from bquant.analysis.statistical import run_all_hypothesis_tests

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
charts = FinancialCharts()
fig = charts.plot_macd_with_zones(analyzer.calculate_macd(), zones)

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
features = [analyzer.calculate_zone_features(zone) for zone in zones]
hypothesis_results = run_all_hypothesis_tests(features)
```

### –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e .

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
pip install -e .[dev,notebooks]

# –ê–Ω–∞–ª–∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
bquant-analyze EURUSD

# –ü–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
bquant-batch XAUUSD EURUSD GBPUSD
```

---

**BQuant** - —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤. –ù–∞—á–∏–Ω–∞–µ–º —Å MACD –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∫ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è - –æ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–æ —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.
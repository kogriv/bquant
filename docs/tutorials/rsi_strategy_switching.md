# Tutorial: RSI zones (–ü—Ä–∏–º–µ—Ä 5) ‚Äî —Å–º–µ–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏

## üéØ –¶–µ–ª–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å pipeline –∏–∑ [–ü—Ä–∏–º–µ—Ä–∞ 5: RSI —á–µ—Ä–µ–∑ talib](../../devref/gaps/zo/zonan.md#–ø—Ä–∏–º–µ—Ä-5-rsi-—á–µ—Ä–µ–∑-talib-—Å-3-—Ç–∏–ø–∞–º–∏-–∑–æ–Ω)
- –ü–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É `threshold` –∏ `line_crossing` –±–µ–∑ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
- –°—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–æ–Ω –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

## üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- `pip install bquant talib-binary` (–∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π TA-Lib)
- –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ OHLCV (–∏—Å–ø–æ–ª—å–∑—É–µ–º sample `tv_xauusd_1h`)
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ—Ä–æ–≥–æ–≤ RSI

## üì• –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```python
from bquant.data.samples import get_sample_data

df = get_sample_data('tv_xauusd_1h')
```

## üõ†Ô∏è –®–∞–≥ 1. –ë–∞–∑–æ–≤—ã–π threshold-–ø–æ–¥—Ö–æ–¥
–°–ª–µ–¥—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ü—Ä–∏–º–µ—Ä–∞ 5: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º RSI —á–µ—Ä–µ–∑ `talib` –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é `threshold` —Å —É—Ä–æ–≤–Ω—è–º–∏ 70/30.„ÄêF:devref/gaps/zo/zonan.md‚Ä†L2268-L2297„Äë

```python
from bquant.analysis.zones import analyze_zones

rsi_threshold = (
    analyze_zones(df)
    .with_indicator('talib', 'rsi', timeperiod=14)
    .detect_zones('threshold', indicator_col='RSI', upper_threshold=70, lower_threshold=30)
    .analyze(clustering=True)
    .build()
)

print(f"Threshold zones: {len(rsi_threshold.zones)}")
print(rsi_threshold.statistics['zone_distribution'])
```

## ‚ôªÔ∏è –®–∞–≥ 2. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –±–µ–∑ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
`ZoneAnalysisResult` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DataFrame —Å —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º RSI –≤ –ø–æ–ª–µ `data`. –°–æ—Ö—Ä–∞–Ω–∏–º –µ–≥–æ –∏ –ø–æ—Å—Ç—Ä–æ–∏–º —Å–∏–≥–Ω–∞–ª –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ª–∏–Ω–∏–π.

```python
# –ò–∑–≤–ª–µ–∫–∞–µ–º DataFrame —Å RSI (–æ–Ω —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫—É 'RSI')
rsi_data = rsi_threshold.data.copy()
rsi_data['RSI_signal'] = rsi_data['RSI'].rolling(5, min_periods=1).mean()
```

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º pipeline —Ç–æ–ª—å–∫–æ —Å–æ —Å—Ç–∞–¥–∏–µ–π –¥–µ—Ç–µ–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è `line_crossing`. –≠—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç RSI –∏ –µ–≥–æ —Å–≥–ª–∞–∂–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å —Å–º–µ–Ω—ã —Ç—Ä–µ–Ω–¥–∞.

```python
rsi_line = (
    analyze_zones(rsi_data)
    .detect_zones('line_crossing', line1_col='RSI', line2_col='RSI_signal', min_duration=3)
    .analyze(clustering=True)
    .build()
)

print(f"Line-crossing zones: {len(rsi_line.zones)}")
first_ctx = rsi_line.zones[0].indicator_context
print(first_ctx['detection_strategy'])  # 'line_crossing'
print(first_ctx['signal_line'])          # 'RSI_signal'
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
print("Threshold win-rate:", rsi_threshold.statistics.get('win_rate'))
print("Line crossing win-rate:", rsi_line.statistics.get('win_rate'))
```

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–º–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
–î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é.

```python
# Threshold –∫–æ–Ω—Ç–µ–∫—Å—Ç
threshold_fig = rsi_threshold.visualize('overview', title='RSI Threshold Zones')
threshold_fig.show()

# Line crossing –∫–æ–Ω—Ç–µ–∫—Å—Ç
line_fig = rsi_line.visualize('overview', title='RSI Line Crossing Zones')
line_fig.show()
```

> üí° –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `visualize('detail', zone_id=...)`, —á—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–æ–Ω—ã –¥–æ –∏ –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

## ‚úÖ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
1. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** ‚Äî —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å `result.data`, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.
2. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ `zone.indicator_context` –≤ –æ—Ç—á—ë—Ç—ã, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.
3. **–ü–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è `RSI_signal` (3‚Äì7 –±–∞—Ä–æ–≤), —á—Ç–æ–±—ã —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å `line_crossing`.
4. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** ‚Äî –Ω–∞—á–Ω–∏—Ç–µ —Å `threshold`, —á—Ç–æ–±—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —ç–∫—Å—Ç—Ä–µ–º—É–º—ã, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `line_crossing` –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Ç–æ—á–µ–∫ –≤—ã—Ö–æ–¥–∞.

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ
- –î–æ–±–∞–≤—å—Ç–µ `CombinedRulesDetection` —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º –ø–æ –æ–±—ä—ë–º—É.
- –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ backtest: —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ `rsi_line.zones` –∏ –ø—Ä–æ–≥–æ–Ω–∏—Ç–µ —á–µ—Ä–µ–∑ —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä.
- –ò–∑—É—á–∏—Ç–µ `examples/02a_universal_zones.py` –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ä–∞–±–æ—Ç—ã —Å RSI.
